!function(t){function e(n){if(a[n])return a[n].exports;var r=a[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var a={};e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./_shared/bundle/",e(e.s=98)}({21:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"use strict";var a=function(e,a){this.$container=t(e),this.alerts=[],this.options=a};a.DEFAULTS={size:"md",html:{icon:'<i class="ic-lnpx warning_yellow d-ib align-middle"></i>',content:null},class:{main:"alt_lnal",wrap:{icon:"iwrap",content:"ctn",close:"close"}},style:{main:null,wrap:{icon:null,content:"color:#ffea00",close:null}}},a.prototype.initial=function(){this.createAlert()},a.prototype.toggleAlert=function(t){var e=this.alerts[this.returnAlertIndex(t)];"string"==typeof t&&t.length>0&&(e.is(":visible")?this.hideAlert(t):this.showAlert(t))},a.prototype.showAlert=function(t){"string"==typeof t&&t.length>0&&this.alerts[this.returnAlertIndex(t)].show()},a.prototype.hideAlert=function(t){"string"==typeof t&&t.length>0&&this.alerts[this.returnAlertIndex(t)].hide()},a.prototype.createAlert=function(e){var a,n=e||this.options;"string"==typeof n.html.content&&n.html.content.length>0&&(a=this.registerAlert(t(this.htmlAlert(n.class,n.style,n.size,n.html))),this.insertAlert(a))},a.prototype.htmlAlert=function(t,e,a,n){var r=function(t,a){var n;return n="string"==typeof t&&"string"==typeof a&&"string"==typeof e[t][a]?' style="'+e[t][a]+'"':"string"==typeof t&&"string"==typeof e[t]?' style="'+e[t]+'"':"",n};return'<div id="'+this.idGenerator()+'" class="'+t.main+" "+a+'"'+r("main")+'"><div class="'+t.wrap.icon+'"'+r("wrap","icon")+">"+n.icon+'</div><div class="'+t.wrap.content+'"'+r("wrap","content")+">"+n.content+'</div><a href="#" class="'+t.wrap.close+'"'+r("wrap","close")+"></a></div>"},a.prototype.idGenerator=function(){var t=+new Date,e=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};return"alt_lnal"+function(){for(var a=t.toString(),n=a.split("").reverse(),r="",o=0;o<8;++o){r+=n[e(0,n.length-1)]}return r}()},a.prototype.registerAlert=function(e){return e instanceof t&&(this.alerts.push(e),this.setCloseButtonEvent(e)),this.returnAlertIndex(e)},a.prototype.unregisterAlert=function(t){return"number"==typeof t&&t>=0&&(this.alerts.splice(t,1),!0)},a.prototype.setCloseButtonEvent=function(a){var n=this;"object"===(void 0===a?"undefined":e(a))&&a instanceof t&&a.children(".close").one("click",function(e){e.preventDefault();var a=t(this).closest(".alt_lnal").attr("id");n.distoryAlert(a)})},a.prototype.returnAlertIndex=function(a){var n="object"===(void 0===a?"undefined":e(a))&&a instanceof t?a:t("#"+a);if("object"===(void 0===n?"undefined":e(n))&&n instanceof t)return this.alerts.map(function(t){return t.attr("id")}).indexOf(n.attr("id"))},a.prototype.insertAlert=function(a){"number"==typeof a&&"object"===e(this.alerts[a])&&this.alerts[a]instanceof t&&this.$container.prepend(this.alerts[a])},a.prototype.distoryAlert=function(t){var e=this.returnAlertIndex(t);"string"==typeof t&&e>=0&&(this.alerts[e].remove(),this.unregisterAlert(e))},a.prototype.addAlert=function(e){var a;"string"==typeof this.options.html.content&&this.options.html.content.length>0&&(a=this.registerAlert(t(this.htmlAlert(this.options.class,this.options.style,this.options.size,this.options.html))),this.insertAlert(a))},t.fn.alt_lnal=function(n,r){return this.each(function(){var o=t(this),i=o.data("alt_lnal"),s=null;i?"string"==typeof n&&void 0===r?i[n]():("string"==typeof n&&"object"===(void 0===r?"undefined":e(r))||"string"==typeof r)&&i[n](r):(s=t.extend({},a.DEFAULTS,"object"===(void 0===n?"undefined":e(n))&&n,"object"===(void 0===r?"undefined":e(r))&&r),i=new a(this,s),o.data("alt_lnal",i),i.initial())})}}(t)}).call(window)},22:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,a){"use strict";var n=function(e,a){this.input=e,this.$input=t(e),this.options=a,this.timer=null};n.DEFAULTS={hideArea:"body",prev:'<a class="btn"></a>',next:'<a class="btn"></a>',prevDisabled:'<a class="btn disabled"></a>',nextDisabled:'<a class="btn disabled"></a>',changeMonthYear:!1,minYear:10,maxYear:10,minDate:null,maxDate:null,monthCount:1,holiday:null,disabled:null,range:null,arrow:!1,btnDisabled:!1,renderValidMonth:!1,toggleAlert:!0,dateFormat:"YYYY/MM/DD",dataIsNumberRegex:/^\d[\d|\/]+\d$/,moduleCloseEvent:"cy_ln.close",weekdayName:a.weekdaysMin(),cssClass:{main:"cy-ln",extra:"",wrapper:"wrapper",month:"month",prev:"prev",yearMonth:"yearMonth",next:"next",weekdayName:"weekdayName",date:"date",weekday:["sun","mon","tue","wed","thu","fri","sat"],holiday:"holiday",today:"today",hover:"hover",disabled:"disabled",selected:"selected",start:"start",arrow:"arrow",between:"between",point:"point",end:"end",inputActive:"active",top:0},alertString:{invalid:"日期格式錯誤！",beforeMin:"日期必須大於{#Date}！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}},n.prototype.getOptions=function(t){return this.options},n.prototype.updateOption=function(e){t.extend(this.options,e)},n.prototype.getMomentMinDate=function(){return this.options.getMomentMinDate().add(1,"days").format("YYYY/MM/DD")},n.prototype.collectionIndexOf=function(t,e,a){for(var n=0;n<t.length;n++)if(a(t[n],e))return n;return-1},n.prototype.isBetween=function(t,e,n){var r=a.min(e,n),o=a.max(e,n);return t.isAfter(r)&&t.isBefore(o)},n.prototype.equalsDatePart=function(t,e){return t.format("YYYY/MM/DD")==e.format("YYYY/MM/DD")},n.prototype.comparer=function(t,e){return t.isBefore(e)?-1:t.isAfter(e)?1:0},n.prototype.tag=function(e){return t("<"+e+"></"+e+">")},n.prototype.checkDateRepair=function(t){t.val(this.dateAutoRepair(t.val(),!1))},n.prototype.dateAutoRepair=function(t,e){var n="",r=(a(),a().format("YYYYMMDD")),o=t.replace(/\//g,""),i=o.substring(0,2),s=this.options.minDate,l=this.options.maxDate,d=s&&s instanceof a?s.format("YYYYMMDD"):null,c=l&&l instanceof a?l.format("YYYYMMDD"):null,u=(new Date).getFullYear().toString(),p="";if(t.length>0)switch(this.dateValueStatus(t)){case"validAll":n=a(o).format(this.options.dateFormat);break;case"validMonthDay":n=a(u+o).format(this.options.dateFormat);break;case"validMonth":n=a(u+i+"01").format(this.options.dateFormat),e&&alert(this.options.alertString.invalid);break;case"sameMin":case"beforeMin":n=a(d).add(1,"d").format(this.options.dateFormat),e&&(/\{#Date\}/.test(this.options.alertString.beforeMin)?(p=a(d).format(this.options.dateFormat),alert(this.options.alertString.beforeMin.replace(/\{#Date\}/g,p))):alert(this.options.alertString.beforeMin));break;case"sameMax":n=a(c).format(this.options.dateFormat);break;case"afterMax":n=a(c).format(this.options.dateFormat),e&&(/\{#Date\}/.test(this.options.alertString.afterMax)?(p=a(c).add(1,"d").format(this.options.dateFormat),alert(this.options.alertString.afterMax.replace(/\{#Date\}/g,p))):alert(this.options.alertString.afterMax));break;case"invalid":n=null!==d&&a(r).isSameOrBefore(d)?a(d).add(1,"d").format(this.options.dateFormat):null!==c&&a(r).isAfter(c)?a(c).format(this.options.dateFormat):a().format(this.options.dateFormat),e&&alert(this.options.alertString.invalid);break;default:n=a().format(this.options.dateFormat)}return n},n.prototype.getPrevInputDom=function(e){return 0===e?this.$input:t(this.options.range[e-1])},n.prototype.getNextInputDom=function(e){return t(!e&&this.options.range.length>0?this.options.range[0]:this.options.range[e+1])},n.prototype.getAfterInputDom=function(e){return function(e){for(var a=t(this.options.range[e]),n=e+1;n<this.options.range.length;n++)a.add(this.options.range[n]);return a}.call(this,e||0)},n.prototype.getAllInputDom=function(a){var n=t(this.$input);if(this.options.range&&"object"===e(this.options.range))for(var r=a||0;r<this.options.range.length;r++)n=n.add(this.options.range[r]);return n},n.prototype.dateIsAllNumber=function(t){return this.options.dataIsNumberRegex.test(t)},n.prototype.dateValueStatus=function(t){var e=null,n=t.replace(/\//g,""),r=n.substring(0,2),o=parseInt(r),i=n.substring(2,4)||null,s=(parseInt(i),this.options.minDate),l=this.options.maxDate,d=s&&s instanceof a?s.format("YYYYMMDD"):null,c=l&&l instanceof a?l.format("YYYYMMDD"):null,u=(new Date).getFullYear().toString(),p="";return p=n.length>0?this.dateIsAllNumber(n)?8==n.length&&a(n).isValid()?"validAll":4==n.length&&o<=12?a(u+n).isValid()?"validMonthDay":a(u+r+"01").isValid()?"validMonth":"invalid":"invalid":"invalid":"null","validAll"===p?e=a(n).format("YYYYMMDD"):"validMonthDay"===p?e=a(u+n).format("YYYYMMDD"):"validMonth"===p&&a(u+n).isValid()?e=a(u+r+"01").format("YYYYMMDD"):p="invalid",null!==e&&null!==d&&(a(e).isSame(d)?p="sameMin":a(e).isBefore(d)&&(p="beforeMin")),null!==e&&null!==c&&(a(e).isSame(c)?p="sameMax":a(e).isAfter(c)&&(p="afterMax")),p},n.prototype.drawCalendar=function(e,n,r,o){var i,s,l=this.tag("table"),d=this.tag("tr"),c=this,u=n.getMomentMinDate()?n.getMomentMinDate().format("YYYYMMDD"):null,p=n.getMomentMaxDate()?n.getMomentMaxDate().format("YYYYMMDD"):null;"string"==typeof o?(i=a(o.replace(/\W/g,"")),s=a(o.replace(/\W/g,""))):(i=a(o),s=a(o));for(var h=0;h<n.monthCount;h++)d.append(this.tag("td").append(this.drawMonth(e,n,r,s.format(n.dateFormat)))),s.add(1,"M");if(n.arrow)if(l.append(this.tag("span").addClass(n.cssClass.arrow)),e.attr("data-range")){var f=t(n.range).offset().left-e.offset().left+t(n.range).width()/2-6;l.children("."+n.cssClass.arrow).css("left",f)}else l.children("."+n.cssClass.arrow).css("left",e.width()/2-3);var m=d.find(">td:first table tr td[data-date]:first").attr("data-date").replace(/\W/g,""),g=d.find(">td:last table tr td[data-date]:last").attr("data-date").replace(/\W/g,""),v=a(u,"YYYYMMDD").add(1,"days").format("YYYYMMDD");return 1==n.btnDisabled&&parseInt(m)<=parseInt(v)&&parseInt(g)>=parseInt(u)?d.find(">td:first table tr td."+n.cssClass.prev).html(n.prevDisabled):d.find(">td:first table tr td."+n.cssClass.prev).html(n.prev).click(function(){t(this).parents("."+n.cssClass.main).empty().append(c.drawCalendar(e,n,r,i.add(-1,"M")))}),1==n.btnDisabled&&parseInt(m)<=parseInt(p)&&parseInt(g)>=parseInt(p)?d.find(">td:last table tr td."+n.cssClass.next).html(n.nextDisabled):d.find(">td:last table tr td."+n.cssClass.next).html(n.next).click(function(){t(this).parents("."+n.cssClass.main).empty().append(c.drawCalendar(e,n,r,i.add(1,"M")))}),l.addClass(n.cssClass.wrapper).append(d),l},n.prototype.drawMonth=function(n,r,o,i){var s=a(o.replace(/\W/g,"")),l=a(i.replace(/\W/g,"")),d=0,c=this,u=this.tag("table").addClass(r.cssClass.month).attr("data-date",l.format(r.dateFormat)).append(this.tag("tr").append(this.tag("td").addClass(r.cssClass.prev)).append(this.tag("td").addClass(r.cssClass.yearMonth).append("<span>"+l.format("YYYY")+"</span>年<span>"+l.format("M")+"</span>月")).append(this.tag("td").addClass(r.cssClass.next)));if(1==r.monthCount&&r.changeMonthYear){u.find("."+r.cssClass.yearMonth).empty();var p=this.tag("select"),h="string"==typeof r.minYear?parseInt(r.minYear):r.minYear>200?r.minYear:l.year()-r.minYear,f="string"==typeof r.maxYear?parseInt(r.maxYear):r.maxYear>200?r.maxYear:l.year()+r.maxYear;for(d=h;d<=f;d++)d==l.year()?p.append(this.tag("option").val(d).text(d).attr("selected","selected")):p.append(this.tag("option").val(d).text(d));u.find("."+r.cssClass.yearMonth).append(p);var m=this.tag("select"),g=r.minDate,v=r.maxDate;r.minDate&&"number"==typeof g&&(g=a().add(g,"days")),r.maxDate&&"number"==typeof v&&(v=a().add(v,"days"));var y=(g.format("YYYYMMDD"),v.format("YYYYMMDD"),0),b=12;for(g=g.clone(),g.add(1,"days"),v=v.clone(),v.add(1,"days"),1==r.renderValidMonth&&"object"==(void 0===g?"undefined":e(g))&&"object"==(void 0===v?"undefined":e(v))&&(p.val()==g.year()==v.year()?(y=g.month(),b=v.month()+1):p.val()==g.year()&&p.val()<v.year()?y=g.month():p.val()==v.year()&&(b=v.month()+1)),d=y;d<b;d++)d==l.month()?m.append(this.tag("option").val(d).text(d+1).attr("selected","selected")):m.append(this.tag("option").val(d).text(d+1));p.change(function(){t(this).parents("."+r.cssClass.main).empty().append(c.drawCalendar(n,r,o,c.dateAutoRepair(l.year(t(this).val()).format("YYYYMMDD"),r.toggleAlert)))}),m.change(function(){t(this).parents("."+r.cssClass.main).empty().append(c.drawCalendar(n,r,o,c.dateAutoRepair(l.month(parseInt(t(this).val())).format("YYYYMMDD"),r.toggleAlert)))}),u.find("."+r.cssClass.yearMonth).append(m)}var w=this.tag("tr").appendTo(u);for(d=0;d<7;d++)w.append(this.tag("th").addClass(r.cssClass.weekdayName).addClass(r.cssClass.weekday[d]).text(r.weekdayName[d]));var C=a(l).startOf("month"),D=a(l).endOf("month"),$=C.day(),T=D.date(),S=this.tag("tr").appendTo(u),_=0;for(d=0;d<$;d++)S.append(this.tag("td").addClass(r.cssClass.date)),_++;var x=a(C);for(d=1;d<=T;d++){x.date(d);var M=parseInt(n.attr("data-range")),k=this.tag("td").attr("data-date",x.format(r.dateFormat)).text(x.date()).addClass(r.cssClass.date).addClass(a(new Date).format(r.dateFormat)==x.format(r.dateFormat)?r.cssClass.today:"").addClass(s.format(r.dateFormat)==x.format(r.dateFormat)?r.cssClass.selected:"").addClass(r.cssClass.weekday[_]).addClass(r.isHoliday(x)?r.cssClass.holiday:"").addClass(r.isDisabled(x,isNaN(M)?-1:M)?r.cssClass.disabled:"").on("click",function(e){e.stopPropagation();var o,i=t(this),s=parseInt(n.attr("data-range")),l=i.attr("data-date");if(!i.hasClass(r.cssClass.disabled)){if(!r.range)return n.val(i.attr("data-date")).trigger("change"),void c.close(n);if(!n.attr("data-range")){if(n.val(i.attr("data-date")).attr("data-range",0).removeClass(r.cssClass.inputActive).trigger("change"),1===c.comparer(a(n.val().replace(/\//g,"")),a(c.getNextInputDom(s).val().replace(/\//g,"")))&&c.getAfterInputDom(s).val(""),c.getAfterInputDom(s).addClass(r.cssClass.inputActive),r.arrow){var d=t(r.range).offset().left-n.offset().left+t(r.range).width()+28;if(n.offset().top==t(r.range).offset().top&&d<t(".cy-ln").width()){var u=t(r.range).offset().left-t(".cy-ln").offset().left+t(r.range).width()/2-6;t("."+r.cssClass.arrow).css({left:u})}else clearInterval(c.timer),c.timer=setInterval(function(){t(".cy-ln").css({left:t(r.range).offset().left,top:t(r.range).offset().top+n.outerHeight()})},25)}return void i.trigger("mouseenter")}if(o=c.getPrevInputDom(s).val(),1===c.comparer(a(o.replace(/\//g,"")),a(l.replace(/\//g,"")))||""===c.getPrevInputDom(s).val())return c.getPrevInputDom(s).val(l),void c.getAfterInputDom(s).val("");t(r.range[s]).val(i.attr("data-date")).trigger("change"),c.getPrevInputDom(s).removeClass(r.cssClass.inputActive),s<r.range.length-1?(s++,n.attr("data-range",s),i.trigger("mouseenter")):c.close(n)}}).on("mouseenter",function(){var e,o=t(this),i=o.attr("data-date"),s=function(e){return e?t(r.range[e]):n}(n.attr("data-range")),l=function(t){return!!t&&parseInt(t)}(n.attr("data-range"));if(!t(this).hasClass(r.cssClass.disabled)&&(t(this).addClass(r.cssClass.hover),r.range&&(e=c.getPrevInputDom(l).val(),e&&1===c.comparer(a(e.replace(/\//g,"")),a(i.replace(/\//g,"")))?s.hasClass(r.cssClass.inputActive)&&(s.removeClass(r.cssClass.inputActive),c.getPrevInputDom(l).addClass(r.cssClass.inputActive)):s.hasClass(r.cssClass.inputActive)||(s.addClass(r.cssClass.inputActive),c.getPrevInputDom(l).removeClass(r.cssClass.inputActive)),r.range))){var d=parseInt(n.attr("data-range")),u=c.getArrayMoment(isNaN(d)?-1:d);u.push(a(t(this).attr("data-date").replace(/\W/g,""))),c.refreshDateForPeriod(u)}}).on("mouseleave",function(){t(this).hasClass(r.cssClass.disabled)||t(this).removeClass(r.cssClass.hover)});S.append(k),_=(_+1)%7,0==_&&(S=this.tag("tr").appendTo(u))}return u},n.prototype.getArrayInput=function(e,a){var n=[a];return-1==e&&(n=[]),t.each(this.options.range,function(a,r){"number"==typeof e&&e==a||n.push(t(r))}),n},n.prototype.getArrayMoment=function(e){var n=[];return t.each(this.getArrayInput(e,this.$input),function(e,r){var o=a(t(r).val().replace(/\W/g,""));o.isValid()&&n.push(o)}),n},n.prototype.refreshDateForPeriod=function(e){var n=e[0],r=e[e.length-1],o=this;0!=e.length&&(e.sort(this.comparer),t("."+this.options.cssClass.main+" ."+this.options.cssClass.date).each(function(i,s){var l=t(s),d=l.attr("data-date");if(d){var c=parseInt(o.$input.attr("data-range")),u=a(d.replace(/\W/g,""));l.removeClass(o.options.cssClass.disabled).removeClass(o.options.cssClass.selected).removeClass(o.options.cssClass.start).removeClass(o.options.cssClass.between).removeClass(o.options.cssClass.point).removeClass(o.options.cssClass.end).addClass(o.options.isDisabled(u,isNaN(c)?-1:c)?o.options.cssClass.disabled:""),o.equalsDatePart(u,n)?l.addClass(o.options.cssClass.between).addClass(o.options.cssClass.start):o.equalsDatePart(u,r)?l.addClass(o.options.cssClass.between).addClass(o.options.cssClass.end):o.isBetween(u,n,r)&&(-1==o.collectionIndexOf(e,u,o.equalsDatePart)?l.addClass(o.options.cssClass.between):l.addClass(o.options.cssClass.between).addClass(o.options.cssClass.point))}}))},n.prototype.close=function(){t("."+this.options.cssClass.main).remove(),this.getAllInputDom().removeClass(this.options.cssClass.inputActive),clearInterval(this.timer)},t.fn.cy_ln=function(r,o){return this.each(function(){var i=t(this),s=i.data("cy_ln"),l=null;if(s)if("string"==typeof r&&void 0===o)s[r]();else{if("string"!=typeof r||"object"!==(void 0===o?"undefined":e(o)))throw"unsupported options!";s[r](o)}else l=t.extend(!0,{},n.DEFAULTS,{getMomentMinDate:function(){return null==this.minDate?null:t.isNumeric(l.minDate)?a().add(l.minDate,"d"):null!=this.minDate?a(l.minDate):void 0},getMomentMaxDate:function(){return null==l.maxDate?null:t.isNumeric(l.maxDate)?a().add(l.maxDate,"d"):null!=this.maxDate?a(l.maxDate):void 0},isDisabled:function(e,a){var n=this.getMomentMinDate(),r=this.getMomentMaxDate();return!(null==n||!e.isSameOrBefore(n))||(!(null==r||!e.isAfter(r))||(!(!t.isFunction(this.disabled)||!this.disabled(e))||!(!t.isArray(this.disabled)||!this.disabled[a+1](e))))},isHoliday:function(e){return!(!t.isFunction(this.holiday)||!this.holiday(e))||!!(t.isArray(this.holiday)&&0<=t.inArray(e.format("YYYY/MM/DD"),l.holiday))}},"object"===(void 0===r?"undefined":e(r))&&r),s=new n(this,l),i.data("cy_ln",s),"string"==t.type(l.range)&&(l.range=[l.range]),function(e,n){t(e).on("click",function(r,o){r.stopPropagation();var i=t("body"),l=e.offset(),d=s.dateAutoRepair(e.val()||a().format(n.dateFormat)),c=function(t,e){return e&&e.isValid()?a(e).format(n.dateFormat):a().format(n.dateFormat)}(e.val(),n.minDate),u=s.tag("div"),p=function(t,e){return a(t.replace(/\//g,"")).isBefore(e.replace(/\//g,""))?e:t}(d,c);if(s.close(),s.getAllInputDom().removeClass(n.cssClass.inputActive),"number"==typeof o?(e.attr("data-range",o),t(n.range[o]).addClass(n.cssClass.inputActive)):e.attr("data-range",null).addClass(n.cssClass.inputActive),i.one("click",function(t){s.close(e)}).append(u.addClass(n.cssClass.main+" "+n.cssClass.extra).css({left:l.left,top:l.top+n.cssClass.top+e.outerHeight(),position:"absolute","z-index":"10001"}).append(s.drawCalendar(e,n,d,p))).find(".arrow").css({left:e.offset().left-t(".cy-ln").offset().left+e.width()/2-3}),n.arrow&&u.css({left:e.offset().left,top:e.offset().top+n.cssClass.top+e.outerHeight(),position:"absolute","z-index":"10001"}),s.timer=setInterval(function(){u.css({left:e.offset().left,top:e.offset().top+n.cssClass.top+e.outerHeight(),position:"absolute","z-index":"10001"})},25),t(".cy-ln").on("click",function(t){t.stopPropagation()}),n.range){var h=s.getArrayMoment();s.refreshDateForPeriod(h)}}).on("keydown",function(e){t(this).is(":focus")||s.close(),9===e.keyCode&&s.close()}).on("change",function(){var e=t(this).val(),a=s.dateAutoRepair(e,n.toggleAlert);t(this).val(a)}).on("checkDateRepair",function(){s.checkDateRepair(t(this))}).on("checkDateStatus",function(t,e){e.status=s.dateValueStatus(e.date)}),n.range&&"array"===t.type(n.range)&&t.each(n.range,function(r,o){t(o).on("focusin",function(){e.trigger("click",[r])}).on("keydown",function(e){t(this).is(":focus")||s.close(),9===e.keyCode&&s.close()}).on("click",function(t){t.stopPropagation()}).on("change",function(r){var o=t(this).val(),i=s.dateAutoRepair(o,n.toggleAlert),l=e.val().replace(/\//g,""),d=i.replace(/\//g,"");!!l&&a(l).isValid()&&!!d&&a(d).isValid()&&a(l).isAfter(d)?t(this).val(a(l).add(1,"d").format(n.dateFormat)):t(this).val(i)}).on("checkDateRepair",function(){s.checkDateRepair(t(this))}).on("checkDateStatus",function(t,e){e.status=s.dateValueStatus(e.date)})})}(i,s.options)})},t(function(){var e=t('[data-toggle="cy-ln"]');e.each(function(n,r){var o=t(this),i="range"==o.attr("data-role"),s="range"==o.attr("data-cy-ln"),l="true"==o.attr("data-arrow")||!1,d="true"==o.attr("data-change")||!1,c=void 0!==o.attr("data-minDate")?o.attr("data-minDate"):null,u=void 0!==o.attr("data-maxDate")?o.attr("data-maxDate"):null,p="true"==o.attr("data-toggleAlert")||!1,h=void 0!==o.attr("data-invalidAlert")?o.attr("data-invalidAlert"):"日期格式錯誤！",f=void 0!==o.attr("data-beforeMinAlert")?o.attr("data-beforeMinAlert"):"日期必須大於{#Date}！",m=void 0!==o.attr("data-afterMaxAlert")?o.attr("data-afterMaxAlert"):"日期必須小於{#Date}！",g=void 0!==o.attr("data-fromMoreTo")?o.attr("data-fromMoreTo"):"日期迄日不可小於起日";if(!i){for(var v=[],y=n+1;y<e.length&&"range"==e.eq(y).attr("data-role");y++)v.push(e.eq(y)[0]);o.cy_ln({monthCount:s?2:1,range:s?v:null,arrow:!!l,btnDisabled:!1,minDate:c?a().subtract(parseInt(c),"days"):null,maxDate:u?a().add(parseInt(u),"days"):null,weekdayName:["日","一","二","三","四","五","六"],changeMonthYear:!!d,toggleAlert:p,alertString:{invalid:h,beforeMin:f,afterMax:m,fromMoreTo:g}})}})})}(t,moment)}).call(window)},23:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"use strict";function a(a,o){if(n=t.extend(n,a),n.isRunning)return this.each(function(){var i=t(this),s=i.data("dtm_lnls"),l=t.extend({},r.DEFAULTS,i.attr("data-dtm-lnsl")?t.parseJSON(i.attr("data-dtm-lnsl").replace(/\n|\t/gim,"").replace(/\'/g,'"')):null);s||(i.data("dtm_lnls",s=new r(this,l,null)),i.on("focus",function(t){i.trigger("click",[!0])}),i.on("click",function(t,e){t.stopPropagation(),!s.inputDisabled&&e&&(i.trigger("dtm_lnlsInit"),(s.opts.autoOnly||s.opts.keywordQuery||s.opts.hotelQuery||s.opts.qQuery)&&i.trigger("inputShowAuto"))}),i.on("dtm_lnlsInit",function(a){var r=t(this);if(n.hideAll(),s.opts.keywordQuery||s.opts.hotelQuery||s.opts.qQuery){if(r.val().length>1)switch(e(s.opts.source)){case"string":s.$selected=null,s.getData()}}else if(!s.opts.source||s.data||s.opts.keywordQuery)s.data&&(s.opts.autoOnly||s.opts.bfmQuery&&!s.opts.toggleCustomMenu?s.showTarget(!0):s.showTarget(function(t){return"auto"===t&&r.val().length>0}(s.selectedMethod)));else switch(e(s.opts.source)){case"string":s.getData()}}),i.on("keydown",function(t){s.inputDisabled||(229==t.which?s.isInputIME=!0:s.isInputIME=!1)}),i.on("input",function(e){if(clearTimeout(s.timer),t(this).val().length>0&&!s.inputDisabled){var a=function(t){return 1==t?800:t>1&&t<4?300:10}(t(this).val().length);s.timer=setTimeout(function(){i.trigger("inputShowAuto")},a)}else s.inputDisabled||(s.hideTarget(),s.showTarget(!1),!!s.$target&&s.$target.filter(":not(.auto)").find("a").removeClass("active"))}),i.on("keyup",function(e){if(!s.inputDisabled)if(!s.isInputIME&&e.which>=37&&e.which<=40&&t(this).val().length>0){if(s.$target.filter(":not(.auto)").hasClass("show")&&s.hideTarget(),s.display)var a=s.$target.filter(".auto");else var a=s.showTarget(!0);var n=a.children("ul"),r=a.find("ul > li > a"),o=r.filter(".active"),i=r.index(s.$selected?s.$selected:o);i=-1==i?-1:i,r.length>0&&(r.removeClass("active"),40==e.which&&r.length>1?(s.$selected&&o?i++:i=0,i>=r.length&&(i=0),r.eq(i).addClass("active").trigger("click",[!0,s.opts.keyUpTriggerChange]),s.$selected=r.eq(i)):38==e.which&&r.length>1&&(s.$selected&&o?i--:i=-1,r.eq(i).addClass("active").trigger("click",[!0,s.opts.keyUpTriggerChange]),s.$selected=r.eq(i)),r.eq(i).position().top>=n.outerHeight()-r.eq(i).outerHeight()?n.scrollTop(r.eq(i).position().top+r.eq(i).outerHeight()-n.outerHeight()+n.scrollTop()):r.eq(i).position().top<0&&n.scrollTop(n.scrollTop()+r.eq(i).position().top))}else 13==e.which||27==e.which?!s.isInputIME&&s.$target&&s.$target.length>0&&s.autoSelector():s.isInputIME&&t(this).trigger("inputShowAuto")}),i.on("inputShowAuto",function(e){clearTimeout(s.timer),s.opts.keywordQuery||s.opts.hotelQuery||s.opts.qQuery?(s.$selected=null,t(this).val().length>1&&s.beforeVerfiy()?s.getData():s.beforeVerfiy()?s.renderNeedStringLength():s.renderVerfiy()):t(this).val().length>0&&(s.$selected=null,s.hideTarget(),s.showTarget(!0))})),"string"==typeof a&&(void 0!==o?s[a](o):s[a](i))})}var n={isRunning:!1,dataTemplate:{name:["vKeyName1","vKeyName2","vKeyName3"]},linkedValue:{name:["vKeyName1","vKeyName2"]},levelName:{name:["產品線","區域/國家","國家/城市","城市/產品"]},uniqueId:0,customArrangeData:function(t,e,a,n,r){},customMenuRenderHTML:function(t,e,a,n,r,o){},whenChooseFirst:function(t,e){},whenItemClicked:function(t,e,a){},whenDestinationShow:function(t,e){},whenSearchMoreClicked:function(t){},hideAll:function(){t('[data-toggle="dtm-lnls"]').each(function(e,a){var n=t(a).data("dtm_lnls");n&&(n.display=!1,!n.inputDisabled&&n.isInit&&"auto"===n.selectedMethod&&null===n.$selected&&n.autoSelector())}),t(".dtm-lnls").removeClass("show").attr("style","")},bnidBodyClickEvent:function(){t("body").on("click",function(){t(this).trigger("dtm-lnls.body.click")})}()},r=function(e,a,n){this.isInit=!1,this.$body=t(document.body),this.$input=t(e),this.$target=null,this.opts=a,this.sourceData=null,this.customMenuData=null,this.data=n,this.output=null,this.display=!1,this.inputDisabled=!1,this.selected=null,this.$selected=null,this.selectedMethod=null,this.isInputIME=!1,this.timer};r.DEFAULTS={spliteSymbol:", ",source:"",menuSource:!1,toggleCustomMenu:!1,runCustomMenuRenderer:!1,sendData:"",refDate:null,exclude:null,lineOrder:!1,customMenuLineOrder:!1,inline:!1,more:!1,moreString:"更多目的地，請輸入關鍵字",region:!1,autoOnly:!1,disabled:!1,autocomplete:!1,hoverSelect:!1,autoSelector:!0,rmValueWhenNoFound:!0,removeNotWordStringWhenSearch:!0,dataTemplate:null,arrangeDataSortByOrderLine:!1,runCustomArrangeData:!1,dontSliceFirstChar:!1,autoCategory:!1,matchKeyToSubCategory:!1,depthLimitStart:!1,toggleParentStringInAuto:!0,removeString:!1,replaceTo:!1,removeStringParent:!1,replaceToParent:!1,removeStringOnMenu:!1,removeStringOnAuto:!1,parentStringForward:!1,searchAllMergeString:!1,removeMergeString:!1,replaceToMerge:!1,searchParentString:!1,inputFillByTxt:!1,addKeyToString:!1,addKeyToStringReplaceTo:!1,keywordQuery:!1,keywordQueryMaxNum:!1,qQuery:!1,qQueryMaxNum:!1,hotelQuery:!1,hotelQueryMaxNum:!1,bfmQuery:!1,keyUpTriggerChange:!0,verfiyError:"請輸入以上必填欄位",style:"",closeManually:!1,itemActiveByManual:!1,mobileMode:!1,appendTargetPosition:null},r.prototype.beforeVerfiy=function(){if(this.opts.sendData&&"object"===e(this.opts.sendData))for(var t in this.opts.sendData)if(0==this.opts.sendData[t].length&&"sKeyWord"!=t)return!1;return!0},r.prototype.chooseFirstData=function(){var t="",e=function(t){var e=[];if(null===t)return null;for(var a=0;a<t.length;a++){e=[];for(var n in t[a])"_"!=t[a][n]&&t[a][n].length>0?e.push(!0):e.push(!1);if(-1===e.indexOf(!1))return t[a]}}(this.data);e&&void 0!==e&&null!==e?(t=e.txt,this.selected=e,this.selectedMethod="auto",this.$input.val(t),n.whenChooseFirst(this.selected,this.$input),this.$input.trigger("dtm_lnlsChanged",[this.$input,this.output]),this.opts.autoOnly?this.hideTarget(!0):this.hideTarget(!1)):(this.selected=null,this.selectedMethod=null,this.opts.rmValueWhenNoFound&&this.$input.val(""),this.$input.trigger("dtm_lnlsChanged",[this.$input,this.output]))},r.prototype.clearInput=function(a){var r=this;if(this.$input.val(""),(void 0===a||a instanceof t)&&void 0!==n.dataTemplate[this.opts.dataTemplate]){for(var a=n.dataTemplate[this.opts.dataTemplate].map(function(t){return"freeNew"==r.opts.dataTemplate||r.opts.dontSliceFirstChar?t.toLowerCase():t.toLowerCase().substr(1)}),o=0;o<a.length;o++)this.$input.attr("data-"+a[o],"");this.$input.attr("data-parentxt",""),this.$input.attr("data-txt","")}if("object"==e(this.selected))for(var i in this.selected)this.$input.attr("data-"+i,"");this.selected=null,this.$selected=null,this.selectedMethod=null,this.$input.trigger("dtm_lnlsChanged",[this.$input,this.output])},r.prototype.destroy=function(){!!this.$target&&this.$target.remove(),this.$input.removeData("dtm_lnls")},r.prototype.getCustomMenuData=function(e){var a=null,n=!!e&&"string"==typeof e&&e.length>0;return this.opts.toggleCustomMenu&&n&&t.ajax({type:"get",url:e,async:!1,success:function(t){for(var e={},n=t.match(/var\s\w+\s=/g),r=new Array(n.length),o=0;o<n.length;o++)n[o]=n[o].replace("var ","").replace(" =",""),r[o]=n[o];for(var i=0;i<r.length;i++)e[r[i]]=window[r[i]];for(var s=0;s<n.length;s++)window[n[s]]=null;a=e}}),a},r.prototype.getData=function(e){var a=this,r={type:function(){return a.opts.keywordQuery?"post":"get"},url:function(t,e){return t&&t.length>0?t:e}(e,this.opts.source),data:function(){var t={};return a.opts.keywordQuery?(t=a.opts.sendData,t.sKeyWord=a.$input.val(),t=Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")):a.opts.hotelQuery?t=a.opts.sendData:a.opts.qQuery?t.q=a.$input.val():t=a.opts.sendData,t},dataType:function(t){var e,n="",r=a.opts.source.lastIndexOf(".");switch(-1!=r&&(n=a.opts.source.substr(r+1,a.opts.source.length)),n){case"js":e="script";break;case"ashx":if(void 0!==t){var o=t.match(/var.*.=/g),i=t.match(/^\{/g);t.match(/^\[\{/g)}e=o?"script":i?"json":null;break;default:if("string"==typeof t){var o=t.match(/var.*.=/g),i=t.match(/^\{/g);t.match(/^\[\{/g)}e=o?"script":"json"}return e},cache:!1,async:function(){return!(!a.opts.keywordQuery&&!a.opts.hotelQuery)}};t.ajax({type:r.type(),url:r.url,data:r.data(),cache:r.cache,async:r.async(),dataType:r.dataType(),success:function(e){if(a.opts.keywordQuery||a.opts.hotelQuery||a.opts.bfmQuery||a.opts.qQuery||"json"!=r.dataType(e))if(a.opts.keywordQuery||a.opts.hotelQuery||a.opts.bfmQuery||a.opts.qQuery||"script"!=r.dataType(e)){if((a.opts.keywordQuery||a.opts.hotelQuery||a.opts.qQuery)&&!a.opts.bfmQuery)"string"==typeof e?0==e.length?null==a.$target?a.renderInit(a.sourceData):a.renderNoResult():a.opts.keywordQuery||a.opts.qQuery?a.sourceData=t.parseJSON(e):a.sourceData="string"==typeof e?t.parseJSON(e).Data:e.Data:a.opts.keywordQuery||a.opts.qQuery?a.sourceData=e:a.sourceData=e.Data,null==a.$target?a.renderInit(a.sourceData):a.renderKeywordData(a.$target.filter(".auto"));else if(a.opts.bfmQuery){for(var o,i,s=e.match(/var.*.=/g),l=0;l<s.length;l++)s[l]=s[l].replace("var ","").replace(" =",""),o=window[s[l]],window[s[l]]=null;i=o.map(function(t){var e=t.fullName.split("__"),a=/(?=\()*\w+(?=\))/g,n=/[A-Z|\W|\w]+(?=\(.+\))/g,r={countryCode:e[0]?e[0].match(a):null,countryName:e[0]?e[0].match(n):null,cityCode:e[1]?e[1].match(a):null,cityName:e[1]?e[1].match(n):null,airportCode:e[2]?e[2].match(a):null,airportName:e[2]?e[2].match(n):null,isCity:e.length<=2,label:null,intValue:e.length<=2?e[1]:e[2]};return r.label=r.countryName+"("+r.countryCode+")-"+r.cityName+"("+r.cityCode+")"+(r.airportName?"-"+r.airportName+"("+r.airportCode+")":""),r.countryCode=r.countryCode.toString(),r.countryName=r.countryName.toString(),r.cityCode=r.cityCode?r.cityCode.toString():null,r.cityName=r.cityName?r.cityName.toString():null,r.airportCode=r.airportCode?r.airportCode.toString():null,r.airportName=r.airportName?r.airportName.toString():null,r}),a.sourceData=o,a.data=i,null===a.$target?a.renderInit(a.sourceData,a.getCustomMenuData(a.opts.menuSource)):a.display?a.rederAutoData(a.$target.filter(".auto")):a.showTarget(!0)}}else{var d,c=n.dataTemplate[a.opts.dataTemplate],s=e.match(/var\s\w+\s=/g),u=new Array(c.length),o={};d=n.linkedValue[a.opts.dataTemplate]?{}:null;for(var p=0;p<s.length;p++){s[p]=s[p].replace("var ","").replace(" =","");var h=c.indexOf(s[p]);u[h]=s[p]}for(var f=0;f<u.length;f++)-1!=c.indexOf(u[f])&&(o[u[f]]=window[u[f]]);for(var l=0;l<s.length;l++)n.linkedValue[a.opts.dataTemplate]&&-1!=n.linkedValue[a.opts.dataTemplate].indexOf(s[l])&&(d[s[l]]=window[s[l]]),window[s[l]]=null;a.sourceData=o,a.renderInit(a.arrangeData(a.sourceData),a.getCustomMenuData(a.opts.menuSource)),d&&(a.output=d)}else a.sourceData=e,a.renderInit(a.arrangeData(a.sourceData))},error:function(t){}})},r.prototype.arrangeData=function(a){var r,o=this,i=[],s=n.dataTemplate[this.opts.dataTemplate],l=function(){return"freeNew"==o.opts.dataTemplate||o.opts.dontSliceFirstChar?s.map(function(t){return t.toLowerCase()}):s.map(function(t){return t.toLowerCase().substr(1)})}(),d=function(t){return t?/\w+(?=\))|(\(=?\w+)|\(\)|\)\)|\w+$|(\)\s)/gm:new RegExp(o.opts.removeString,"g")}("boolean"==typeof this.opts.removeString),c=function(t){return t?"":o.opts.replaceTo}("boolean"==typeof this.opts.replaceTo),u=function(t){return t?"":new RegExp(o.opts.removeStringParent,"g")}("boolean"==typeof this.opts.removeStringParent),p=function(t){return t?"":o.opts.replaceToParent}("boolean"==typeof this.opts.replaceToParent),h=function(t){return t?"":new RegExp(o.opts.removeMergeString,"g")}("boolean"==typeof this.opts.removeMergeString),f=function(t){return t?"":o.opts.replaceToMerge}("boolean"==typeof this.opts.replaceToMerge),m=function(e,a){for(var n,r,o=0;o<a.length;o++){var i;n=a[o].Line;for(var s=0;s<a[o].CountryList.length;s++){var l=t.map(a[o].CountryList[s],function(t,e){return t});if(-1!=(i=l.indexOf(e))){r=l[1];break}}if(-1!=i)break}return{line:n,txt:r}},g=function(t,a){var n;for(var r in a)if("object"===e(a[r])){var o=Object.keys(a[r]).indexOf(t);if(-1!=o){n=r;var i="string"==typeof u?a[r][t]:a[r][t].replace(u,p)}}return{parentKey:n,txt:i}};return this.opts.runCustomArrangeData?this.data=n.customArrangeData(this.opts.dataTemplate,a,s,l,{rRegex:d,toRegex:c,rRegexParent:u,toRegexParent:p}):("freeNew"!=this.opts.dataTemplate?function n(r,m,v){var y=m||0;for(var b in r){var w=s.indexOf(b),C=t.isArray(r[b]);if(-1!=w&&!m&&(y=w),"object"!==e(r[b])||C){if("string"==typeof r[b]&&0!=r[b].length&&"不限"!=r[b]||C){for(var D={},$=l.length-1;$<l.length&&$>=0;$--){var T=[];if(D.parentxt=[],$<y){if(y-$==1){var S=null,_=null;if(v.toLowerCase()===l[y]){for(var x in a[s[$]]){var M=a[s[$]][x].indexOf(b);-1!=M&&(S=x)}D[l[$]]=S}else D[l[$]]=v;null!==S&&void 0===a[s[$]][v]?(_=o.opts.refDate[s[$]][S],o.opts.addKeyToString?"string"==typeof u?D.parentxt.push(_+"("+S.replace(/_/g,"")+")"):D.parentxt.push((_+"("+S.replace(/_/g,"")+")").replace(u,p)):D.parentxt.push("string"==typeof u?_:_.replace(u,p))):a[s[$]]&&a[s[$]][v]&&(o.opts.addKeyToString?"string"==typeof u?D.parentxt.push(a[s[$]][v]+"("+v.replace(/_/g,"")+")"):D.parentxt.push((a[s[$]][v]+"("+v.replace(/_/g,"")+")").replace(u,p)):D.parentxt.push("string"==typeof u?a[s[$]][v]:a[s[$]][v].replace(u,p)))}else if(y-$>1){for(var k=0;k<y-$-1;k++){var Y=T[0]?T[0]:v,N=g(Y,a[s[y-(k+1)]]);if(void 0===N.parentKey&&void 0===N.txt&&o.opts.refDate&&"object"==e(o.opts.refDate[s[$]])){var S=function(t,e){for(var a in e){if(-1!=e[a].indexOf(t))return a}}(Y,a[s[$]]),_=o.opts.refDate[s[$]][S],A=a[s[y-(k+1)]][Y];T.unshift(S),o.opts.addKeyToString?"string"==typeof u?D.parentxt.push(A+"("+A.replace(/_/g,"")+")"):D.parentxt.push((A+"("+A.replace(/_/g,"")+")").replace(u,p)):D.parentxt.push("string"==typeof u?A:A.replace(u,p))}else T.unshift(N.parentKey),o.opts.addKeyToString?"string"==typeof u?D.parentxt.push(N.txt+"("+Y.replace(/_/g,"")+")"):D.parentxt.push((N.txt+"("+Y.replace(/_/g,"")+")").replace(u,p)):D.parentxt.push("string"==typeof u?N.txt:N.txt.replace(u,p))}D[l[$]]=T[0]}}else $===y?D[l[y]]=b:$>y&&(D[l[$]]="_")}if("string"==typeof r[b]?"boolean"==typeof o.opts.addKeyToString&&1==o.opts.addKeyToString?D.txt=function(t){return!1===t?r[b].replace(/\s$/g,""):r[b].replace(d,c).replace(/\s$/g,"")}(o.opts.removeRegex)+"("+b.replace(/_/g,"")+")":"string"==typeof o.opts.addKeyToString&&"string"==typeof o.opts.addKeyToStringReplaceTo?D.txt=function(t){return!1===t?r[b].replace(/\s$/g,""):r[b].replace(d,c).replace(/\s$/g,"")}(o.opts.removeRegex).replace(/\(\)/g,"")+b.replace(new RegExp(o.opts.addKeyToString,"g"),o.opts.addKeyToStringReplaceTo):D.txt=function(t){return!1===t?r[b].replace(/\s$/g,""):r[b].replace(d,c).replace(/\s$/g,"")}(o.opts.removeRegex):C&&(o.opts.refDate&&"object"==e(o.opts.refDate[s[y]])&&s[y]==Object.keys(o.opts.refDate)[y]?D.txt=o.opts.refDate[s[y]][b]:D.txt=b),D.txt=D.txt.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(e)}),o.opts.searchAllMergeString&&(D.parentxt.length>0?o.opts.parentStringForward?D.merged=D.parentxt.reverse().join(o.opts.spliteSymbol)+o.opts.spliteSymbol+D.txt:D.merged=D.txt+o.opts.spliteSymbol+D.parentxt.join(o.opts.spliteSymbol):D.merged=D.txt,"string"!=typeof h&&0!==h.length&&(D.merged=D.merged.replace(h,f))),o.opts.exclude&&"object"==e(o.opts.exclude)){var O=!0;for(var I in o.opts.exclude)-1!=o.opts.exclude[I].indexOf(D[I.toLowerCase()])&&(O=!1);O&&i.push(D)}else i.push(D)}}else n(r[b],y,b)}}(a):function t(n,o){var d=o||0,c={};for(var u in n)if("object"===e(n[u])){var p=s.indexOf(u);-1!=p&&!o&&(d=p),t(n[u],d)}else if("string"==typeof n[u]){for(var h=l.length-1;h<l.length&&h>=0;h--)if(h<d){if(d-h==1)l[h]==u.toLowerCase()&&(r=n[u]),c[l[h]]=r;else if("City"==u&&d-h>1){var f=m(r,a[s[d-1]]);c[l[h]]=f.line}}else h===d?u.toLowerCase()==l[d]&&(c[l[d]]=n[u]):h>d&&u.toLowerCase()==l[d]&&(c[l[h]]="_");"LineName"===u||"CountryName"===u?c.txt=n[u]:"CityName"===u&&(c.txt=n[u]+"("+n.CityEName+")"+n.City+"-"+f.txt)}Object.keys(c).length>2&&i.push(c)}(a),this.data=function(t,e,a,n){var r=[],o=new Array(e.length),i=[],s=0;if("boolean"==typeof t&&t){for(var l=0;l<a.length;l++)s=e.indexOf(a[l][n]),-1!==s?(void 0===o[s]&&(o[s]=[]),o[s].push(a[l])):i.push(a[l][n]);return r=function(t,e){for(var a=[],n=0;n<t.length;n++)a=a.concat(t[n]);return a.concat(e)}(o,i),r.filter(function(t){return void 0!==t})}return a.filter(function(t){return void 0!==t})}(this.opts.arrangeDataSortByOrderLine,this.opts.lineOrder,i,l[0])),this.data},r.prototype.renderMenuHTML=function(t,e,a,n,r){var o,i="",s=t,l=n,d=this;if(i+='<div class="dtm-lnls '+this.opts.style+(this.opts.mobileMode?" mobile":"")+'"><button class="close">×</button>',this.opts.more&&(i+='<div class="m-place"><span class="m-r-xs icon at"></span>'+this.opts.moreString+"</div>"),e[a[0]]){i+='<ul class="tabs">';for(var c=0;c<l.length;c++)o=s.filter(function(t){for(var e=[],a=0;a<r.length;a++){var n=r[a];0==a?e.push(t[n]==l[c]):e.push("_"==t[n])}return-1==e.indexOf(!1)}),o[0]&&(i+="<li><span>"+function(t){return t[0]?t[0].txt.replace(new RegExp(d.opts.removeStringOnMenu,"g"),""):""}(o)+"</span></li>");i+="</ul>"}else e[a[0]]={_9:"台灣"},l=["_9"];i+='<div class="ctns">';for(var c=0;c<l.length;c++)i+='<div class="panl">',i+='<a class="'+(this.opts.region?"sec-all":"sec-all hide")+'"'+function(t,e,a){var n="";if(t)for(var r in t)n+=" data-"+r+'="'+t[r]+'"';else for(var o=0;o<e.length;o++)n+=" data-"+e[o]+'="'+(0==o?a:"_")+'"';return n+='><span class="m-r-xs icon place"></span>'+(t?function(t,e){var a;return"string"==typeof e&&(a=new RegExp(e,"g")),t.replace(a,"")}(t.txt,d.opts.removeStringOnMenu):"")+"</a>"}(s.filter(function(t){for(var e=[],a=0;a<r.length;a++){var n=r[a];0==a?e.push(t[n]==l[c]):e.push("_"==t[n])}return-1==e.indexOf(!1)})[0],r,l[c]),i+=function(t,e){for(var n="",o=0;o<t.length;o++){var i=s.filter(function(a){for(var n=[],i=0;i<r.length;i++){var s=r[i];0==i?n.push(a[s]==e):1==i?n.push(a[s]==t[o][r[1]]):n.push("_"!=a[s])}return-1==n.indexOf(!1)});n+=2==a.length||0==i.length?"<span ":"<div ",n+=function(t,e,a){return' class="'+(t?"sec-wrap inline":2==e||0==a?"sec-wrap in-block":"sec-wrap")+'">'}(d.opts.inline,a.length,i),n+="<"+(2==d.opts.disabled?"span":"a")+function(t){var e="";for(var a in t)e+=" data-"+a+'="'+t[a]+'"';return e}(t[o])+'><span class="icon flag"></span>'+function(t,e){var a;return"string"==typeof e&&(a=new RegExp(e,"g")),t.replace(a,"")}(t[o].txt,d.opts.removeStringOnMenu)+"</"+(2==d.opts.disabled?"span":"a")+">",r[2]&&(n+="",n+=function(t,e){for(var a=t.length>0?"<ul>":"",n=0;n<t.length;n++)a+="<li><"+(3==d.opts.disabled?"span":"a")+function(t){var e="";for(var a in t)e+=" data-"+a+'="'+t[a]+'"';return e}(t[n])+">"+function(t,e){var a;return"string"==typeof e&&(a=new RegExp(e,"g")),t.replace(a,"")}(t[n].txt,d.opts.removeStringOnMenu)+"</"+(3==d.opts.disabled?"span":"a")+"></li>";return a+=t.length>0?"</ul>":""}(i,t[o][r[1]])),n+=2==a.length||0==i.length?"</span>":"</div>"}return n}(s.filter(function(t){for(var e=[],a=0;a<r.length;a++){var n=r[a];0==a?e.push(t[n]==l[c]):1==a?e.push("_"!=t[n]):e.push("_"==t[n])}return-1==e.indexOf(!1)}),l[c]),i+="</div>";return i+="</div>",i+="</div>"},r.prototype.renderCustomMenuHTML=function(t,e,a,n){var r="",o=function(e){return e||Object.keys(t)}(e),i=function(t,e,a){return Array.isArray(t)?t:Object.keys(e[a])}(a,t,o[0]),s=this,n=function(t){return t}(n);if(r+='<div class="dtm-lnls '+this.opts.style+(this.opts.mobileMode?" mobile":"")+'"><button class="close">×</button>',this.opts.more&&(r+='<div class="m-place"><span class="m-r-xs icon at"></span>'+this.opts.moreString+"</div>"),t[o[0]]){r+='<ul class="tabs">',r+=function(t,e){for(var a,n="",r=0;r<t.length;r++)(a=e[t[r]]||!1)&&(n+="<li><span>"+function(t){return t?t.replace(new RegExp(s.opts.removeStringOnMenu,"g"),""):""}(a)+"</span></li>");return n}(i,t[o[0]]),r+="</ul>",r+='<div class="ctns">';for(var l=0;l<i.length;l++)r+='<div class="panl">',r+='<a class="'+(this.opts.region?"sec-all":"sec-all hide")+'"'+function(t,e,a){for(var n=t[a],r="",o=0;o<e.length;o++)r+=" data-"+e[o]+'="'+(0==o?a:"_")+'"';return r+=' data-txt="'+n+'"',r+='><span class="m-r-xs icon place"></span>'+(n?function(t,e){var a;return"string"==typeof e&&(a=new RegExp(e,"g")),t.replace(a,"")}(n,s.opts.removeStringOnMenu):"")+"</a>"}(t[o[0]],n,i[l]),r+=function(t,e,a){var r,i="",l=t[a]||!1,d=[];if(d[0]=a,l)for(var c in l)r=e?e[c]:null,d[1]=c,i+=r&&0!=Object.keys(r).length?"<div ":"<span ",i+=function(t,e,a){return' class="'+(t?"sec-wrap inline":2==e||0==a?"sec-wrap in-block":"sec-wrap")+'">'}(s.opts.inline,o.length,r?Object.keys(r).length:0),i+="<"+(2==s.opts.disabled?"span":"a")+function(t,e,a){for(var n="",r=0;r<t.length;r++)n+=" data-"+t[r]+'="'+(e[r]?e[r]:"_")+'"';return n+=' data-txt="'+a+'"'}(n,d,l[c])+'><span class="icon flag"></span>'+function(t,e){var a;return"string"==typeof e&&(a=new RegExp(e,"g")),t.replace(a,"")}(l[c],s.opts.removeStringOnMenu)+"</"+(2==s.opts.disabled?"span":"a")+">",r&&(i+=function(t,e){var a=Object.keys(t).length>0?"<ul>":"";for(var r in t)d[2]=r,a+="<li><"+(3==s.opts.disabled?"span":"a"),a+=function(t,e,a){for(var n="",r=0;r<t.length;r++)n+=" data-"+t[r]+'="'+(e[r]?e[r]:"_")+'"';return n+=' data-txt="'+a+'"',n+=' data-parentxt=""'}(n,d,t[r]),a+=">",a+=function(t,e){var a;return"string"==typeof e&&(a=new RegExp(e,"g")),t.replace(a,"")}(t[r],s.opts.removeStringOnMenu),a+="</"+(3==s.opts.disabled?"span":"a")+"></li>";return a+=Object.keys(t).length>0?"</ul>":""}(r)),i+=r&&0!=Object.keys(r).length?"</div>":"</span>";return i}(t[o[1]],t[o[2]],i[l]),r+="</div>"}return r+="</div>",r+="</div>"},r.prototype.renderInit=function(t,e){var a,r,o,i=this,s="",l=(!!this.opts.keywordQuery||!!this.opts.hotelQuery||this.opts.qQuery,!!(this.opts.autoOnly||this.opts.keywordQuery||this.opts.hotelQuery||this.opts.qQuery));this.opts.keywordQuery||this.opts.hotelQuery||this.opts.qQuery||this.opts.bfmQuery||(a=n.dataTemplate[this.opts.dataTemplate],o=function(){return"freeNew"==i.opts.dataTemplate||i.opts.dontSliceFirstChar?a.map(function(t){return t.toLowerCase()}):a.map(function(t){return t.toLowerCase().substr(1)})}(),r=function(t,e){var n=[],r=function(t){var n=[];if(t){if("freeNew"==i.opts.dataTemplate){for(var r in t)t[r][a[0]]&&n.push(t[r][a[0]]);return n}return Object.keys(e)}}(e);if(t&&0!=t.length&&r&&void 0!==r){for(var o=0;o<t.length;o++)-1!==r.indexOf(t[o])&&n.push(t[o]);return n}return!1}(this.opts.lineOrder,this.sourceData[a[0]])||function(t){var e=[];for(var n in t)"freeNew"==i.opts.dataTemplate?t[n][a[0]]&&e.push(t[n][a[0]]):"_"!=n&&e.push(n);return e}(this.sourceData[a[0]])),l||this.opts.bfmQuery?this.beforeVerfiy()?(null==t||0==t.length?s+=this.renderNoResult(!0):s+=this.renderNeedStringLength(!0),this.opts.toggleCustomMenu&&e&&this.opts.runCustomMenuRenderer?s+=n.customMenuRenderHTML(this,this.opts.dataTemplate,e,a,this.opts.customMenuLineOrder?this.opts.customMenuLineOrder:r,o):this.opts.toggleCustomMenu&&e&&!this.opts.runCustomMenuRenderer&&(s+=this.renderCustomMenuHTML(e,a,this.opts.customMenuLineOrder?this.opts.customMenuLineOrder:r,o))):s+=this.renderVerfiy(!0,!1):(this.beforeVerfiy()?this.opts.toggleCustomMenu&&e&&this.opts.runCustomMenuRenderer?s+=n.customMenuRenderHTML(this,this.opts.dataTemplate,e,a,this.opts.customMenuLineOrder?this.opts.customMenuLineOrder:r,o):this.opts.toggleCustomMenu&&e&&!this.opts.runCustomMenuRenderer?s+=this.renderCustomMenuHTML(e,a,this.opts.customMenuLineOrder?this.opts.customMenuLineOrder:r,o):s+=this.renderMenuHTML(t,this.sourceData,a,r,o):s+=this.renderVerfiy(!0,!0),this.opts.autocomplete&&(this.beforeVerfiy()?s+='<div class="dtm-lnls auto '+this.opts.style+(this.opts.mobileMode?" mobile":"")+'"></div>':s+=this.renderVerfiy(!0,!1))),this.appendMenu(s)},r.prototype.searchObj=function(t,e){var a,r=[];if(!(this.opts.keywordQuery||this.opts.hotelQuery||this.opts.qQuery||this.opts.bfmQuery)){var o=n.dataTemplate[this.opts.dataTemplate];a=[];for(var i=0;i<o.length;i++)a.push(this.opts.dontSliceFirstChar?o[i].toLowerCase():o[i].toLowerCase().substr(1))}if(this.opts.keywordQuery||this.opts.bfmQuery)r=t.filter(function(t){return-1!=t.label.toLowerCase().indexOf(e.toLowerCase())}),r=r.map(function(t,a){return t.idx=t.label.toLowerCase().indexOf(e.toLowerCase()),t}).sort(function(t,a){var n=t.idx,r=a.idx;return t.HotelName==e&&(n=-1),a.HotelName==e&&(r=-1),n<r?-1:n>r?1:0}),"number"==typeof this.opts.keywordQueryMaxNum&&this.opts.keywordQueryMaxNum>0&&(r=r.splice(0,this.opts.keywordQueryMaxNum));else if(this.opts.qQuery)r=t.filter(function(t){return-1!=t.toLowerCase().indexOf(e.toLowerCase())}),"number"==typeof this.opts.qQueryMaxNum&&this.opts.qQueryMaxNum>0&&(r=r.splice(0,this.opts.qQueryMaxNum));else if(this.opts.hotelQuery)r=t.filter(function(t){return-1!=t.HotelName.toLowerCase().indexOf(e.toLowerCase())}),r=r.map(function(t,a){return t.idx=t.HotelName.toLowerCase().indexOf(e.toLowerCase()),t}).sort(function(t,a){var n=t.idx,r=a.idx;return t.HotelName==e&&(n=-1),a.HotelName==e&&(r=-1),n<r?-1:n>r?1:0}),"number"==typeof this.opts.hotelQueryMaxNum&&this.opts.hotelQueryMaxNum>0&&(r=r.splice(0,this.opts.hotelQueryMaxNum));else for(var s=0,l=t.length;s<l;s++)if(this.opts.depthLimitStart&&"string"==typeof t[s].txt){var d=this.opts.depthLimitStart;switch(d){case 1:this.opts.searchAllMergeString?-1!==t[s].merged.toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]):"_"!==t[s][a[0]]&&-1!==t[s].txt.toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]);break;case 2:"_"!==t[s][a[1]]&&(this.opts.searchAllMergeString?-1!==t[s].merged.toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]):-1!==t[s].txt.toLowerCase().indexOf(e.toLowerCase())?r.push(t[s]):this.opts.searchParentString&&t[s].parentxt.length>0&&-1!==t[s].parentxt.toString().toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]));break;case 3:"_"!==t[s][a[2]]&&(this.opts.searchAllMergeString?-1!==t[s].merged.toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]):-1!==t[s].txt.toLowerCase().indexOf(e.toLowerCase())?r.push(t[s]):this.opts.searchParentString&&t[s].parentxt.length>0&&-1!==t[s].parentxt.toString().toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]));break;case 4:"_"!==t[s][a[3]]&&(this.opts.searchAllMergeString?-1!==t[s].merged.toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]):-1!==t[s].txt.toLowerCase().indexOf(e.toLowerCase())?r.push(t[s]):this.opts.searchParentString&&t[s].parentxt.length>0&&-1!==t[s].parentxt.toString().toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]));break;default:"_"!==t[s][a.length-1]&&(this.opts.searchAllMergeString?-1!==t[s].merged.toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]):-1!==t[s].txt.toLowerCase().indexOf(e.toLowerCase())?r.push(t[s]):this.opts.searchParentString&&t[s].parentxt.length>0&&-1!==t[s].parentxt.toString().toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]))}}else"string"==typeof t[s].txt&&(this.opts.searchAllMergeString?-1!==t[s].merged.toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]):-1!==t[s].txt.toLowerCase().indexOf(e.toLowerCase())?r.push(t[s]):this.opts.searchParentString&&t[s].parentxt.length>0&&-1!=t[s].parentxt.toString().toLowerCase().indexOf(e.toLowerCase())&&r.push(t[s]));if(r.length>0)return r},r.prototype.renderVerfiy=function(e,a){var n,r,o,i=this,s="";if("boolean"==typeof e&&e)return s+='<div class="dtm-lnls '+(a?"no-wrapper":"auto")+" "+this.opts.style+(this.opts.mobileMode?" mobile":"")+'">',s+='<button class="close">×</button><div class="m-place"><span>'+this.opts.verfiyError+"</span></div>",s+="</div>";this.$target&&this.$target.length>0?(o=this.$target.filter(".auto"),n='<button class="close">×</button><div class="m-place"><span>'+this.opts.verfiyError+"</span></div>",r=t(n),o.html(""),o.filter(".auto").append(r),o.children(".close").one("click",function(t){i.hideTarget()}),this.showTarget(!0,!0)):(s+='<div class="dtm-lnls '+(a?"no-wrapper":"auto")+" "+this.opts.style+(this.opts.mobileMode?" mobile":"")+'">',s+='<button class="close">×</button><div class="m-place"><span>'+this.opts.verfiyError+"</span></div>",s+="</div>",this.appendMenu(s))},r.prototype.renderNoResult=function(e){var a=this,n="";if("boolean"==typeof e&&e)return n+='<div class="dtm-lnls auto '+this.opts.style+(this.opts.mobileMode?" mobile":"")+'">',n+='<button class="close">×</button><p class="none">很抱歉，找不到符合的項目</p>',n+="</div>";if(this.$target&&this.$target.length>0){var r=this.$target.filter(".auto"),o=t('<button class="close">×</button><p class="none">很抱歉，找不到符合的項目</p>');r.html(""),r.filter(".auto").append(o),r.children(".close").one("click",function(t){a.$input.data("dtm_lnls").hideTarget()}),this.showTarget(!0,!0)}else this.appendMenu(this.renderNoResult(!0))},r.prototype.renderNeedStringLength=function(e){var a=this,n="",r=!!this.opts.keywordQuery||!!this.opts.hotelQuery||!!this.opts.qQuery;if("boolean"==typeof e&&e)return n+='<div class="dtm-lnls auto '+this.opts.style+(this.opts.mobileMode?" mobile":"")+'">',n+='<button class="close">×</button><div class="m-place"><span>請輸入至少'+(r?"兩":"一")+"個文字</span></div>",n+="</div>";if(this.$target&&this.$target.length>0){var o=this.$target.filter(".auto"),i='<button class="close">×</button><div class="m-place"><span>請輸入至少'+(r?"兩":"一")+"個文字</span></div>",s=t(i);o.html(""),o.append(s),o.children(".close").one("click",function(t){a.$input.data("dtm_lnls").hideTarget()}),this.showTarget(!0,!0)}else this.appendMenu(this.renderNeedStringLength(!0))},r.prototype.rederAutoData=function(a){var r,o,i,s,l,d,c,u=this,p=this.opts.removeNotWordStringWhenSearch?this.$input.val().replace(/[_+.,!@#$%^&*;\{\}\[\]\\\/|<>"'\?]/g,""):this.$input.val(),h="",f=[],m=a.filter(".auto");if(r=p.length>0?this.searchObj(this.data,p):null,this.beforeVerfiy())if(0==p.length)this.renderNeedStringLength();else if(r){if(a.html(""),h+="<ul>",this.opts&&this.opts.autoCategory){var g=n.dataTemplate[this.opts.dataTemplate]||null,v=n.levelName[this.opts.dataTemplate],y=[];if(g.length>0)for(var b=0;b<g.length;b++)y.push(this.opts.dontSliceFirstChar?g[b].toLowerCase():g[b].toLowerCase().substr(1));for(var b=1;b<v.length;b++)if("object"==e(this.opts.matchKeyToSubCategory)&&null!==this.opts.matchKeyToSubCategory[b]&&this.opts.matchKeyToSubCategory.length>0&&this.opts.matchKeyToSubCategory[b].length==v[b].split(",").length)for(var w=0;w<v[b].split(",").length;w++)h+='<li class="level'+b+"-"+w+'"><em><span class="icon '+(1==b?"place":"flag")+'"></span>'+v[b].split(",")[w]+"</em></li>";else h+='<li class="level'+b+'"><em><span class="icon '+(1==b?"place":"flag")+'"></span>'+v[b]+"</em></li>"}h+="</ul>",o=t(h),s=o.find(".level1"),l=o.find(".level2"),d=o.find(".level3");for(var b=0;b<r.length;b++){c="";var C="";c="<li><a"+function(t){var a="";for(var n in t)a+=" data-"+n+'="'+t[n]+'"';C=u.opts.searchAllMergeString?"merged":u.opts.bfmQuery?"label":"txt";var r=t[C].toLowerCase().indexOf(p.toLowerCase()),o=p.length,i=-1!=r?t[C].substr(r,o):"",s=t[C].substr(0,r),l=-1!=r?t[C].substr(r+o):t[C],d=function(t,a){if(void 0!==t&&"object"===(void 0===t?"undefined":e(t))&&t.length>0){if(u.opts.searchParentString){var n=t.join(u.opts.spliteSymbol),r=n.toLowerCase().indexOf(a.toLowerCase()),o=p.length,i=-1!=r?n.substr(r,o):"",s=n.substr(0,r),l=-1!=r?n.substr(r+o):n,d=i.length>0?s+'<span class="match">'+i+"</span>"+l:s+l;return u.opts.parentStringForward?d+u.opts.spliteSymbol:u.opts.spliteSymbol+d}return u.opts.parentStringForward?t.join(u.opts.spliteSymbol)+u.opts.spliteSymbol:u.opts.toggleParentStringInAuto?u.opts.spliteSymbol+t.join(u.opts.spliteSymbol):""}return t}(u.opts.searchAllMergeString?"":t.parentxt,p);return!1!==u.opts.removeStringOnAuto&&"string"==typeof u.opts.removeStringOnAuto&&(d=d.replace(new RegExp(u.opts.removeStringOnAuto),"")),u.opts.parentStringForward?a+=">"+(d||"")+s+'<span class="match">'+i+"</span>"+l:a+=">"+s+'<span class="match">'+i+"</span>"+l+(d||""),a}(r[b])+"</a></li>";var D=t(c),$=s.nextUntil(".level2"),T=l.nextAll(),S=$.last(),_=$.length,x=d.nextAll(),M=x.last();if(this.opts)if(this.opts.autoCategory&&!this.opts.bfmQuery)if("_"==r[b][y[1]]);else if("_"==r[b][y[2]])_>0?S.after(D):s.after(D);else if("_"!=r[b][y[1]]&&"_"==r[b][y[3]])"object"==e(this.opts.matchKeyToSubCategory)&&null!==this.opts.matchKeyToSubCategory[3]?l.nextUntil(".level3-0").length>0?l.nextUntil(".level3-0").last().after(D):l.after(D):l.nextUntil(".level3").length>0?l.nextUntil(".level3").last().after(D):l.after(D);else if("_"!=r[b][y[1]]&&"_"!=D.attr("data-"+y[3]))if("object"==e(this.opts.matchKeyToSubCategory)&&null!==this.opts.matchKeyToSubCategory[3]){for(var k=0;k<this.opts.matchKeyToSubCategory[3].length;k++)0===this.opts.matchKeyToSubCategory[3][k].length?f[k]=!0:null!==r[b][y[3]].match(new RegExp(this.opts.matchKeyToSubCategory[3][k]))?f[k]=!0:f[k]=!1;i=f.lastIndexOf(!0),o.find(".level3-"+i).nextUntil(".level3-"+(i+1)).length>0?o.find(".level3-"+i).nextUntil(".level3-"+(i+1)).last().after(D):o.find(".level3-"+i).after(D)}else x.length>0?M.after(D):d.after(D);else o.append(D);else this.opts.autoCategory&&this.opts.bfmQuery?r[b].countryName&&null!=r[b].cityName&&null!=r[b].airportName?T.length>0?T.last().after(D):l.after(D):r[b].countryName&&null!=r[b].cityName&&null==r[b].airportName?_>0?S.after(D):s.after(D):o.append(D):o.append(D);else o.append(D)}if(m.append(o),this.opts&&this.opts.autoCategory)for(var Y=m.find("li[class^=level]"),b=0;b<Y.length;b++){var N=t(Y.eq(b)).nextUntil(Y.eq(b+1));0==N.length&&Y.eq(b).length>0&&Y.eq(b).remove()}}else this.renderNoResult();else a.html(""),o=t(this.renderVerfiy()),m.append(o),a.children(".close").one("click",function(t){u.$input.data("dtm_lnls").hideTarget()})},r.prototype.renderKeywordData=function(e){var a=this,r=this.opts.removeNotWordStringWhenSearch?this.$input.val().replace(/^\s+/g,"").replace(/[_+.,!@#$%^&*();\\\/|<>"']/g,""):this.$input.val(),o="";if(r.length>1)var i=this.searchObj(function(e){return"string"==typeof e&&(e=t.parseJSON(e)),e}(a.sourceData),r);else var i=null;if(this.beforeVerfiy())if(r.length<=1)this.renderNeedStringLength();else if(i){e.html(""),o+='<ul class="keyword">',o+="</ul>";for(var s=t(o),l=0;l<i.length;l++){var d,c="";c+="<li><a"+function(t){var e,n="";if(a.opts.qQuery)n+=' data-txt="'+t+'"';else for(var o in t)n+=" data-"+o+'="'+t[o]+'"';if(a.opts.keywordQuery||a.opts.hotelQuery){e=a.opts.keywordQuery?"label":"HotelName";var i=t[e].toLowerCase().indexOf(r.toLowerCase()),s=r.length,l=t[e].substr(i,s),d=t[e].substr(0,i),c=t[e].substr(i+s);n+=">"+d+'<span class="match">'+l+"</span>"+c}else if(a.opts.qQuery){var i=t.toLowerCase().indexOf(r.toLowerCase()),s=r.length,l=t.substr(i,s),d=t.substr(0,i),c=t.substr(i+s);n+=">"+d+'<span class="match">'+l+"</span>"+c}return n}(i[l])+"</a></li>",d=t(c),s.append(d)}if(e.filter(".auto").append(s),this.showTarget(!0,!0),i.length>=10){var u=t('<a href="#" class="smore">搜尋更多"'+r+'"的產品</a>');e.filter(".auto").append(u),u.one("click",function(t){t.stopPropagation(),t.preventDefault(),n.whenSearchMoreClicked(a.$input)})}}else this.renderNoResult();else{e.html("");var s=t(this.renderVerfiy());e.filter(".auto").append(s),e.children(".close").one("click",function(t){a.$input.data("dtm_lnls").hideTarget()})}},r.prototype.appendMenu=function(e,a){var r=t(e),o=this;null==this.$target?(this.$target=r,this.opts.appendTargetPosition?t(this.opts.appendTargetPosition).append(this.$target):this.$body.append(this.$target),this.$target.attr("data-id",n.uniqueId),this.$input.attr("data-target",n.uniqueId),this.tabsControl(),this.$target.children(".close").on("click",function(t){o.hideTarget()}),n.uniqueId++):(this.$target.filter(".auto").html(r.filter(".auto").html()),this.$target.filter(":not(.auto)").html(r.filter(":not(.auto)").html()),0==this.$target.filter(":not(.auto)").find("ul.tabs").length?this.$target.filter(":not(.auto)").addClass("no-wrapper"):this.$target.filter(":not(.auto)").removeClass("no-wrapper"),this.tabsControl(),this.$target.children(".close").off("click").on("click",function(t){o.hideTarget()})),!this.opts.autoOnly&&!this.opts.bfmQuery||this.opts.toggleCustomMenu?(this.isInit||this.showTarget(!1),this.bindItemClickEvent(!1)):(this.showTarget(!0),this.bindItemClickEvent(!0)),this.isInit=!0},r.prototype.updateOptions=function(e){e&&(this.opts=t.extend({},r.DEFAULTS,t.parseJSON(e.replace(/\n|\t/gim,"").replace(/\'/g,'"'))),this.data=null,this.isInit=!1)},r.prototype.bindItemClickEvent=function(e){var a=this;this.$target.delegate("a","click",function(r,o,i){var s=t(this),l=s.closest(".dtm-lnls"),d="";if(a.opts.autoOnly?(d=a.opts.keywordQuery?s.attr("data-value"):a.opts.hotelQuery?s.attr("data-hotelname"):a.opts.searchAllMergeString&&!a.opts.inputFillByTxt?s.attr("data-merged"):s.attr("data-txt"),a.selected=s.data(),a.selectedMethod="auto"):a.opts.bfmQuery?(d=s.attr("data-intvalue"),a.selected=s.data()):(d=a.opts.searchAllMergeString&&!a.opts.inputFillByTxt&&s.attr("data-merged")?s.attr("data-merged"):s.attr("data-txt"),a.selected=s.data()),a.$selected=s,s.closest(".dtm-lnls").hasClass("auto")?a.selectedMethod="auto":a.selectedMethod="menu",l.find("a").removeClass("active"),s.addClass("active"),a.$input.val(d),n.whenItemClicked(a.$target,s,a.$input),void 0===i)var i=!0;i&&a.$input.trigger("dtm_lnlsChanged",[a.$input,a.output]),e?!o&&a.hideTarget(!0):!o&&!a.opts.closeManually&&a.hideTarget(!1)})},r.prototype.bindItemMouseOverEvent=function(){var e=this;this.$target.filter(".auto").find("ul>li>a");this.$target&&this.$target.filter(".auto").delegate("a","mouseover",function(a){e.$target.filter(".auto").find("ul>li>a").removeClass("active"),e.opts.hoverSelect?(e.$selected=t(a.currentTarget).filter("a"),e.$selected.addClass("active")):t(a.currentTarget).addClass("active")})},r.prototype.unbindItemMouseOverEvent=function(){null!==this.$target&&this.$target.filter(".auto").undelegate("a","mouseover")},r.prototype.showTarget=function(t,e){var a,r=this,o=!!this.opts.keywordQuery||!!this.opts.hotelQuery||!!this.opts.qQuery;return t&&e?this.$target&&(a=this.$target.filter(".auto")):t?(this.$target&&(a=this.$target.filter(".auto")),o?this.sourceData&&this.sourceData.lenght>0&&this.renderKeywordData(a):this.opts.bfmQuery?(this.rederAutoData(a),this.$target.filter(".auto").find(".sec-wrap a").removeClass("active")):(this.rederAutoData(a),this.$target.filter(":not(.auto)").find(".sec-wrap a").removeClass("active"))):null!==this.$target&&this.$target.length>0&&(a=this.$target.filter(":not(.auto)")&&!this.opts.autoOnly?this.$target.filter(":not(.auto)"):this.$target.filter(".auto")),null!==this.$target&&this.$target.length>0&&this.toggleMenu(a,!0),this.$body.off("dtm-lnls.body.click").one("dtm-lnls.body.click",function(t){!r.inputDisabled&&r.$target&&r.$target.length>0&&r.display&&r.$target.filter(".auto").hasClass("show")&&r.opts.autoSelector?r.autoSelector():r.hideTarget()}),this.$target&&this.$target.filter(".auto")&&this.bindItemMouseOverEvent(),n.whenDestinationShow(a,this.$input),a},r.prototype.toggleMenu=function(t,e){"boolean"==typeof e?e?(t.addClass("show"),!this.opts.mobileMode&&this.setPosition(t),this.display=!0):(t.removeClass("show"),this.display=!1):!0===this.display||t.hasClass("show")?(t.removeClass("show"),this.display=!1):(t.addClass("show"),!this.opts.mobileMode&&this.setPosition(t),this.display=!0)},r.prototype.autoSelector=function(e){var a=this;if(this.$target.hasClass("show")){var n=this.$target.filter(".auto").find("ul > li > a"),r=this.$target.filter(".auto").hasClass("show"),o=null;1===n.length?n.eq(0).trigger("click"):r&&n.length>0&&this.$selected?(o=n.filter(function(){return a.$selected.text()&&a.$selected.text().length>0?t(this).text()==a.$selected.text():a.$selected.attr("data-label")&&a.$selected.attr("data-label").length>0?t(this).text()==a.$selected.attr("data-label"):t(this).text()==n.eq(0).text()}),o.trigger("click")):r&&n.length>0&&!this.$selected&&this.$input.val().length>0?n.eq(0).trigger("click"):r&&0===n.length&&this.opts.rmValueWhenNoFound?(this.$input.val(""),this.hideTarget()):this.hideTarget()}},r.prototype.setPosition=function(e){var a=e||this.$target.filter(".show"),n=this.$input.offset();n.right=Math.round(t(document).width()-(n.left+this.$input.outerWidth())),a.css({top:n.top+this.$input.outerHeight(),"z-index":"50","min-width":this.$input.outerWidth()-1}),n.left+a.outerWidth()>t(document).width()?(a.css({right:n.right}),a.children(".m-place").addClass("right")):(a.css({left:n.left}),a.children(".m-place").removeClass("right"))},r.prototype.hideTarget=function(t){t&&"boolean"==typeof t?this.$target&&(this.$target.filter(".auto").attr("style",""),this.toggleMenu(this.$target.filter(".auto").removeClass("show"),!1)):this.$target&&(this.$target.attr("style",""),this.toggleMenu(this.$target,!1)),0==this.$input.val().length&&this.clearInput(),this.display=!1,this.unbindItemMouseOverEvent()},r.prototype.tabsControl=function(){var t=this.$target,e=t.children(".tabs").children("li").children("span"),a=t.children(".ctns").children(".panl"),n=0,r=!1;t.on("click",function(t){t.stopPropagation()});var o=function(t){t!==n&&t>=0&&t<=e.length&&(e.eq(n).removeClass("active"),e.eq(t).addClass("active"),a.eq(n).removeClass("active"),a.eq(t).addClass("active"),n=t)};if(!r){r=!0;for(var i=0;i<e.length;i++)!function(t,e){t.on("click",function(t){t.preventDefault(),o(e)})}(e.eq(i),i)}e.eq(n).addClass("active"),a.eq(n).addClass("active")},r.prototype.toggleDisabled=function(t){void 0===t||"null"==typeof t?this.inputDisabled?this.inputDisabled=!1:this.inputDisabled=!0:"boolean"==typeof t&&(this.inputDisabled=t)},t.fn.dtm_lnls=a,t.fn.dtm_lnls.Constructor=r}(t)}).call(window)},25:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(e){(t.browser=t.browser||{}).mobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera),function(t){"use strict";function a(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var a in e)if(void 0!==t.style[a])return{end:e[a]};return!1}function n(a,n){return this.each(function(){var o=t(this),i=o.data("modal"),s=t.extend({},r.DEFAULTS,o.data(),"object"==(void 0===a?"undefined":e(a))&&a);i||o.data("modal",i=new r(this,s)),"string"==typeof a?i[a](n):s.show&&i.show(n)})}t.fn.emulateTransitionEnd=function(e){var a=!1,n=this;t(this).one("bsTransitionEnd",function(){a=!0});var r=function(){a||t(n).trigger(t.support.transition.end)};return setTimeout(r,e),this},t(function(){t.support.transition=a(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})});var r=function(e,a){if(this.options=a,this.$window=t(window),this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.$contents=t(e).find(".modal-content"),this.$ctnBody=this.$contents.children(".modal-body").length>0?this.$contents.children(".modal-body"):this.$contents.children("iframe"),this.$ctnFoot=this.$contents.children(".modal-footer"),this.isMove=this.$contents.length>1,this.isShown=null,this.isLoadingIframe=!1,this.isWaitforSwitch=!1,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.switchIframeStatus={action:"",direction:""},this.iframePostEvents=function(e){function a(e,a,n){if(0===t(e).length&&(e=r.$element.get(0)),void 0===n)var n=1;if("string"==typeof n&&"active"==n)var o=t(e).find(".modal-content").find("iframe.active");else var o=t(e).find(".modal-content").find("iframe:nth-child("+n+")");o.css("height",parseInt(a))}function n(e,a,n){if(!("horizontal"!=n&&"vertical"!=n||"prev"!=a&&"next"!=a)){var r=t(e).find(".modal-content"),o=t(e).find("iframe"),i=t(e).find("iframe.active"),s=i,l=t('<div class="holder"></div>'),d="",c="",u=0;switch(a){case"prev":s=s.prev("iframe"),"horizontal"==n?(d="right",c="left"):"vertical"==n&&(d="bottom",c="top",u=-i.height()-30);break;case"next":s=s.next("iframe"),"horizontal"==n?(d="left",c="right"):"vertical"==n&&(d="top",c="bottom",u=i.height()+30)}i.removeClass("active").addClass("middle"),s.removeClass(c).addClass("middle"),i.removeClass("middle").addClass(d).css({top:u}),r.append(l.height(i.height()).css("margin","0")),l.height(s.outerHeight(!0)),s.css({visibility:""}),i.one(this.transitionEvent,function(){o.removeClass("left right top bottom"),i.css({display:"",height:"auto"});setTimeout(function(){o.removeClass("middle"),s.addClass("active"),l.remove()},50)})}}var r=this,o=e.data.replace(/(^[\w-]+)(\?.+)/,"$1"),i=e.data.replace(/[\w-]+(\?)(.+)/,"$2").split("&").map(function(t){return t=t.split("="),this[t[0]]=t[1],Object.keys(this).length>0&&-1===function(t){var e=[];for(var a in t)e.push(t[a]);return e}(this).indexOf(void 0)?this:null}.bind({}))[0],s=this.$contents.find("iframe:first-child").get(0);switch(o){case"close":this.hide();break;case"hello":"object"===t.type(this.options.iframeSendToChild.hello)?s.contentWindow.postMessage("yes?"+t.param(this.options.iframeSendToChild.hello),"*"):s.contentWindow.postMessage("yes?docWidth="+document.documentElement.clientWidth,"*");break;case"load":i.hasOwnProperty("height")&&(i.hasOwnProperty("nthIframe")&&"undefined"!==i.nthIframe||(i.nthIframe=1),a(i.target,i.height,i.nthIframe),this.isLoadingIframe=!1,this.isWaitforSwitch&&(n.call(this,i.target,this.switchIframeStatus.action,this.switchIframeStatus.direction),this.isWaitforSwitch=!1));break;case"check":i.hasOwnProperty("height")&&a(i.target,i.height,"active");break;case"prev":case"next":i.hasOwnProperty("iframeUrl")&&(this.isLoadingIframe=!0,i.hasOwnProperty("direction")||(i.direction="horizontal"),function(e,a,n,r){var o="",i=t(a).find("iframe.active");switch(e){case"prev":i=i.prev("iframe"),"horizontal"==r?o="left":"vertical"==r&&(o="top");break;case"next":i=i.next("iframe"),"horizontal"==r?o="right":"vertical"==r&&(o="bottom")}i.addClass(o),i.attr("src",n),i.attr("scrolling","no"),i.css({display:"block",visibility:"hidden"})}(o,i.target,i.iframeUrl,i.direction),this.switchIframeStatus.action=o,this.switchIframeStatus.direction=i.direction,this.isWaitforSwitch=!0)}}.bind(this),this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.modal")},this)),this.options.iframe){var n=this.$element.find(".modal-content"),r=n.find("iframe:first-child");this.isLoadingIframe=!0,r.attr("src",this.options.iframe),r.attr("scrolling","no"),r.addClass("active"),this.iframeEventListener(!0),this.transitionEvent=function(t){var e,a=document.createElement("fakeelement");for(e in t)if(void 0!==a.style[e])return t[e]}({transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"})}};r.TRANSITION_DURATION=300,r.BACKDROP_TRANSITION_DURATION=150,r.DEFAULTS={backdrop:!0,keyboard:!0,show:!0,bodyScroll:!1,bodyMaxHeight:.75*t(window).height(),iframeSendToChild:{hello:{docWidth:document.documentElement.clientWidth},load:{},check:{},close:function(){}},whenShowModalStart:function(t){},whenShowModalEnd:function(t){},whenHideModalStart:function(t){},whenHideModalEnd:function(t){}},r.prototype.toggle=function(t){return this.options.iframe&&this.iframeEventListener(!0),this.isShown?this.hide():this.show(t)},r.prototype.show=function(e){var a=this,n=t.Event("show.modal",{relatedTarget:e});if(this.$element.trigger(n),!this.isShown&&!n.isDefaultPrevented()){if(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("mdl_lnls_open"),this.escape(),this.resize(),this.$element.on("click.dismiss.modal",'[data-dismiss="mdl_lnls"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.modal",function(){a.$element.one("mouseup.dismiss.modal",function(e){t(e.target).is(a.$element)&&(a.ignoreBackdropClick=!0)})}),this.$element.on("click.move.content",'[data-move="mdl_lnls"]',t.proxy(function(e){var a=t(e.target),n=a.attr("data-step");this.contentMove(n)},this)),this.$element.find("iframe").first().attr("src",this.options.iframe),this.$element.find("iframe").first().addClass("active"),!0===this.isMove){this.$contents.addClass("hide");var o=this.$contents.filter(".active");o.length&&1==o.length?o.removeClass("hide"):this.$contents.eq(0).addClass("active").removeClass("hide")}"function"===t.type(this.options.whenShowModalStart)&&this.options.whenShowModalStart(this.$element),this.backdrop(function(){var n=t.support.transition&&a.$element.hasClass("fade");a.$element.parent().length||a.$element.appendTo(a.$body),a.$element.show().scrollTop(0),a.adjustDialog(),n&&a.$element[0].offsetWidth,a.$element.addClass("in"),a.enforceFocus();var o=t.Event("shown.modal",{relatedTarget:e});t.browser.mobile&&(a.$ctnBody.css("max-height",a.options.bodyMaxHeight),a.$ctnFoot.length>0&&a.$ctnBody.hasClass("scroll-y")&&document.documentElement.clientWidth<980&&(a.$contents.append('<div class="content-fadeout"></div>'),a.$contents.find(".content-fadeout").css({bottom:a.$ctnFoot.outerHeight()}))),n?a.$dialog.one("bsTransitionEnd",function(){a.$element.trigger("focus").trigger(o),"function"===t.type(a.options.whenShowModalEnd)&&a.options.whenShowModalEnd(a.$element)}).emulateTransitionEnd(r.TRANSITION_DURATION):a.$element.trigger("focus").trigger(o)})}},r.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.modal"),this.$element.removeClass("in").off("click.dismiss.modal").off("mouseup.dismiss.modal").off("click.move.content"),this.$dialog.off("mousedown.dismiss.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(r.TRANSITION_DURATION):this.hideModal(),t(window).off("resize"))},r.prototype.nextMover=function(){this.contentMove("next")},r.prototype.prevMover=function(){this.contentMove("prev")},r.prototype.contentMove=function(e){if(e){var a=e,n=this;this.canSwicth(a,function(e){var r=e.$contentActive,o=e.$contentNext,i=t('<div class="placeholder"></div>');i.css({width:r.outerWidth(),height:r.outerHeight()}),n.$dialog.children(".modal-wrap").append(i);var s=function(){return"prev"==a?"vertical"==e.direction?"bottom":"right":"vertical"==e.direction?"top":"left"}(),l=function(){return"prev"==a?"vertical"==e.direction?"top":"left":"vertical"==e.direction?"bottom":"right"}();r.addClass("middle").removeClass("active").delay(1).queue(function(){n.$element.trigger("move.start"),r.removeClass("middle").addClass(s).one("bsTransitionEnd",function(){r.addClass("hide").removeClass(s)}),i.css({width:o.outerWidth(),height:o.outerHeight()}),t(this).dequeue()}),o.removeClass("hide").addClass(l).delay(1).queue(function(){o.removeClass(l).addClass("middle").one("bsTransitionEnd",function(){o.addClass("active").removeClass("middle"),i.remove(),n.$element.trigger("move.done")}),t(this).dequeue()}),n.$element.one("hidden.modal",function(){i.remove()})})}},r.prototype.canSwicth=function(t,e){if(this.$contents.length>1){var a=this.$contents.filter(".active"),n=this.$contents.index(a);if("next"==t){var r=n+1;r>=this.$contents.length&&(r=0)}else if("prev"==t)var r=n-1;var o=this.$contents.eq(r);if("function"==typeof e){e({$contentActive:a,$contentNext:o,direction:o.attr("data-direction")||"horizontal"})}return!0}return!1},r.prototype.enforceFocus=function(){t(document).off("focusin.modal").on("focusin.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},r.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.modal")},r.prototype.resize=function(){this.isShown?t(window).on("resize.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.modal")},r.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("mdl_lnls_open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.modal")}),this.options.iframe&&(this.iframeEventListener(!1),this.$element.find("iframe").removeClass("active").css("display",""))},r.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},r.prototype.backdrop=function(e){var a=this,n=this.$element.hasClass("fade")?"fade":"",o=(t.browser.mobile,"");if(this.isShown&&this.options.backdrop){var i=t.support.transition&&n;if("transparent"==this.options.backdrop||this.$element.hasClass("alert")?this.$backdrop=t(document.createElement("div")).addClass("mdl_lnls_backdrop_transparent "+n).appendTo(this.$body):this.$backdrop=t(document.createElement("div")).addClass("mdl_lnls_backdrop "+n+" "+o).appendTo(this.$body),this.$element.on("click.dismiss.modal",t.proxy(function(t){if(this.ignoreBackdropClick)return void(this.ignoreBackdropClick=!1);t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),this.$element.on("close",t.proxy(function(t){if(this.ignoreBackdropClick)return void(this.ignoreBackdropClick=!1);t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;i?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(r.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var s=function(){a.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",s).emulateTransitionEnd(r.BACKDROP_TRANSITION_DURATION):s()}else e&&e()},r.prototype.handleUpdate=function(){this.adjustDialog()},r.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},r.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},r.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},r.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},r.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},r.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="mdl_lnls_scrollbar_measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e},r.prototype.iframeEventListener=function(t){t?window.addEventListener("message",this.iframePostEvents,!1):window.removeEventListener("message",this.iframePostEvents,!1)};var o=t.fn.mdl_lnls;t.fn.mdl_lnls=n,t.fn.mdl_lnls.Constructor=r,t.fn.mdl_lnls.noConflict=function(){return t.fn.mdl_lnls=o,this},t(document).on("click.modal.data-api",'[data-toggle="mdl_lnls"]',function(e){var a=t(this),r=a.attr("href"),o=t(a.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),i=!!a.attr("data-iframe")&&a.attr("data-iframe"),s=o.data("modal")?"toggle":t.extend({remote:!/#/.test(r)&&r},o.data(),a.data(),{iframe:i});a.is("a")&&e.preventDefault(),o.one("show.modal",function(t){t.isDefaultPrevented()||o.one("hidden.modal",function(){a.is(":visible")&&a.trigger("focus")})}),n.call(o,s,this)})}(t)}).call(window)},26:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"use strict";t.fn.sf_lnse=function(a){var n=t(this),r=function(t,e){var a=t,r=a.children(".tabs").children("li"),o=a.children(".ctns").children(".panl"),i=0,s=function(t,e){t.on("click",function(t){d(e)})},d=function(t){t!==i&&t>=0&&t<=r.length&&(r.eq(i).removeClass("active"),r.eq(t).addClass("active"),o.eq(i).removeClass("active"),o.eq(t).addClass("active"),i=t),l.whenTabSwitchDone(n.find(".ctns").children(".active:visible:last"))};!function(){for(var t=0;t<r.length;t++){var e=r.eq(t);s(e,t)}r.eq(i).find("input[type=radio]").length>0&&r.eq(i).find("input[type=radio]").prop("checked",!0),r.eq(i).addClass("active"),o.eq(i).addClass("active")}()},o=function(e){var a=t(e).children("input"),n=t(e).children(".addon");!t(e).hasClass("intg")&&t(e).addClass("intg"),0==n.length&&(a.after(t('<span class="addon"><button class="seic icon-round-times"></button></span>')),n=t(e).children(".addon")),n.hide(),a.on("keyup",function(){t(this).val().length>0?n.show():(n.hide(),l.whenInputRemoved(a))}),a.on("focus",function(){t(this).val().length>0&&n.show()}),a.on("focusout",function(){n.hide()}),n.on("mousedown",function(){a.val(null),n.hide(),l.whenInputRemoved(a)})},i=function(e,a){var r=n,o=r.find(".ctns").children(".active:visible:last");e.each(function(e,n){var r=t(this).attr("data-hiddenInput"),i=t(function(t){var e="";if(-1!=t.indexOf(","))for(var a=t.split(","),n=0;n<a.length;n++)e+='<input type="hidden" name="'+a[n]+'">';else e='<input type="hidden" name="'+r+'">';return e}(r));t(this).after(i),t(this).on(a,function(e,n){"change"!=a&&n?l.whenFormChanged(o,t(n),i):l.whenFormChanged(o,t(this),i)})})},s=function(e){var a=null,n=[],r="",o="",i=e.closest(".panl[data-panl]");if(e.is("[data-hiddenInput]")&&e.attr("data-hiddenInput"))if(r=e.attr("data-hiddenInput"),-1!=r.indexOf(",")){n=r.split(",");for(var s=0;s<n.length;s++)o+='input[type="hidden"][name="'+n[s]+'"]',s+1!==n.length&&(o+=",");a=t(o,i)}else a=t('input[type="hidden"][name="'+r+'"]');return a},l=t.extend({$tabsWrap:this,renderHiddenToggle:!1,needHiddenInputsChangeEvents:"change",fromChangeEventName:"change",fieldRecodeWriteEvent:"recodeLoaded",reocodeDataOnDomKey:"recode",whenInit:function(t){},whenRecodeWrited:function(t,e,a){},whenTabSwitchDone:function(t){},whenInputRemoved:function(t){},whenFormChanged:function(t,e,a){},whenSubmit:function(t,e){}},a),d=function(){var a=function(t){return"string"!=typeof t?null:2==t.match(/(^\{|\}$)/).length?JSON.parse(t):void 0}(localStorage.getItem("sf-lnse")),n=function(t){var e=t.prop("nodeName"),a=t.attr("data-savecustom");return"INPUT"===e?void 0!==a?"custom":t.attr("type"):"SELECT"===e?"select":void 0},r=function(t,e){switch(e){case"radio":case"checkbox":return t.prop("checked")?t.val():null;case"custom":for(var a,n={},r=t.attr("data-savecustom").split(","),o=0;o<r.length;o++)a=r[o],n[a]=t.attr("data-"+a);return n;default:if(t.val().length>0)return t.val()}},o=function(t){var e=new Date,a=new Date(t);return e.getTime()>=a.getTime()};return{init:function(r){return!!a&&(!!a.panelLastSubmit&&r.each(function(r,i){var s=t(i),d=s.attr("data-panl"),c=a.panelLastSubmit[d]?a.panelLastSubmit[d]:null;if(c){s.find("[data-save]").each(function(a,r){var i=t(r),s=i.attr("data-save"),d=n(i),u=c[s]?c[s]:null;if(null!=u&&!o(u.date.expired))switch(d){case"checkbox":"on"==u.value&&i.data(l.reocodeDataOnDomKey,u.value).prop("checked",!0).trigger(l.fieldRecodeWriteEvent,[i]);break;case"radio":i.data(l.reocodeDataOnDomKey,u.value).filter("[value="+u.value+"]").prop("checked",!0).trigger(l.fieldRecodeWriteEvent,[i]);break;case"select":i.data(l.reocodeDataOnDomKey,u.value).find('option[value="'+u.value+'"]').prop("selected",!0).attr("selected","selected").trigger(l.fieldRecodeWriteEvent,[i]);break;case"custom":if("object"===e(u.value)){for(var p in u.value)i.attr("data-"+p,u.value[p]);i.data(l.reocodeDataOnDomKey,u.value).prop("value",function(t){return"string"==typeof t.merged&&t.merged.length>0?t.merged:"string"==typeof t.txt?t.txt:"string"==typeof t.intvalue?t.intvalue:void 0}(u.value)).trigger(l.fieldRecodeWriteEvent,[i])}break;default:i.data(l.reocodeDataOnDomKey,u.value).val(u.value).trigger(l.fieldRecodeWriteEvent,[i])}})}}),!0)},save:function(e){var o=a||{},i="panelLastSubmit",s=o[i]?o[i]:{},l=e.attr("data-panl"),d={};e.find("[data-save]").each(function(e,a){var o=t(a),i=o.attr("data-save"),s=n(o),l=r(o,s),c=new Date,u=new Date;u.setDate(u.getDate()+30);var p={value:l,fieldType:s,date:{create:c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds(),expired:u.getFullYear()+"-"+(u.getMonth()+1)+"-"+u.getDate()+" "+u.getHours()+":"+u.getMinutes()+":"+u.getSeconds()}};null!=l&&(d[i]=p)}),s[l]=d,o[i]=s,localStorage.setItem("sf-lnse",JSON.stringify(o))}}}(),c=function(e,a){var n=e.find("[data-required=true]:visible"),r=[],o=[];return n.each(function(e,a){var n=t(a),i=function(t){var e=t;return void 0===e&&(e="請輸入必填欄位喔！"),e}(n.attr("data-reqString"));null==n.val()||0==n.val().length?(o.push(i),r.push(!1)):r.push(!0)}),o.length>0&&alert(o.filter(function(t,e,a){return e==a.indexOf(t)}).join("、")),-1==r.indexOf(!1)};return this.each(function(e,a){var n=t(this).find("[data-toggle=focusRemove]"),u=t(this).find("[data-hiddenInput]"),p=t(this).find("select,input[type!=hidden]:not([data-hiddenInput])"),h=t(this).find("select,input[type!=hidden]"),f=t(this).find(".submit_wrap").children("button"),m=t(this),g=m.find("[data-panl]");l.whenInit(m),m.data("sf-lnse",{$submit:f,$panels:g}),t.each(l.$tabsWrap,function(e,a){a.each(function(e,a){r(t(a))})}),n.each(function(t,e){o(e)}),l.renderHiddenToggle&&i(u,l.needHiddenInputsChangeEvents),p.on(l.fromChangeEventName,function(e){l.whenFormChanged(m.find(".ctns").children(".active:visible:last"),t(this),null)}),h.on(l.fieldRecodeWriteEvent,function(t,e){var a=e.closest(".panl[data-panl]");l.whenRecodeWrited(a,e,s(e))}),d.init(g),f.on("click",function(e){var a=m.find(".ctns").children(".active:visible:last");c(a)&&(d.save(a),l.whenSubmit(a,t(this)))})})}}(t)}).call(window)},27:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"use strict";var a=function(e,a){this.ele=e,this.$ele=t(e),this.stele={},this.option=a,this.className=null,this.isClicked=!1};a.DEFAULT={highestZindex:null,addClass:{WrapClass:null,SelectClass:null,OptionsClass:null},group:"on",openDirection:"down",optionObj:null,defaultSelector:"on",haveDefaultDisabledVal:!0,defaultSelectedVal:"",menuMaxHeight:"",whenOpen:function(t){},whenSelected:function(t){},whenClose:function(t){}},a.prototype.menuDirection=function(e,a,n){var r=(t(e),this.option),o=t(window).height(),i=t(e).outerWidth(),s=e.getBoundingClientRect(),l=t(e).outerHeight(),d="up"==r.openDirection?"inherit":l,c="up"==r.openDirection?l:"inherit",u="up"==r.openDirection?.8:.75,p=r.menuMaxHeight?r.menuMaxHeight:("up"==r.openDirection?s.top:o)*u,h={minWidth:i,top:d,bottom:c,"max-height":p,"z-index":n+1};"up"==r.openDirection?(s.top,a.outerHeight(),a.addClass("active expandtop").css(h)):"down"==r.openDirection&&(s.top,a.outerHeight(),a.addClass("active").css(h))},a.prototype.init=function(){this.render();var n=this,r=this.$ele,o=this.option,i=this.isClicked,s=r.children("option").length,l=o.highestZindex,d=r.index(),c=r.parent().find(".st-wrap").eq(d),u=c.find(".st-select"),p=u.find(".st-selected"),h=c.find(".st-options"),f=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);o.highestZindex||(l=this.getZindex(),a.DEFAULT.highestZindex=l),f&&"on"==o.defaultSelector?r.addClass("m_hide"):r.addClass("hide"),r.attr("data-label")&&u.prepend('<span class="st-label">'+r.attr("data-label")+"</span>"),r.parents().hasClass("st-grp")&&(c=r.closest(".st-wrap"),u=c.find(".st-select"),p=u.find(".st-selected"),h=c.find(".st-options"),r.data("col")?c.addClass(r.data("col")):c.css({width:100/c.closest(".st-grp").children().length+"%"})),"object"===e(o.addClass)&&(c.addClass(o.addClass.WrapClass),u.addClass(o.addClass.SelectClass),h.addClass(o.addClass.OptionsClass)),r.attr("disabled")&&u.attr("disabled","");for(var m=0;m<s;m++){var g=t("<li />",{text:r.children("option").eq(m).text(),rel:r.children("option").eq(m).val(),css:{color:r.children("option").eq(m).attr("data-color")},class:"st-option"});h.append(g),r.children("option").eq(m).attr("disabled")&&g.attr("disabled",""),r.children("option").eq(m).attr("selected")&&(p.text(r.children("option").eq(m).text()),g.addClass("selected"),r.hasClass("err")||r.hasClass("scs")||r.attr("disabled")||p.css("color",g.css("color")))}0==r.children("option[selected]").length&&(p.text(r.children("option").eq(0).text()).css("color",g.css("color")),h.children("li:first-child").addClass("selected")),r.hasClass("m_hide")&&r.css({top:c.position().top,width:"100%"}),u.focusin(function(){if(!i&&!t(this).attr("disabled")){t(window).height(),t(this).outerWidth(),this.getBoundingClientRect(),t(this).outerHeight();u.addClass("active"),c.addClass("active")}}).blur(function(){0===h.filter(":hover").length&&(u.removeClass("active"),c.removeClass("active"),h.removeClass("active expandtop"),h.removeAttr("style"),"function"==typeof o.whenClose&&o.whenClose(r),i=!1)}).click(function(){i=!i,i?(h.removeClass("active expandtop"),h.removeAttr("style"),t(this).attr("disabled")||("function"==typeof o.whenOpen&&o.whenOpen(r),n.menuDirection(this,h,l))):(h.removeClass("active"),h.removeAttr("style"))}),r.focusin(function(){u.addClass("active"),c.addClass("active")}).blur(function(){u.removeClass("active"),c.removeClass("active")}),h.on("mousedown","li",function(e){e.preventDefault();var a=r.val();t(this).attr("disabled")||(h.removeClass("active"),r.val(t(this).attr("rel")),a!=r.val()&&r.trigger("change"),t(this).siblings("li.selected").removeClass("selected"),t(this).addClass("selected"),i=!1)}).hover(function(t){u.focus()}),r.change(function(t){var e=r.val(),a=h.find('[rel="'+e+'"]').text(),n=h.find('[rel="'+e+'"]').css("color");o.whenSelected&&"function"==typeof o.whenSelected&&o.whenSelected(r),p.text(a),r.hasClass("err")||r.hasClass("scs")||p.css("color",n)}),r.on("setWhenSelected",function(t,e){e&&"function"==typeof e&&(o.whenSelected=e)}),r.on("setWhenOpen",function(t,e){e&&"function"==typeof e&&(o.whenOpen=e)}),r.on("setWhenClose",function(t,e){e&&"function"==typeof e&&(o.whenClose=e)}),r.on("reloadOpts",function(a,r,o,i){r&&(t.isArray(r)||"object"==(void 0===r?"undefined":e(r)))&&n.reloadOptions(r,o,i)}),r.on("setErr",function(){r.addClass("err"),c.addClass("err"),p.css("color","")}),r.on("setScs",function(){r.addClass("scs"),c.addClass("scs"),p.css("color","")}),r.on("removeErr",function(){r.removeClass("err"),c.removeClass("err"),r.hasClass("err")||r.hasClass("scs")||p.css("color",h.find(".st-option.selected").css("color"))}),r.on("removeScs",function(){r.removeClass("scs"),c.removeClass("scs"),r.hasClass("err")||r.hasClass("scs")||p.css("color",h.find(".st-option.selected").css("color"))}),r.on("setDisabled",function(){r.attr("disabled",""),u.attr("disabled","")}),r.on("removeDisabled",function(){r.attr("disabled",!1),u.attr("disabled",!1)})},a.prototype.render=function(){var e=this.$ele,a=this.option;this.getClassName();var n=this.className;if(0==e.children("option").length){if(!a.optionObj)throw new Error("找不到options資料");for(var r=Object.keys(a.optionObj),o=t.map(a.optionObj,function(t,e){return t}),i=0;i<r.length;i++)e.append('<option value="'+r[i]+'">'+o[i]+"</option>");a.haveDefaultDisabledVal?a.defaultSelectedVal?(e.find("[value="+a.defaultSelectedVal+"]").attr("selected","selected"),e.find("[value="+a.defaultSelectedVal+"]").attr("disabled","disabled")):e.prepend("<option value selected disabled>請選擇</option>"):a.defaultSelectedVal&&e.find("[value="+a.defaultSelectedVal+"]").attr("selected","selected")}if(/(st-grp)\w*/g.test(n)&&"on"==a.group){this.group();var s=t('<div class="st-wrap"></div>'),l=t('<div class="st-select" tabindex="-1"></div>'),d=t('<span class="st-selected"></span>'),c=t('<ul class="st-options"></ul>');e.wrap(s),e.after(l),l.append(d),l.after(c),this.stele.$stWrap=e.parent(".st-wrap"),this.stele.$stSelect=l,this.stele.$stSelected=d,this.stele.$stOptions=c}else{e.wrap('<div class="st_lnls"></div>');var s=t('<div class="st-wrap"></div>'),l=t('<div class="st-select" tabindex="-1"></div>'),d=t('<span class="st-selected"></span>'),c=t('<ul class="st-options"></ul>');e.after(s),s.append(l),l.append(d),l.after(c),this.stele.$stWrap=s,this.stele.$stSelect=l,this.stele.$stSelected=d,this.stele.$stOptions=c}this.stele.$stWrap.addClass(n),this.stele.$stWrap.removeClass("st_lnls")},a.prototype.reloadOptions=function(a,n,r){var o=this.$ele,i=this.option,s=(this.stele.$stWrap,this.stele.$stSelect,this.stele.$stSelected),l=this.stele.$stOptions;if(o.empty(),l.empty(),t.isArray(a))for(var d=0;d<a.length;d++){o.append(t("<option />",{text:a[d].txt,value:a[d].val}));var c=t("<li />",{text:a[d].txt,rel:a[d].val,css:{color:o.children("option").eq(d).attr("data-color")},class:"st-option"});l.append(c),a[d].isDisabled&&c.attr("disabled",""),a[d].isSelected&&(c.attr("selected",""),o.val(a[d].val),s.text(a[d].txt))}else if("object"==(void 0===a?"undefined":e(a)))for(var d in a){o.append(t("<option />",{text:a[d],value:d}));var c=t("<li />",{text:a[d],rel:d,css:{color:o.children("option").eq(d).attr("data-color")},class:"st-option"});l.append(c);var u=n?n.selectedOptKey:void 0,p=n?n.disabledOptKeys:void 0;p&&("string"==typeof p||t.isArray(p))&&("string"==typeof p&&d===p?c.attr("disabled",""):t.isArray(p)&&t.inArray(d,p)),u&&"string"==typeof u&&c.attr("rel")==u&&(c.attr("selected",""),o.val(d),s.text(a[d]))}o.hasClass("err")||o.hasClass("scs")||o.attr("disabled")||s.css("color",c.css("color")),r&&i.whenSelected&&"function"==typeof i.whenSelected&&i.whenSelected(o)},a.prototype.getClassName=function(){return this.className=this.$ele.attr("class")},a.prototype.getZindex=function(){var e=0;return t("*").each(function(){var a=parseInt(t(this).css("z-index"),10);a&&e<a&&(e=a)}),e},a.prototype.group=function(){var t,e=this.$ele,a=(this.className,this.className.split(" "));a.forEach(function(e,n){/(st-grp\w*)/g.test(e)&&(t=a[n])}),!e.parent(".st-grp").length>0&&e.nextAll("."+t).andSelf().wrapAll('<div class="st-grp st_lnls"></div>')},t.fn.st_lnls=function(n){return this.each(function(){var r=t(this),o={};r.data("opendirection")&&(o.openDirection=r.data("opendirection")),r.data("defaultselector")&&(o.defaultSelector=r.data("defaultselector")),r.data("addclass")&&"object"===e(r.data("addclass"))&&(o.addClass=r.data("addclass")),r.data("optionobj")&&"object"===e(r.data("optionobj"))&&(o.optionObj=r.data("optionobj"));var i=t.extend({},a.DEFAULT,"object"===(void 0===n?"undefined":e(n))&&n,o);new a(this,i).init()})}}(t)}).call(window)},5:function(t,e){(function(){var t=(this.jQuery,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t});!function(e,a,n){"use strict";!function(n){!function(n){function r(t,e){this.$element=n(t),e&&("string"!==n.type(e.delay)&&"number"!==n.type(e.delay)||(e.delay={show:e.delay,hide:e.delay})),this.options=n.extend({},i,e),this._defaults=i,this._name=o,this._targetclick=!1,this.init(),s.push(this.$element)}var o="pp_ln",i={placement:"auto",container:null,width:"auto",height:"auto",trigger:"click",style:"",delay:{show:null,hide:300},async:{type:"GET",before:null,success:null,error:null},cache:!0,multi:!1,arrow:!0,title:"",content:"",closeable:!1,padding:!0,url:"",type:"html",direction:"",animation:null,template:'<div class="pp_ln"><div class="arrow"></div><div class="pp_ln_inner"><a href="#" class="close"></a><h3 class="pp_ln_title"></h3><div class="pp_ln_content"><i class="icon-refresh"></i> <p>&nbsp;</p></div></div></div>',backdrop:!1,dismissible:!0,onShow:null,onHide:null,abortXHR:!0,autoHide:!1,offsetTop:0,offsetLeft:0,iframeOptions:{frameborder:"0",allowtransparency:"true",id:"",name:"",scrolling:"",onload:"",height:"",width:""},hideEmpty:!1},s=[],l=n('<div class="pp_ln_backdrop"></div>'),d=0,c=!1,u=n(a),p=function(t,e){return isNaN(t)?e||0:Number(t)},h=function(t){return t.data("plugin_"+o)},f=function(){for(var t=null,e=0;e<s.length;e++)(t=h(s[e]))&&t.hide(!0);u.trigger("hiddenAll.pp.ln")},m="ontouchstart"in a.documentElement&&/Mobi/.test(navigator.userAgent),g=function(t){var e={x:0,y:0};if("touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type||"touchcancel"===t.type){var a=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];e.x=a.pageX,e.y=a.pageY}else"mousedown"!==t.type&&"mouseup"!==t.type&&"click"!==t.type||(e.x=t.pageX,e.y=t.pageY);return e};r.prototype={init:function(){"manual"!==this.getTrigger()&&("click"===this.getTrigger()||m?this.$element.off("click touchend").on("click touchend",n.proxy(this.toggle,this)):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave click").on("mouseenter",n.proxy(this.mouseenterHandler,this)).on("mouseleave",n.proxy(this.mouseleaveHandler,this))),this._poped=!1,this._inited=!0,this._opened=!1,this._idSeed=d,this.options.container=n(this.options.container||a.body).first(),this.options.backdrop&&l.appendTo(this.options.container).hide(),d++,"sticky"===this.getTrigger()&&this.show()},destroy:function(){for(var t=-1,e=0;e<s.length;e++)if(s[e]===this.$element){t=e;break}s.splice(t,1),this.hide(),this.$element.data("plugin_"+o,null),"click"===this.getTrigger()?this.$element.off("click"):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave"),this.$target&&this.$target.remove()},hide:function(t,e){if((t||"sticky"!==this.getTrigger())&&this._opened){e&&(e.preventDefault(),e.stopPropagation()),this.xhr&&!0===this.options.abortXHR&&(this.xhr.abort(),this.xhr=null);var a=n.Event("hide.pp.ln");if(this.$element.trigger(a,[this.$target]),this.$target){this.$target.removeClass("in").addClass(this.getHideAnimation());var r=this;setTimeout(function(){r.$target.hide(),r.getCache()||r.$target.remove()},r.getHideDelay())}this.options.backdrop&&l.hide(),this._opened=!1,this.$element.trigger("hidden.pp.ln",[this.$target]),this.options.onHide&&this.options.onHide(this.$target)}},resetAutoHide:function(){var t=this,e=t.getAutoHide();e&&(t.autoHideHandler&&clearTimeout(t.autoHideHandler),t.autoHideHandler=setTimeout(function(){t.hide()},e))},toggle:function(t){t&&(t.preventDefault(),t.stopPropagation()),this[this.getTarget().hasClass("in")?"hide":"show"]()},hideAll:function(){f()},show:function(){if(!this._opened){var t=this.getTarget().removeClass().addClass("pp_ln").addClass(this._customTargetClass);if(this.options.multi||this.hideAll(),!this.getCache()||!this._poped||""===this.content){if(this.content="",this.setTitle(this.getTitle()),this.options.closeable||t.find(".close").off("click").remove(),this.isAsync()?this.setContentASync(this.options.content):this.setContent(this.getContent()),this.canEmptyHide()&&""===this.content)return;t.show()}this.displayContent(),this.options.onShow&&this.options.onShow(t),this.bindBodyEvents(),this.options.backdrop&&l.show(),this._opened=!0,this.resetAutoHide()}},displayContent:function(){var t=this.getElementPosition(),e=this.getTarget().removeClass().addClass("pp_ln").addClass(this._customTargetClass),a=this.getContentElement(),r=e[0].offsetWidth,o=e[0].offsetHeight,i="bottom",s=n.Event("show.pp.ln");if(this.canEmptyHide()){var l=a.children().html();if(null!==l&&0===l.trim().length)return}this.$element.trigger(s,[e]);var d=this.$element.data("width")||this.options.width;""===d&&(d=this._defaults.width),"auto"!==d&&e.outerWidth(d);var c=this.$element.data("height")||this.options.height;if(""===c&&(c=this._defaults.height),"auto"!==c&&a.outerHeight(c),this.options.style)if("string"==typeof this.options.style)this.$target.addClass("pp_ln_"+this.options.style);else if(Array.isArray(this.options.style))for(var u in this.options.style)this.$target.addClass("pp_ln_"+this.options.style[u]);"rtl"!==this.options.direction||a.hasClass("pp_ln_rtl")||a.addClass("pp_ln_rtl"),this.options.arrow||e.find(".arrow").remove(),e.detach().css({top:-2e3,left:-2e3,display:"block"}),this.getAnimation()&&e.addClass(this.getAnimation()),e.appendTo(this.options.container),i=this.getPlacement(t),this.$element.trigger("added.pp.ln"),this.initTargetEvents(),"boolean"!=typeof this.options.padding||this.options.padding?"number"!=typeof this.options.padding&&"string"!=typeof this.options.padding||a.css("padding",this.options.padding):("auto"!==this.options.height&&a.css("height",a.outerHeight()),this.$target.addClass("pp_ln_nopadding")),r=e[0].offsetWidth,o=e[0].offsetHeight;var p=this.getTargetPositin(t,i,r,o);if(this.$target.css(p.position).addClass(i).addClass("in"),"iframe"===this.options.type){var h=e.find("iframe"),f=e.width(),m=h.parent().height();""!==this.options.iframeOptions.width&&"auto"!==this.options.iframeOptions.width&&(f=this.options.iframeOptions.width),""!==this.options.iframeOptions.height&&"auto"!==this.options.iframeOptions.height&&(m=this.options.iframeOptions.height),h.width(f).height(m)}if(this.options.arrow||this.$target.css({margin:0}),this.options.arrow){var g=this.$target.find(".arrow");g.removeAttr("style"),"left"===i||"right"===i?g.css({top:this.$target.height()/2}):"top"!==i&&"bottom"!==i||g.css({left:this.$target.width()/2}),p.arrowOffset&&(-1===p.arrowOffset.left||-1===p.arrowOffset.top?g.hide():g.css(p.arrowOffset))}this._poped=!0,this.$element.trigger("shown.pp.ln",[this.$target])},isTargetLoaded:function(){return 0===this.getTarget().find("i.glyphicon-refresh").length},getTriggerElement:function(){return this.$element},getTarget:function(){if(!this.$target){var t=o+this._idSeed;this.$target=n(this.options.template).attr("id",t).data("trigger-element",this.getTriggerElement()),this._customTargetClass="pp_ln"!==this.$target.attr("class")?this.$target.attr("class"):null,this.getTriggerElement().attr("data-target",t)}return this.$target},getTitleElement:function(){return this.getTarget().find(".pp_ln_title")},getContentElement:function(){return this.$contentElement||(this.$contentElement=this.getTarget().find(".pp_ln_content")),this.$contentElement},getTitle:function(){return this.$element.attr("data-title")||this.options.title||this.$element.attr("title")},getUrl:function(){return this.$element.attr("data-url")||this.options.url},getAutoHide:function(){return this.$element.attr("data-auto-hide")||this.options.autoHide},getOffsetTop:function(){return p(this.$element.attr("data-offset-top"))||this.options.offsetTop},getOffsetLeft:function(){return p(this.$element.attr("data-offset-left"))||this.options.offsetLeft},getCache:function(){var t=this.$element.attr("data-cache");if(void 0!==t)switch(t.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":return!1}return this.options.cache},getTrigger:function(){return this.$element.attr("data-trigger")||this.options.trigger},getDelayShow:function(){var t=this.$element.attr("data-delay-show");return void 0!==t?t:0===this.options.delay.show?0:this.options.delay.show||100},getHideDelay:function(){var t=this.$element.attr("data-delay-hide");return void 0!==t?t:0===this.options.delay.hide?0:this.options.delay.hide||100},getAnimation:function(){return this.$element.attr("data-animation")||this.options.animation},getHideAnimation:function(){var t=this.getAnimation();return t?t+"-out":"out"},setTitle:function(t){var e=this.getTitleElement();t?("rtl"!==this.options.direction||e.hasClass("pp_ln_rtl")||e.addClass("pp_ln_rtl"),e.html(t)):e.remove()},hasContent:function(){return this.getContent()},canEmptyHide:function(){return this.options.hideEmpty&&"html"===this.options.type},getIframe:function(){var t=n("<iframe></iframe>").attr("src",this.getUrl()),e=this;return n.each(this._defaults.iframeOptions,function(a){void 0!==e.options.iframeOptions[a]&&t.attr(a,e.options.iframeOptions[a])}),t},getContent:function(){if(this.getUrl())switch(this.options.type){case"iframe":this.content=this.getIframe();break;case"html":try{this.content=n(this.getUrl()),this.content.is(":visible")||this.content.show()}catch(t){throw new Error("Unable to get popover content. Invalid selector specified.")}}else if(!this.content){var t="";if(t=n.isFunction(this.options.content)?this.options.content.apply(this.$element[0],[this]):this.options.content,this.content=this.$element.attr("data-content")||t,!this.content){var e=this.$element.next();e&&e.hasClass("pp_ln_content")&&(this.content=e)}}return this.content},setContent:function(t){var e=this.getTarget(),a=this.getContentElement();"string"==typeof t?a.html(t):t instanceof n&&(a.html(""),this.options.cache?t.removeClass("pp_ln_content").appendTo(a):t.clone(!0,!0).removeClass("pp_ln_content").appendTo(a)),this.$target=e},isAsync:function(){return"async"===this.options.type},setContentASync:function(t){var e=this;this.xhr||(this.xhr=n.ajax({url:this.getUrl(),type:this.options.async.type,cache:this.getCache(),beforeSend:function(t){e.options.async.before&&e.options.async.before(e,t)},success:function(a){e.bindBodyEvents(),t&&n.isFunction(t)?e.content=t.apply(e.$element[0],[a]):e.content=a,e.setContent(e.content),e.getContentElement().removeAttr("style"),e.displayContent(),e.options.async.success&&e.options.async.success(e,a)},complete:function(){e.xhr=null},error:function(t,a){e.options.async.error&&e.options.async.error(e,t,a)}}))},bindBodyEvents:function(){c||(this.options.dismissible&&"click"===this.getTrigger()?(u.off("keyup.pp.ln").on("keyup.pp.ln",n.proxy(this.escapeHandler,this)),u.off("click.pp.ln touchend.pp.ln").on("click.pp.ln touchend.pp.ln",n.proxy(this.bodyClickHandler,this))):"hover"===this.getTrigger()&&u.off("touchend.pp.ln").on("touchend.pp.ln",n.proxy(this.bodyClickHandler,this)))},mouseenterHandler:function(){var t=this;t._timeout&&clearTimeout(t._timeout),t._enterTimeout=setTimeout(function(){t.getTarget().is(":visible")||t.show()},this.getDelayShow())},mouseleaveHandler:function(){var t=this;clearTimeout(t._enterTimeout),t._timeout=setTimeout(function(){t.hide()},this.getHideDelay())},escapeHandler:function(t){27===t.keyCode&&this.hideAll()},bodyClickHandler:function(t){c=!0;for(var e=!0,a=0;a<s.length;a++){var n=h(s[a]);if(n&&n._opened){var r=n.getTarget().offset(),o=r.left,i=r.top,l=r.left+n.getTarget().width(),d=r.top+n.getTarget().height(),u=g(t);if(u.x>=o&&u.x<=l&&u.y>=i&&u.y<=d){e=!1;break}}}e&&f()},initTargetEvents:function(){"hover"===this.getTrigger()&&this.$target.off("mouseenter mouseleave").on("mouseenter",n.proxy(this.mouseenterHandler,this)).on("mouseleave",n.proxy(this.mouseleaveHandler,this)),this.$target.find(".close").off("click").on("click",n.proxy(this.hide,this,!0))},getPlacement:function(t){var e,a=this.options.container,n=a.innerWidth(),r=a.innerHeight(),o=a.scrollTop(),i=a.scrollLeft(),s=Math.max(0,t.left-i),l=Math.max(0,t.top-o);e="function"==typeof this.options.placement?this.options.placement.call(this,this.getTarget()[0],this.$element[0]):this.$element.data("placement")||this.options.placement;var d="horizontal"===e,c="vertical"===e;return"auto"===e||d||c?e=s<n/3?l<r/3?d?"right-bottom":"bottom-right":l<2*r/3?c?l<=r/2?"bottom-right":"top-right":"right":d?"right-top":"top-right":s<2*n/3?l<r/3?d?s<=n/2?"right-bottom":"left-bottom":"bottom":l<2*r/3?d?s<=n/2?"right":"left":l<=r/2?"bottom":"top":d?s<=n/2?"right-top":"left-top":"top":l<r/3?d?"left-bottom":"bottom-left":l<2*r/3?c?l<=r/2?"bottom-left":"top-left":"left":d?"left-top":"top-left":"auto-top"===e?e=s<n/3?"top-right":s<2*n/3?"top":"top-left":"auto-bottom"===e?e=s<n/3?"bottom-right":s<2*n/3?"bottom":"bottom-left":"auto-left"===e?e=l<r/3?"left-top":l<2*r/3?"left":"left-bottom":"auto-right"===e&&(e=l<r/3?"right-top":l<2*r/3?"right":"right-bottom"),e},getElementPosition:function(){var t=this.$element[0].getBoundingClientRect(),e=this.options.container,r=e.css("position");if(e.is(a.body)||"static"===r)return n.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth||t.width,height:this.$element[0].offsetHeight||t.height});if("fixed"===r){var o=e[0].getBoundingClientRect();return{top:t.top-o.top+e.scrollTop(),left:t.left-o.left+e.scrollLeft(),width:t.width,height:t.height}}return"relative"===r?{top:this.$element.offset().top-e.offset().top,left:this.$element.offset().left-e.offset().left,width:this.$element[0].offsetWidth||t.width,height:this.$element[0].offsetHeight||t.height}:void 0},getTargetPositin:function(t,e,n,r){var o=t,i=this.options.container,s=this.$element.outerWidth(),l=this.$element.outerHeight(),d=a.documentElement.scrollTop+i.scrollTop(),c=a.documentElement.scrollLeft+i.scrollLeft(),u={},p=null,h=this.options.arrow?20:0,f=s<h+10?h:0,m=l<h+10?h:0,g=0,v=a.documentElement.clientHeight+d,y=a.documentElement.clientWidth+c,b=o.left+o.width/2-f>0,w=o.left+o.width/2+f<y,C=o.top+o.height/2-m>0,D=o.top+o.height/2+m<v;switch(e){case"bottom":u={top:o.top+o.height,left:o.left+o.width/2-n/2};break;case"top":u={top:o.top-r,left:o.left+o.width/2-n/2};break;case"left":u={top:o.top+o.height/2-r/2,left:o.left-n};break;case"right":u={top:o.top+o.height/2-r/2,left:o.left+o.width};break;case"top-right":u={top:o.top-r,left:b?o.left-f:10},p={left:b?Math.min(s,n)/2+f:-2e3};break;case"top-left":g=w?f:-10,u={top:o.top-r,left:o.left-n+o.width+g},p={left:w?n-Math.min(s,n)/2-f:-2e3};break;case"bottom-right":u={top:o.top+o.height,left:b?o.left-f:10},p={left:b?Math.min(s,n)/2+f:-2e3};break;case"bottom-left":g=w?f:-10,u={top:o.top+o.height,left:o.left-n+o.width+g},p={left:w?n-Math.min(s,n)/2-f:-2e3};break;case"right-top":g=D?m:-10,u={top:o.top-r+o.height+g,left:o.left+o.width},p={top:D?r-Math.min(l,r)/2-m:-2e3};break;case"right-bottom":u={top:C?o.top-m:10,left:o.left+o.width},p={top:C?Math.min(l,r)/2+m:-2e3};break;case"left-top":g=D?m:-10,u={top:o.top-r+o.height+g,left:o.left-n},p={top:D?r-Math.min(l,r)/2-m:-2e3};break;case"left-bottom":u={top:C?o.top-m:10,left:o.left-n},p={top:C?Math.min(l,r)/2+m:-2e3}}return u.top+=this.getOffsetTop(),u.left+=this.getOffsetLeft(),{position:u,arrowOffset:p}}},n.fn[o]=function(e,a){var i=[],s=this.each(function(){var s=n.data(this,"plugin_"+o);s?"destroy"===e?s.destroy():"string"==typeof e&&i.push(s[e]()):(e?"string"==typeof e?"destroy"!==e&&(a||(s=new r(this,null),i.push(s[e]()))):"object"===(void 0===e?"undefined":t(e))&&(s=new r(this,e)):s=new r(this,null),n.data(this,"plugin_"+o,s))});return i.length?i:s};var v=function(){var t=function(){f()},e=function(t,e){e=e||{},n(t).pp_ln(e)},a=function(t){var e=!0;return n(t).each(function(t){e=e&&void 0!==n(t).data("plugin_"+o)}),e};return{show:function(t,e){e?n(t).pp_ln(e).pp_ln("show"):n(t).pp_ln("show")},hide:function(t){n(t).pp_ln("hide")},create:e,isCreated:a,hideAll:t}}();e.pp_ln=v}(e.jQuery)}()}(window,document)}).call(window)},69:function(t,e){(function(){var t=(this.jQuery,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t});$(function(){function e(t){var e=document.createElement("a");if(e.href=t,null==document.body){var a=document.createElement("body");a.appendChild(e),document.appendChild(a)}else document.body.appendChild(e);e.click()}function a(t){var e=/<[^>]*>/g;return unescape(decodeURIComponent(unescape(t))).replace(e,"")}function n(t){var e=[];for(var a in t)if(t.hasOwnProperty(a))if(Array.isArray(t[a]))for(var n in t[a])e.push(a+"="+t[a][n]);else e.push(a+"="+t[a]);return e.join("&")}$.getJSON(function(t,e,a){return"localhost"===t||"ltc-04407-0125.lionmail.com"===t||"nb2323.lionmail.com"===t?a.dev:"uwww.liontravel.com"===t&&1===e.indexOf("info")?a.uwwwinfo:"uwww.liontravel.com"===t&&-1===e.indexOf("info")?a.uwww:"www.liontravel.com"===t&&1===e.indexOf("info")?a.wwwinfo:"www3.liontravel.com"===t&&-1===e.indexOf("info")?a.www3:a.www}(location.hostname,window.location.pathname.split("/"),{dev:"/develop/_shared/bundle/js/searchEngine/searchSettingDevNewBundle.js",uwwwinfo:"/_shared/bundle/js/searchEngine/searchSettingHttp.js",uwww:"/_shared/bundle/js/searchEngine/searchSettingHttp.js",wwwinfo:"/_shared/bundle/js/searchEngine/searchSettingPubInfo.js",www3:"/_shared/bundle/js/searchEngine/searchSetting.js",www:"/_shared/bundle/js/searchEngine/searchSetting.js"}),{_t:Math.round((new Date).getTime()/100)}).done(function(r){var o=r;$(".sf-lnse").sf_lnse({$tabsWrap:[$(".sf-lnse").children(".wrap"),$(".sf-lnse").find(".pills"),$(".sf-lnse").find(".labels")],renderHiddenToggle:!0,needHiddenInputsChangeEvents:"dtm_lnlsChanged",fromChangeEventName:"change",whenInit:function(e){e.find("[data-panl]").each(function(){var e=$(this).attr("data-panl");switch(e){case"abroadGroup":(function(){var t=$(this).find("#abroadGroupDestination"),e=o.abroadGroup.fields.destination,a="{'source':'"+e+"','lineOrder': ['_6','_5','_7','_3','_1','_4','_2'],'region':true,'more':false,'autocomplete':true,'dataTemplate':'abroadGroup','searchAllMergeString':true,'removeNotWordStringWhenSearch':false,'arrangeDataSortByOrderLine':true,'spliteSymbol':'-','removeRegex':false,'appendTargetPosition':'body'}",n=$(this).find('[data-toggle="cy-ln"]'),r=$(this).find("#abroadGroupKeyWord"),i=o.abroadGroup.fields.keyword,s="{'source':'"+i+"','sendData': {'sLine':'','sKeyWord':''},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'appendTargetPosition':'body'}";t.attr("data-dtm-lnsl",a),r.attr("data-dtm-lnsl",s),n.eq(0).val().length<1&&n.eq(0).val(moment().add(15,"days").format("YYYY/MM/DD")),n.eq(1).val(moment().add(30,"days").format("YYYY/MM/DD")),t.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var n,o={line:void 0!==e.attr("data-line")?e.attr("data-line"):"",linetravel:void 0!==e.attr("data-linetravel")?e.attr("data-linetravel"):"",linewebarea:void 0!==e.attr("data-linewebarea")?e.attr("data-linewebarea"):"",parentxt:void 0!==e.attr("data-parentxt")?e.attr("data-parentxt"):"",txt:void 0!==e.attr("data-txt")?e.attr("data-txt"):""};n=o?"_"!=o.linetravel?o.linetravel.split("_").splice(1).reverse():o.line.split("_").reverse():"";var l=r.val();s="{'source':'"+i+"','sendData': {'sLine':'"+n+"','sKeyWord':'"+l+"'},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'appendTargetPosition':'body'}",r.attr("data-dtm-lnsl",s),r.dtm_lnls("updateOptions",s)}),n.on("recodeLoaded",function(){var t={date:$(this).val(),status:null};$(this).trigger("checkDateStatus",[t]),"beforeMin"==t.status&&(n.eq(0).val(moment().add(15,"days").format("YYYY/MM/DD")),n.eq(1).val(moment().add(30,"days").format("YYYY/MM/DD")))})}).call(this);break;case"domesticGroup":(function(){var t=$(this).find("#domesticGroupDestination"),e=o.domesticGroup.fields.destination,a="{'source':'"+e+"','region':false,'autocomplete':true,'inline':true,'dataTemplate':'domesticGroup','depthLimitStart':2,'searchAllMergeString':true,'removeNotWordStringWhenSearch':false,'spliteSymbol':'-','appendTargetPosition':'body'}",n=$(this).find('[data-toggle="cy-ln"]'),r=$(this).find("#domesticGroupKeyWord"),i=o.domesticGroup.fields.keyword,s="{'source':'"+i+"','sendData': {'sLine':'','sKeyWord':''},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇台灣目的地','rmValueWhenNoFound':false,'appendTargetPosition':'body'}";t.attr("data-dtm-lnsl",a),r.attr("data-dtm-lnsl",s),n.eq(0).val().length<1&&n.eq(0).val(moment().add(15,"days").format("YYYY/MM/DD")),n.eq(1).val(moment().add(30,"days").format("YYYY/MM/DD")),t.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var n,o={line:void 0!==e.attr("data-line")?e.attr("data-line"):"",linetravel:void 0!==e.attr("data-linetravel")?e.attr("data-linetravel"):"",linewebarea:void 0!==e.attr("data-linewebarea")?e.attr("data-linewebarea"):"",parentxt:void 0!==e.attr("data-parentxt")?e.attr("data-parentxt"):"",txt:void 0!==e.attr("data-txt")?e.attr("data-txt"):""};n=o?o.linetravel.split("_").splice(1).reverse():"";var l=r.val();s="{'source':'"+i+"','sendData': {'sLine':'"+n+"','sKeyWord':'"+l+"'},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇台灣目的地','rmValueWhenNoFound':false,'appendTargetPosition':'body'}",r.attr("data-dtm-lnsl",s).dtm_lnls("updateOptions",s)}),n.on("recodeLoaded",function(){var t={date:$(this).val(),status:null};$(this).trigger("checkDateStatus",[t]),"beforeMin"==t.status&&(n.eq(0).val(moment().add(15,"days").format("YYYY/MM/DD")),n.eq(1).val(moment().add(30,"days").format("YYYY/MM/DD")))})}).call(this);break;case"abroadHotel":(function(){var t=$(this).find("input[name=sPayKind]"),e=$(this).find("input[name=sPayKind]:checked"),a=e.val(),n=$(this).find("[name=sAllotment]").closest(".group"),r=$(this).find("#abroadHotelDestination"),i=o.abroadHotel.fields.destination,s=o.abroadHotel.fields.destination2,l="{'source':'"+i+"','menuSource':'"+s+"','toggleCustomMenu':true,'region':false,'lineOrder': ['_6','_5','_7','_3','_1','_4','_2'],'autocomplete':true,'dataTemplate':'abroadHotel','depthLimitStart':3,'autoCategory':true,'removeString':'','autoOnly':false,'spliteSymbol':'-','searchAllMergeString':true,'inline':false,'disabled':2,'removeStringOnMenu':'\\u005c(.+\\u005c).+|\\u005c(\\u005c).+','more':true,'matchKeyToSubCategory':[null,null,null,['','_[A-Z]']],'appendTargetPosition':'body'}",d=$(this).find("#abroadHotelKeyWord"),c=o.abroadHotel.fields.hotel,u="{'source':'"+c+"','sendData': {'citycode':'','countrycode':''},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",p=function(t){switch(t){case"P":n.hide(),m.hide(),g.show(),f.trigger("change"),d.data("dtm_lnls")&&d.dtm_lnls("toggleDisabled",!0);break;case"":n.show(),m.show(),g.hide(),h.trigger("change"),d.data("dtm_lnls")&&d.dtm_lnls("toggleDisabled",!1)}},h=$(this).find("[name=sAdate]"),f=$(this).find("[name=sAdateP]"),m=h.closest(".group"),g=f.closest(".group"),v=$(this).find("[name=sDays]"),y=$(this).find("#chkOutDate"),b=$(this).find("[name=sChildQty]"),w=$(this).find("[name=sChild1Age],[name=sChild2Age],[name=sChild3Age]");p(a),r.attr("data-dtm-lnsl",l),d.attr("data-dtm-lnsl",u),r.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var n={line:void 0!==e.attr("data-line")?e.attr("data-line"):"",country:void 0!==e.attr("data-country")?e.attr("data-country"):"",city:void 0!==e.attr("data-city")?e.attr("data-city"):"",cityzone:void 0!==e.attr("data-cityzone")?e.attr("data-cityzone"):"",parentxt:void 0!==e.attr("data-parentxt")?e.attr("data-parentxt"):"",txt:void 0!==e.attr("data-txt")?e.attr("data-txt"):""},r=!!n.city.length>0?n.city.split("_")[1]:"",o=!!n.city.length>0?n.city.split("_")[2]:"";u="{'source':'"+c+"','sendData': {'citycode':'"+r+"','countrycode':'"+o+"'},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','removeNotWordStringWhenSearch':false,'hotelQueryMaxNum':10,'autoSelector':false,'appendTargetPosition':'body'}",d.attr("data-dtm-lnsl",u).dtm_lnls("updateOptions",u)}),t.on("change",function(){p($(this).val())});var C,D;$.ajax({url:o.abroadHotel.getEffectiveCheckInDate,async:!1,dataType:"json",type:"post",success:function(t){C=moment(t.WorkDate).subtract(1,"days"),D=moment(t.WorkDate)},error:function(){C=moment().subtract(moment().get("hour")>=14?-1:0,"days"),D=moment().subtract(moment().get("hour")>=14?-2:-1,"days")}});var T=moment(C.format("YYYYMMDD")).add(1,"d").format("YYYY/MM/DD"),S=moment(D.format("YYYYMMDD")).add(1,"d").format("YYYY/MM/DD");h.data("default",T).val(T).cy_ln({minDate:C,maxDate:moment().add(parseInt(h.attr("data-maxDate")),"days"),weekdayName:["日","一","二","三","四","五","六"],changeMonthYear:!1,toggleAlert:h.attr("data-toggleAlert"),alertString:{invalid:h.attr("data-invalidAlert")}}),f.data("default",S).val(S).cy_ln({minDate:D,maxDate:moment().add(parseInt(f.attr("data-maxDate")),"days"),weekdayName:["日","一","二","三","四","五","六"],changeMonthYear:!1,toggleAlert:f.attr("data-toggleAlert"),alertString:{invalid:f.attr("data-invalidAlert")}}),y.text(moment(h.val().replace(/\W/g,"")).add(parseInt(v.val()),"day").format("YYYY/MM/DD")),f.on("change recodeLoaded",function(){var t=parseInt(v.val()),e=$(this).val().replace(/\W/g,""),a=moment(e).add(t,"day").format("YYYY/MM/DD");y.text("Invalid date"!=a?a:"不拘")}),h.on("change recodeLoaded",function(){var t=parseInt(v.val()),e=$(this).val().replace(/\W/g,""),a=moment(e).add(t,"day").format("YYYY/MM/DD");y.text("Invalid date"!=a?a:"不拘")}),v.on("change recodeLoaded",function(){var t=parseInt(v.val()),e=h.val().replace(/\W/g,""),a=moment(e).add(t,"day").format("YYYY/MM/DD");y.text("Invalid date"!=a?a:"不拘")}),b.on("change recodeLoaded",function(){w.hide(),w.parents(".group").addClass("hide");for(var t=parseInt($(this).val()),e=0;e<t;e++)w.eq(e).show(),w.parents(".group").removeClass("hide")})}).call(this);break;case"domesticHotel":(function(){var t=$(this).find("#domesticHotelDestination"),e=o.domesticHotel.fields.destination,a=o.domesticHotel.fields.destination2,n="{'source':'"+e+"','menuSource':'"+a+"','toggleCustomMenu':true,'region':false,'autocomplete':true,'dataTemplate':'domesticHotel','depthLimitStart':3,'autoCategory':true,'autoOnly':false,'spliteSymbol':'-','searchAllMergeString':true,'removeMergeString':'-中\\u005cW+$','matchKeyToSubCategory':[null,null,null,['','_84','_80']],'customMenuLineOrder':true,'disabled':2,'more':true,'appendTargetPosition':'body'}",r=$(this).find("#domesticHotelKeyWord"),i=o.domesticHotel.fields.hotel,s="{'source':'"+i+"','sendData': {'countrycode':'TW'},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','rmValueWhenNoFound':false,'removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}";t.attr("data-dtm-lnsl",n),r.attr("data-dtm-lnsl",s),t.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var n={line:void 0!==e.attr("data-line")?e.attr("data-line"):"",country:void 0!==e.attr("data-country")?e.attr("data-country"):"",city:void 0!==e.attr("data-city")?e.attr("data-city"):"",cityzone:void 0!==e.attr("data-cityzone")?e.attr("data-cityzone"):"",parentxt:void 0!==e.attr("data-parentxt")?e.attr("data-parentxt"):"",txt:void 0!==e.attr("data-txt")?e.attr("data-txt"):""},o=!!n.city.length>0?n.city.split("_")[1]:"",l=!!n.city.length>0?n.city.split("_")[2]:"TW";s="{'source':'"+i+"','sendData': {"+function(t){return t&&t.length>0?"'citycode':'"+t+"',":""}(o)+"'countrycode':'"+l+"'},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','rmValueWhenNoFound':false,'removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",r.attr("data-dtm-lnsl",s).dtm_lnls("updateOptions",s)});var l=$(this).find("[name=sAdate]"),d=$(this).find("[name=sDays]"),c=$(this).find("#chkOutDate"),u=$(this).find("[name=sChildQty]"),p=$(this).find("[name=sChild1Age],[name=sChild2Age],[name=sChild3Age]");l.val(moment().add(7,"d").format("YYYY/MM/DD"));var h=parseInt(d.val()),f=l.val().replace(/\W/g,"");c.text(moment(f).add(h,"day").format("YYYY/MM/DD")),l.on("change recodeLoaded",function(){var t=$(this).val(),e=$(this).data("default");Date.parse(t)<Date.parse(e)&&$(this).val(e);var a=parseInt(d.val()),n=$(this).val().replace(/\W/g,""),r=moment(n).add(a,"day").format("YYYY/MM/DD");c.text("Invalid date"!=r?r:"不拘")}).data("default",l.cy_ln("getMomentMinDate")),d.on("change recodeLoaded",function(){var t=parseInt(d.val()),e=l.val().replace(/\W/g,""),a=moment(e).add(t,"day").format("YYYY/MM/DD");c.text("Invalid date"!=a?a:"不拘")}),u.on("change",function(){p.hide(),p.parents(".group").addClass("hide");for(var t=parseInt($(this).val()),e=0;e<t;e++)p.eq(e).show(),p.parents(".group").removeClass("hide")})}).call(this);break;case"flightsInternational":(function(){var t=$(this),e=t.find("[name=Rtow]"),a=e.filter(":checked"),n=t.find("input[name=NoTrans]").closest(".group"),r=t.find(".seek-destination-wrap"),i=r.children(".group"),s=i.find("[data-toggle=dtm-lnls]"),l=$(".additem",r),d=t.find(".during-the-tour-wrap"),c=t.find(".confirmed-or-not-wrap"),u=t.find("input[name=IsConfirmDate]"),p=u.filter(":checked"),h=t.find(".confirmed-wrap"),f=h.find("input.calendar.fromDate"),m=h.find("input.calendar.toDate"),g=t.find(".not-confirmed-wrap"),v=(g.find("input.calendar.expectDate"),g.find("input.calendar.stayDays"),p.val()),y=t.find("input[name=IsThreeDays]"),b=t.find("input[name=OnlyAvailableSeat]"),w=(y.closest(".group"),b.closest(".group"),t.find("select[name=Adt]")),C=(w.closest(".group"),t.find("select[name=Chd]")),D=(C.closest(".group"),t.find("select[name=Inf]")),T=(D.closest(".group"),a.val()||e.val()),S=o.flightsInternational.fields.place,_=o.flightsInternational.fields.destination,x="{'source':'"+S+"', 'bfmQuery':true, 'autoCategory':true,'dataTemplate':'flightsInternational','more':true,'removeNotWordStringWhenSearch':false,'toggleCustomMenu':true,'menuSource':'"+_+"','runCustomMenuRenderer':true,'customMenuLineOrder':['_9','_5','_6','_7','_3','_1','_2'],'appendTargetPosition':'body'}",M="{'source':'"+S+"', 'bfmQuery':true, 'autoCategory':true,'dataTemplate':'flightsInternational','more':true,'removeNotWordStringWhenSearch':false,'toggleCustomMenu':true,'menuSource':'"+_+"','runCustomMenuRenderer':true,'customMenuLineOrder':['_5','_6','_7','_3','_1','_2','_4'],'appendTargetPosition':'body'}",k=function(t){var e=r.find(".divider-b"),a=r.children(".group"),o=a.filter(":eq(0)"),i=a.filter(":not(:eq(0))"),s=o.children("label"),l=o.find(".cell > .group.cl"),p=o.find(".cell > .group:not(.cl)"),f=l.children("label"),m=l.find("input"),g=l.eq(1),v=h.children(".group:eq(1)");switch(t){case"0":e.hide(),i.hide(),s.hide(),p.hide(),d.hide(),c.show(),v.hide(),u.filter("[value=true]").prop("checked",!0).trigger("click"),n.css("position","absolute"),r.removeClass("m-b-sm"),o.removeClass("divider").css("margin-bottom","0"),g.css("clear",""),f.removeClass("em5").addClass("em6"),m.removeClass("sz4").addClass("sz5");break;case"1":e.hide(),i.hide(),s.hide(),p.hide(),d.show(),c.show(),v.show(),n.css("position","static"),r.removeClass("m-b-sm"),o.removeClass("divider").css("margin-bottom","0"),g.css("clear","none"),f.removeClass("em5").addClass("em6"),m.removeClass("sz4").addClass("sz5");break;case"3":e.show(),i.show(),s.show(),p.show(),d.hide(),c.hide(),n.css("position","static"),r.addClass("m-b-sm"),o.addClass("divider").css("margin-bottom",""),g.css("clear",""),f.removeClass("em6").addClass("em5"),m.removeClass("sz5").addClass("sz4")}},Y=function(t){switch(a.val()||e.val(),t){case"true":h.show(),g.hide();break;case"false":h.hide(),g.show()}},N=function(){var t=e.filter(":checked"),a=u.filter(":visible:checked");"3"!==t.val()&&"true"!==a.val()||D.trigger("removeDisabled"),!y.prop("checked")&&"false"!==a.val()||"3"===t.val()?D.trigger("removeDisabled"):D.trigger("setDisabled")},A=moment().format("YYYY/MM/DD");k(T),Y(v),s.eq(0).attr("data-dtm-lnsl",x).dtm_lnls("updateOptions",x),s.filter(":not(:eq(0))").attr("data-dtm-lnsl",M).dtm_lnls("updateOptions",M),n.css({left:"420px",top:"117px"}),e.on("click",function(){k($(this).val()),N()}),u.on("click",function(){Y($(this).val()),N()}),f.on("change",function(){var t=f.val().replace(/\//g,""),e=m.val().replace(/\//g,"");moment().format("YYYY/MM/DD"),moment(t).isAfter(e)&&m.val(moment(t).format("YYYY/MM/DD")),m.cy_ln("updateOption",{minDate:moment(t).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"回程日期不得小於出發日期！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}})}).on("recodeLoaded",function(){var t=f.val().replace(/\//g,""),e=m.val().replace(/\//g,""),a=(moment().format("YYYY/MM/DD"),{date:$(this).val(),status:null});$(this).trigger("checkDateStatus",[a]),"beforeMin"==a.status&&$(this).val(A),moment(t).isAfter(e)&&m.val(moment(t).format("YYYY/MM/DD")),m.cy_ln("updateOption",{minDate:moment(t).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"回程日期不得小於出發日期！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}})}),m.on("recodeLoaded",function(){var t=f.val().replace(/\//g,""),e=$(this).val().replace(/\//g,""),a=moment().format("YYYYMMDD");(moment(e).isBefore(a)||moment(e).isBefore(t))&&$dateEnd.val("")}),y.on("click",function(t){y.prop("checked")||"false"===u.filter(":checked").val()?D.trigger("setDisabled"):D.trigger("removeDisabled")}),l.on("click",function(t){i=r.children(".group");var e=i.last(),a=e.find("[data-toggle=cy-ln]"),n=function(){return'<div class="group divider">'+i.eq(0).html()+'<div class="cell"><span class="remove">&times;</span></div></div>'}().replace(/>\s+</g,"><"),o=$(n),s=$(".divider-b",r),l=o.find("[data-toggle=dtm-lnls]").removeAttr("data-save").removeAttr("data-savecustom");s.before(o),l.dtm_lnls("updateOptions",M),o.find(".remove").one("click",function(){l.dtm_lnls("destroy"),o.remove(),i=r.children(".divider"),i.length<6&&s.show()}),o.find("[data-toggle=cy-ln]").removeAttr("data-save").cy_ln({monthCount:1,minDate:function(t){return moment(t.val().replace(/\//g,"")).isValid()?moment(t.val().replace(/\//g,"")):moment().subtract(1,"days")}(a),maxDate:moment().add(361,"days"),weekdayName:["日","一","二","三","四","五","六"]}),o.find("[data-toggle=cy-ln]").val(function(t){return t.val()}(e.find("[data-toggle=cy-ln]"))),6===r.children(".divider").length&&s.hide()}),r.delegate("input[data-toggle=cy-ln]","change",function(t){var e=$(t.delegateTarget).find("input[data-toggle=cy-ln]"),a=$(this),n=e.index(a),r=a.val();r.length>0&&moment(Date.parse(r)).isValid()?e.each(function(t){t<n?Date.parse($(this).val())>Date.parse(r)&&$(this).val(r):t>n&&(Date.parse($(this).val())<=Date.parse(r)&&$(this).val(r),$(this).cy_ln("updateOption",{minDate:moment(Date.parse(r)).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"日期必須大於{#Date}！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}}))}):null!==$(this).cy_ln("getOptions").minDate&&$(this).val(moment().format("YYYY/MM/DD"))})}).call(this);break;case"flightsNormal":(function(){var t=$("input[name=sRtow]"),e=$("input[name=sRtow]:checked"),a=e.val(),n=$(this).find("select[name=sCarr]"),r=$(this).find("select[name=sCarrReturn]"),i=$(this).find("#flightsNormalDeparture"),s=$(this).find("#flightsNormalDestination"),l=$(this).find("#flightsNormalReturn"),d=$(this).find("input[name=sTdate]"),c=$(this).find("input[name=sFdate]"),u=function(t,e,a,n,r){var o=a.length>0?t[e][a].split(","):[],i=[];o=$.grep(o,function(t){return t.length>0});for(var s=0;s<o.length;s++){var l=o[s];n?i.push(n[l]):i.push(t.AirName[l])}r.html(function(){var t="";t+='<option value="">不限</option>';for(var e=0;e<o.length;e++)t+='<option value="'+o[e]+'">'+i[e]+"</option>";return t})},p={},h=o.flightsNormal.fields.departure,f="{'source':'"+h+"','sendData': {'Species':'F','sRtow':'"+a+"'},'region':false,'more':true,'moreString':'更多出發地，請輸入關鍵字','autocomplete':true,'dataTemplate':'flightsNormalDeparture','addKeyToString':true,'spliteSymbol':'-','depthLimitStart':2,'parentStringForward': true,'searchParentString':true,'removeStringOnMenu':'\\u005c(.+\\u005c)','keyUpTriggerChange':false,'removeNotWordStringWhenSearch':false,'lineOrder':['_TW','_CN','_JP','_US','_CA','_TH'],'appendTargetPosition':'body'}",m=o.flightsNormal.fields.destination,g=o.flightsNormal.fields.destination2,v=o.flightsNormal.fields.return,y="{'source':'"+v+"','sendData': {'Species':'F2','sFcountry':'TW','sFcity':'TPE','sTcountry':'','sTcity':''},'region':false,'autocomplete':true,'dataTemplate':'flightsNormalReturn','removeString':'(\\u005cw+) - (\\u005cW+)','replaceTo':'$2($1)','removeStringParent':'(\\u005cw+) - (\\u005cW+)','replaceToParent':'$2($1)','spliteSymbol':'-','depthLimitStart':3,'parentStringForward': true,'searchParentString':true,'verfiyError':'請選擇出發地及目的地','removeStringOnMenu':'\\u005c(\\u005cw+\\u005c)','removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",b=function(t){var e=t,a=i.attr("data-fcountry")&&i.attr("data-fcountry").length>0?i.attr("data-fcountry").replace("_",""):"",o=i.attr("data-fcity")&&i.attr("data-fcountry").length>0?i.attr("data-fcity").replace("_",""):"",c=s.attr("data-tcountry")?s.attr("data-tcountry").replace("_",""):"",u=s.attr("data-tcity")?s.attr("data-tcity").replace(c,"").replace(/\_/g,""):"",p="{'source':'"+h+"','sendData': {'Species':'F','sRtow':'"+e+"'},'region':false,'more':true,'moreString':'更多出發地，請輸入關鍵字','autocomplete':true,'dataTemplate':'flightsNormalDeparture','addKeyToString':true,'spliteSymbol':'-','depthLimitStart':2,'parentStringForward': true,'searchParentString':true,'removeStringOnMenu':'\\u005c(.+\\u005c)','keyUpTriggerChange':false,'removeNotWordStringWhenSearch':false,'lineOrder':['_TW','_CN','_JP','_US','_CA','_TH'],'appendTargetPosition':'body'}",f="{'source':'"+m+"','sendData': {'Species':'T','sRtow':'"+e+"','sFcountry':'"+a+"','sFcity':'"+o+"'},'region':false,'autocomplete':true,'dataTemplate':'flightsNormalDestination','removeString':'(^\\u005cw+) - (\\u005cw.+|.+)__(.+\\u005cS|)','replaceTo':'$2-$3($1)','removeStringParent':'(\\u005cw+) - (\\u005cW+)','replaceToParent':'$2($1)','spliteSymbol':'-','autoOnly':"+("TW"!=a)+",'depthLimitStart':3,'parentStringForward': true,'searchAllMergeString':true,'verfiyError':'請選擇出發地','runCustomArrangeData':true,'inputFillByTxt':true,'removeNotWordStringWhenSearch':false,'toggleCustomMenu':"+("TW"==a)+",'menuSource':'"+g+"','customMenuLineOrder':['_5','_6','_7','_3','_1','_2','_4'],'runCustomMenuRenderer':true,'appendTargetPosition':'body'}",y="{'source':'"+v+"','sendData': {'Species':'F2','sFcountry':'"+a+"','sFcity':'"+o+"','sTcountry':'"+c+"','sTcity':'"+u+"'},'region':false,'autocomplete':true,'dataTemplate':'flightsNormalReturn','removeString':'(\\u005cw+) - (\\u005cW+)','replaceTo':'$2($1)','removeStringParent':'(\\u005cw+) - (\\u005cW+)','replaceToParent':'$2($1)','spliteSymbol':'-','depthLimitStart':3,'parentStringForward': true,'searchParentString':true,'verfiyError':'請選擇出發地及目的地','removeStringOnMenu':'\\u005c(\\u005cw+\\u005c)','removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}";switch(i.attr("data-dtm-lnsl",p),s.attr("data-dtm-lnsl",f).dtm_lnls("updateOptions",f),e){case"0":d.closest(".group").hide(),l.closest(".group").hide(),n.closest(".group").show(),r.closest(".group").hide();break;case"1":d.closest(".group").show(),l.closest(".group").hide(),n.closest(".group").show(),r.closest(".group").hide();break;case"2":d.closest(".group").show(),l.closest(".group").show(),n.closest(".group").hide(),r.closest(".group").show(),l.attr("data-dtm-lnsl",y).dtm_lnls("updateOptions",y)}};i.attr({"data-dtm-lnsl":f,"data-fcountry":"_TW","data-fcity":"_TPE","data-txt":"桃園國際機場(TPE)","data-parentxt":""}).val("桃園國際機場(TPE)"),l.attr("data-dtm-lnsl",y),c.val(moment().format("YYYY/MM/DD")),c.on("change",function(){var t=$(this).val(),e=d.val(),a=Date.parse(t),n=Date.parse(e);$(this).data("default"),$(this),a>n?(d.val(moment(t.replace(/\W/g,"")).format("YYYY/MM/DD")),d.cy_ln("updateOption",{minDate:moment(t.replace(/\W/g,"")).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"回程日期不得小於出發日期！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}})):d.cy_ln("updateOption",{minDate:moment(t.replace(/\W/g,"")).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"回程日期不得小於出發日期！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}})}).data("default",moment().format("YYYY/MM/DD")).on("recodeLoaded",function(){var t=$(this).val().replace(/\//g,""),e=moment().format("YYYYMMDD");moment(t).isBefore(e)&&$(this).val(moment().format("YYYY/MM/DD"))}),d.on("change",function(t){var e=$(this),a=$(this).data("default"),n=c.val(),r=$(this).val(),o=Date.parse(n),i=Date.parse(r);Date.parse(a),i<o&&(alert("回程日期不得小於出發日期"),i<o&&e.val(moment(o).format("YYYY/MM/DD")))}).data("default",moment().format("YYYY/MM/DD")).on("recodeLoaded",function(){var t=$(this).val().replace(/\//g,""),e=moment().format("YYYYMMDD");moment(t).isBefore(e)&&$(this).val("")}),d.closest(".group").hide(),l.closest(".group").hide(),b(a),t.on("click",function(){var t=$(this).val();b(t)}),i.on("dtm_lnlsChanged",function(){var t=$("input[name=sRtow]:checked").val(),e=$(this).attr("data-fcountry")?$(this).attr("data-fcountry").replace("_",""):"",a=$(this).attr("data-fcity")?$(this).attr("data-fcity").replace("_",""):"",n="{'source':'"+m+"','sendData': {'Species':'T','sRtow':'"+t+"','sFcountry':'"+e+"','sFcity':'"+a+"'},'region':false,'autocomplete':true,'dataTemplate':'flightsNormalDestination','removeString':'(^\\u005cw+) - (\\u005cw.+|.+)__(.+\\u005cS|)','replaceTo':'$2-$3($1)','removeStringParent':'(\\u005cw+) - (\\u005cW+)','replaceToParent':'$2($1)','spliteSymbol':'-','autoOnly':"+("TW"!=e)+",'depthLimitStart':3,'parentStringForward': true,'searchAllMergeString':true,'verfiyError':'請選擇出發地','runCustomArrangeData':true,'inputFillByTxt':true,'removeNotWordStringWhenSearch':false,'toggleCustomMenu':"+("TW"==e)+",'menuSource':'"+g+"','customMenuLineOrder':['_5','_6','_7','_3','_1','_2','_4'],'runCustomMenuRenderer':true,'appendTargetPosition':'body'}";s.attr("data-dtm-lnsl",n).dtm_lnls("updateOptions",n),"TW"!==e&&e.length>0&&s.trigger("dtm_lnlsInit").dtm_lnls("chooseFirstData")}),s.on("dtm_lnlsChanged",function(t,e,a){var r=$("input[name=sRtow]:checked").val(),o=e.attr("data-tcity"),s=i.attr("data-fcountry")?i.attr("data-fcountry").replace("_",""):"",d=i.attr("data-fcity")?i.attr("data-fcity").replace("_",""):"",c=$(this).attr("data-tcountry")?$(this).attr("data-tcountry").replace("_",""):"",h=$(this).attr("data-tcity")?$(this).attr("data-tcity").replace(c,"").replace(/\_/g,""):"",f="{'source':'"+v+"','sendData': {'Species':'F2','sFcountry':'"+s+"','sFcity':'"+d+"','sTcountry':'"+c+"','sTcity':'"+h+"'},'region':false,'autocomplete':true,'dataTemplate':'flightsNormalReturn','removeString':'(\\u005cw+) - (\\u005cW+)','replaceTo':'$2($1)','removeStringParent':'(\\u005cw+) - (\\u005cW+)','replaceToParent':'$2($1)','spliteSymbol':'-','depthLimitStart':3,'parentStringForward': true,'searchParentString':true,'verfiyError':'請選擇出發地及目的地','removeStringOnMenu':'\\u005c(\\u005cw+\\u005c)','removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}";void 0!==a&&(p=a.AirName,"2"!=r?u(a,"vTAirline",o,null,n):n.html('<option value="">不限</option>')),l.attr("data-dtm-lnsl",f).dtm_lnls("updateOptions",f)}).on("recodeLoaded",function(){b(e.val())}),l.on("dtm_lnlsChanged",function(t,e,a){if(void 0!==a){var n=$("input[name=sRtow]:checked").val(),o=e.attr("data-fcity2");"2"==n&&o?u(a,"vFAirline2",o,p,r):r.html('<option value="">不限</option>')}})}).call(this);break;case"flightsFloor":(function(){var t=$("input[name=sTripType]"),e=$("input[name=sTripType]:checked"),a=e.val(),n=$(this).find("#sRoundTripTypeConfirmedFromDate"),r=$("#sRoundTripTypeConfirmedToDate"),i=($(this).find("select[name=sPaxCountAdult]"),$(this).find("select[name=sPaxCountChild]"),o.flightsFloor.fields.place),s=o.flightsFloor.fields.departure,l=o.flightsFloor.fields.destination,d=$("#flightsFloorDeparture"),c="{'source':'"+i+"','menuSource':'"+s+"','bfmQuery':true,'moreString':'更多出發地，請輸入關鍵字','toggleCustomMenu':true,'autoCategory':true,'dataTemplate':'flightsFloor','region':false,'removeStringOnMenu':'-\\u005cw.+','disabled':2,'more':true,'removeNotWordStringWhenSearch':false,'runCustomMenuRenderer':true,'customMenuLineOrder':['_9','_5','_6','_7','_3','_1','_2'],'appendTargetPosition':'body'}",u=$("#flightsFloorDestination"),p="{'source':'"+i+"', 'bfmQuery':true, 'autoCategory':true,'dataTemplate':'flightsFloor','more':true,'removeNotWordStringWhenSearch':false,'toggleCustomMenu':true,'menuSource':'"+l+"','runCustomMenuRenderer':true,'customMenuLineOrder':['_5','_6','_7','_3','_1','_2','_4'],'appendTargetPosition':'body'}",h=u.closest(".group"),f=(h.children("label"),$("#sDirectFlight").closest(".group")),m=$("#sOneWayFromDate"),g=(m.closest(".group"),$("input[name=sRoundTripType]")),v=$("input[name=sRoundTripType]:checked"),y=v.val(),b=$("#fcOneWayRoundWrap"),w=$("#fcOneWayWrap"),C=$("#fcRoundTripWrap"),D=$("#fcRoundTripTypeConfirmedWrap"),T=$("#fcRoundTripTypeNotConfirmedWrap"),S=$(this).find("[name=sRoundTripTypeNotConfirmedFromDate]"),_=$("#fcMultiDestWrapper"),x=_.children(".divider"),M=x.find("[data-toggle=dtm-lnls]"),k=$(".additem",_),Y=$("#multiDestDeparture1"),N=_.find("input[data-toggle=cy-ln]").eq(0),A=_.find("input[data-toggle=cy-ln]").eq(1),O="{'source':'"+i+"', 'bfmQuery':true, 'autoCategory':true,'dataTemplate':'flightsFloor','removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",I=function(t){switch(t){case"ONE_WAY":b.show(),w.show(),C.hide(),_.hide(),h.addClass("cl"),f.css("position","absolute");break;case"ROUND_TRIP":b.show(),w.hide(),C.show(),_.hide(),h.removeClass("cl"),f.css("position","static");break;case"MULTI_DEST":b.hide(),w.hide(),C.hide(),_.show(),f.css("position","static")}},W=function(t){switch(t){case"CONFIRMED":D.show(),T.hide();break;case"NOT_CONFIRMED":D.hide(),T.show(),!moment(S.val().replace(/\W/g,"")).isValid()&&S.val(moment().format("YYYY/MM/DD"))}};f.css({left:"420px",top:"117px"}),I(a),W(y),m.val(moment().format("YYYY/MM/DD")),d.attr({"data-dtm-lnsl":c,"data-intvalue":"台北-Taipei(TPE)","data-label":"中華民國(TW)-台北-Taipei(TPE)","data-iscity":"true","data-cityname":"台北-Taipei","data-citycode":"TPE","data-countryname":"中華民國","data-countrycode":"TW"}).val("台北-Taipei(TPE)"),Y.attr({"data-dtm-lnsl":c,"data-intvalue":"台北-Taipei(TPE)","data-label":"中華民國(TW)-台北-Taipei(TPE)","data-iscity":"true","data-cityname":"台北-Taipei","data-citycode":"TPE","data-countryname":"中華民國","data-countrycode":"TW"}).val("台北-Taipei(TPE)");var L=moment().format("YYYY/MM/DD");n.val(L).data("default",L),S.val(L).data("default",L),u.attr("data-dtm-lnsl",p),M.attr("data-dtm-lnsl",O),M.dtm_lnls("updateOptions",O),N.val(moment().format("YYYY/MM/DD")),t.on("click",function(){a=$(this).val(),I(a)}),g.on("click",function(){y=$(this).val(),W(y)}),m.on("change recodeLoaded",function(){var t=$(this).val().replace(/\//g,""),e=moment().add($(this).attr("data-maxdate"),"d").format("YYYYMMDD"),a=moment().format("YYYYMMDD");moment(t).isAfter(e)&&$(this).val(moment().format("YYYY/MM/DD")),moment(t).isBefore(a)&&$(this).val(moment().format("YYYY/MM/DD"))}),n.on("change",function(){var t=n.val().replace(/\//g,""),e=r.val().replace(/\//g,"");moment().format("YYYY/MM/DD"),moment(t).isAfter(e)?(r.val(moment(t).format("YYYY/MM/DD")),r.cy_ln("updateOption",{minDate:moment(t).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"回程日期不得小於出發日期！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}})):r.cy_ln("updateOption",{minDate:moment(t).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"回程日期不得小於出發日期！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}})}).on("recodeLoaded",function(){var t={date:$(this).val(),status:null};$(this).trigger("checkDateStatus",[t]),"beforeMin"==t.status&&$(this).val(L)}),r.on("change",function(){var t=n.val().replace(/\//g,""),e=r.val().replace(/\//g,"");moment().format("YYYYMMDD"),moment(e).isBefore(t)&&(alert("回程日期不得小於出發日期"),r.val(moment(t).format("YYYY/MM/DD")))}).on("recodeLoaded",function(){var t=$(this).val().replace(/\//g,""),e=moment().format("YYYYMMDD");moment(t).isBefore(e)&&r.val("")}),S.on("recodeLoaded",function(){var t=$(this).val().replace(/\//g,""),e=moment().format("YYYYMMDD");moment(t).isBefore(e)&&$(this).val(moment().format("YYYY/MM/DD"))}),N.on("recodeLoaded",function(){var t=$(this).val().replace(/\//g,""),e=moment().format("YYYYMMDD");moment(t).isBefore(e)&&$(this).val(moment().format("YYYY/MM/DD"))}),A.on("recodeLoaded",function(){var t=$(this).val().replace(/\//g,""),e=moment().format("YYYYMMDD");moment(t).isBefore(e)&&$(this).val("")}),k.on("click",function(){x=_.children(".divider");var t=x.last(),e=t.find("[data-toggle=cy-ln]"),a=function(){return'<div class="group divider">'+x.eq(0).html()+'<div class="cell"><span class="remove">&times;</span></div></div>'}().replace(/>\s+</g,"><"),n=$(a),r=$(".divider-b",_),o=n.find("[data-toggle=dtm-lnls]").removeAttr("data-save").removeAttr("data-savecustom");r.before(n),o.dtm_lnls("updateOptions",p),n.find(".remove").one("click",function(){o.dtm_lnls("destroy"),n.remove(),x=_.children(".divider"),x.length<6&&r.show()}),n.find("[data-toggle=cy-ln]").removeAttr("data-save").cy_ln({monthCount:1,minDate:function(t){return moment(t.val().replace(/\//g,"")).isValid()?moment(t.val().replace(/\//g,"")):moment().subtract(1,"days")}(e),maxDate:moment().add(361,"days"),weekdayName:["日","一","二","三","四","五","六"]}),n.find("[data-toggle=cy-ln]").val(function(t){return t.val()}(t.find("[data-toggle=cy-ln]"))),6===_.children(".divider").length&&r.hide()}),_.delegate("input[data-toggle=cy-ln]","change",function(t){var e=$(t.delegateTarget).find("input[data-toggle=cy-ln]"),a=$(this),n=e.index(a),r=a.val();r.length>0&&moment(Date.parse(r)).isValid()?e.each(function(t){t<n?Date.parse($(this).val())>Date.parse(r)&&$(this).val(r):t>n&&(Date.parse($(this).val())<=Date.parse(r)?$(this).val(r).cy_ln("updateOption",{minDate:moment(Date.parse(r)).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"日期必須大於{#Date}！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}}):$(this).cy_ln("updateOption",{minDate:moment(Date.parse(r)).subtract(1,"d"),alertString:{invalid:"日期格式錯誤！",beforeMin:"日期必須大於{#Date}！",afterMax:"日期必須小於{#Date}！",fromMoreTo:"日期迄日不可小於起日"}}))}):0==moment(Date.parse(r)).isValid()&&null!==$(this).cy_ln("getOptions").minDate&&$(this).val(moment().format("YYYY/MM/DD"))})}).call(this);break;case"flightsChina":(function(){var t=o.flightsChina.fields.place,e=$("#flightsChinaDeparture"),a=$("#flightsChinaDestination"),n=$(this).find('[name="sFdate"]'),r=moment().add(3,"days").format("YYYY/MM/DD");n.val().length<1&&n.val(moment().add(3,"days").format("YYYY/MM/DD")).data("default",r),n.on("change",function(t){}),$.ajax({type:"GET",url:t,data:{Species:"F"},dataType:"script",async:!1,success:function(t){for(var n=t.match(/var.*.=/g),r=0;r<n.length;r++)n[r]=n[r].replace("var ","").replace(" =",""),t=window[n[r]],delete window[n[r]];for(var o in t)e.append(function(){return'<option value="'+o+'"'+("_PEK_PEK"==o?'selected="selected"':"")+">"+t[o].replace(/([A-Z])+/g,"")+("請選擇"!==t[o]?"("+t[o].match(/([A-Z]+)/g)+")":"")+"</option>"}()),a.append('<option value="'+o+'"'+("_SHA_SHA"==o?'selected="selected"':"")+">"+t[o].replace(/([A-Z])+/g,"")+("請選擇"!==t[o]?"("+t[o].match(/([A-Z]+)/g)+")":"")+"</option>")},error:function(t){}}),e.on("change",function(t){a.find("option[disabled]").removeAttr("disabled"),a.find("option[value="+$(this).val()+"]").prop("disabled","disabled")})}).call(this);break;case"flightsTaiwan":(function(){var t=$("input[name=sRtowTaiwan]"),a=$("input[name=sRtowTaiwan]:checked"),n=a.val(),r=$(this).find("input[name=sFdate]"),i=$(this).find("input[name=sTdate]"),s=$(this).find("select[name=sCarr]"),l=function(t){switch(t){case"0":i.closest(".group").hide();break;case"1":case"2":i.closest(".group").show()}},d={_:"//www.liontravel.com/info/twairline/mandarin.asp",1:"//www.liontravel.com/info/twairline/uni.asp",2:"//www.liontravel.com/info/twairline/mandarin.asp",3:"//www.liontravel.com/info/twairline/fat.asp"};l(n),r.val(moment().format("YYYY/MM/DD")),t.on("click",function(){var t=$(this).val();l(t)}),s.on("change",function(){var t=$(this).val();o[e].action=d[t]})}).call(this);break;case"freeGroup":(function(){var t=$(this).find("#freeGroupDeparture"),e=o.freeGroup.fields.destination,a=$(this).find("#freeGroupDestination"),n=o.freeGroup.fields.destination,r="{'source':'"+n+"','lineOrder': ['_6','_5','_7','_3','_1','_4','_2'],'region':true,'more':false,'autocomplete':true,'dataTemplate':'freeGroup','searchAllMergeString':true,'removeNotWordStringWhenSearch':false,'arrangeDataSortByOrderLine':true,'spliteSymbol':'-','removeRegex':false,'appendTargetPosition':'body'}",i=$(this).find("#freeGroupKeyWord"),s=o.freeGroup.fields.keyword,l="{'source':'"+s+"','sendData': {'sArea':'','sKeyWord':''},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'appendTargetPosition':'body'}",d=$(this).find('[data-toggle="cy-ln"]');a.attr("data-dtm-lnsl",r),d.eq(0).val().length<1&&d.eq(0).val(moment().add(15,"days").format("YYYY/MM/DD")),d.eq(1).val(moment().add(30,"days").format("YYYY/MM/DD")),i.attr("data-dtm-lnsl",l),$.ajax({type:"GET",url:e,dataType:"script",async:!1,success:function(e){for(var a={},n=e.match(/var.*.=/g),r=0;r<n.length;r++)n[r]=n[r].replace("var ","").replace(" =",""),a[n[r]]=window[n[r]],delete window[n[r]];for(var o in a.vCity)t.append('<option value="'+o+'"'+("_"==o?'selected="selected"':"")+">"+a.vCity[o]+"</option>")},error:function(t){}}),d.on("recodeLoaded",function(){var t={date:$(this).val(),status:null};$(this).trigger("checkDateStatus",[t]),"beforeMin"==t.status&&(d.eq(0).val(moment().add(15,"days").format("YYYY/MM/DD")),d.eq(1).val(moment().add(30,"days").format("YYYY/MM/DD")))})}).call(this);break;case"freeNew":(function(){var t=$(this),e=t.find("[name=ChildCot]"),a=t.find("#ChildCotAge1,#ChildCotAge2,#ChildCotAge3"),n=a.parents(".group"),r=t.find("[name=ChildCotAge]"),i=t.find("[name=Child]"),s=t.find("#ChildAge1,#ChildAge2,#ChildAge3"),l=s.parents(".group"),d=t.find("[name=ChildAge]"),c=(t.find("[name=Room]"),t.find("[name=Adult]"),$(this).find('[data-toggle="cy-ln"]')),u=$("#freeNewDeparture"),p=o.freeNew.fields.departure,h=$("#freeNewDestination"),f=o.freeNew.fields.destination,m="{'source':'"+f+"','autocomplete':true,'dataTemplate':'freeNew','inline':false,'disabled':2,'lineOrder':['6','5','7','3','1','2','4'],'removeStringOnMenu':'\\u005c(.+\\u005c).+|\\u005c(\\u005c).+','depthLimitStart':3,'dontSliceFirstChar':true,'removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",g=$("#freeNewAirline"),v=o.freeNew.fields.airLine,y=null,b=$("#freeNewKeyWord"),w=o.freeNew.fields.keyword,C="{'source':'"+w+"','autocomplete':true,'qQuery':true,'autoOnly':true,'rmValueWhenNoFound':false,'autoSelector':false,'qQueryMaxNum':10,'appendTargetPosition':'body'}",D=moment().add(5,"days").format("YYYY/MM/DD"),T=moment().add(10,"days").format("YYYY/MM/DD"),S=function(t,e){return!(parseInt(t)+parseInt(e)>3)};c.eq(0).val().length<1&&c.eq(0).val(D).data("default",D),c.eq(1).val(T).data("default",T),a.hide(),n.hide(),s.hide(),l.hide(),$.ajax({type:"GET",url:p,dataType:"json",async:!1,success:function(t){for(var e=0;e<t.length;e++)u.append('<option value="'+t[e].Country+"_"+t[e].City+'"'+("TPE"==t[e].City?'selected="selected"':"")+">"+t[e].CityName+"</option>")},error:function(t){}}),h.attr("data-dtm-lnsl",m),b.attr("data-dtm-lnsl",C),h.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var n,r,o=$(this).attr("data-country"),i=$(this).attr("data-city");if(!y&&$.ajax({type:"GET",url:v,dataType:"json",async:!1,success:function(t){y=t},error:function(t){}}),g.html('<option value="">不限</option>'),n=y.filter(function(t){return t.Country===o&&t.City===i})[0]){r=n.List;for(var s=0;s<r.length;s++)g.append('<option value="'+r[s].Carr+'">'+r[s].Carr+" - "+r[s].CarrName+"</option>")}}),b.on("change",function(){$(this).val().length>0?h.attr("data-required","false"):h.attr("data-required","true")}),b.on("dtm_lnlsChanged",function(){$(this).trigger("change")}),e.on("change",function(){var t=parseInt($(this).val()),e=parseInt(i.val());if(S(t,e)){a.hide(),t>0?n.show():n.hide();for(var r=0;r<t;r++)a.eq(r).show()}else alert("小孩人數最多3人"),$(this).val(0)}),a.on("change",function(t){for(var n=r,o=parseInt(e.val()),i=new Array(o),s=(a.index($(this)),0);s<o;s++)i[s]=a.eq(s).val();n.val(i)}).on("recodeLoaded",function(){$(this).trigger("change")}),i.on("change",function(){var t=parseInt($(this).val()),a=parseInt(e.val());if(S(t,a)){s.hide(),t>0?l.show():l.hide();for(var n=0;n<t;n++)s.eq(n).show()}else alert("小孩人數最多3人"),$(this).val(0)}),s.on("change",function(t){for(var e=d,a=parseInt(i.val()),n=new Array(a),r=(s.index($(this)),0);r<a;r++)n[r]=s.eq(r).val();e.val(n)}).on("recodeLoaded",function(){$(this).trigger("change")}),c.on("recodeLoaded",function(){$(this).trigger("checkDateRepair")})}).call(this);break;case"freeTaiwan":(function(){var t=$(this).find('[data-toggle="cy-ln"]'),e=($(this).find("#freeTaiwanDeparture"),$(this).find("#freeTaiwanDestination")),a=o.freeTaiwan.fields.destination,n="{'source':'"+a+"','region':false,'autocomplete':true,'inline':true,'dataTemplate':'freeTaiwan','disabled': 2,'depthLimitStart':3,'spliteSymbol':'-','removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",r=$(this).find("#freeTaiwanKeyWord"),i=o.freeTaiwan.fields.keyword,s="{'source':'"+i+"','sendData': {'citycode':'','countrycode':'TW'},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','removeNotWordStringWhenSearch':false,'rmValueWhenNoFound':false,'autoSelector':false,'hotelQueryMaxNum':10,'appendTargetPosition':'body'}",l=moment().add(5,"days").format("YYYY/MM/DD"),d=moment().add(30,"days").format("YYYY/MM/DD");t.eq(0).val().length<1&&t.eq(0).val(l).data("default",l),t.eq(1).val(d).data("default",d),e.attr("data-dtm-lnsl",n),r.attr("data-dtm-lnsl",s),e.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var n,o,l={line:void 0!==e.attr("data-line")?e.attr("data-line"):"",area:void 0!==e.attr("data-area")?e.attr("data-area"):"",tcity:void 0!==e.attr("data-tcity")?e.attr("data-tcity"):"",parentxt:void 0!==e.attr("data-parentxt")?e.attr("data-parentxt"):"",txt:void 0!==e.attr("data-txt")?e.attr("data-txt"):""};l?(n=l.tcity.replace(/_/,""),o="TW"):(n="",o="TW"),s="{'source':'"+i+"','sendData': {'citycode':'"+n+"','countrycode':'"+o+"'},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','removeNotWordStringWhenSearch':false,'rmValueWhenNoFound':false,'autoSelector':false,'hotelQueryMaxNum':10,'appendTargetPosition':'body'}",r.attr("data-dtm-lnsl",s).dtm_lnls("updateOptions",s)})}).call(this);break;case"freeAir":(function(){var e=this,a=$(this).find('[data-toggle="cy-ln"]'),n=$(this).find("#freeAirDestination"),r=o.freeAir.fields.destination,i="{'source':'"+r+"','region':false,'autocomplete':true,'dataTemplate':'freeAir','disabled': 2,'removeString': '(.+)__(\\u005cw.+)?','replaceTo':'$1($2)','lineOrder':['_6','_5','_7','_3','_1','_2','_4'],'dontSliceFirstChar':true,'addKeyToString':'_(.+)','removeStringOnMenu':'\\u005cw|\\u005c(.+\\u005c)|\\u005cs','addKeyToStringReplaceTo':'$1','searchAllMergeString':true,'spliteSymbol':'-','removeStringParent':'\\u005c(.+\\u005c)','depthLimitStart':3,'removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",s=$(e).find("select[name=sCarr]"),l=$(this).find("#freeAirKeyWord"),d=o.freeAir.fields.keyword,c="{'source':'"+d+"','sendData': {'citycode':'','countrycode':''},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','removeNotWordStringWhenSearch':false,'rmValueWhenNoFound':false,'autoSelector':false,'hotelQueryMaxNum':10,'appendTargetPosition':'body'}",u=moment().add(7,"days").format("YYYY/MM/DD"),p=moment().add(30,"days").format("YYYY/MM/DD");a.eq(0).val().length<1&&a.eq(0).val(u).data("default",u),a.eq(1).val(p).data("default",p),n.attr("data-dtm-lnsl",i),l.attr("data-dtm-lnsl",c),n.on("dtm_lnlsChanged",function(e,a,n){var r,o,i={linearr:void 0!==a.attr("data-linearr")?a.attr("data-linearr"):"",countryarr:void 0!==a.attr("data-countryarr")?a.attr("data-countryarr"):"",cityarr:void 0!==a.attr("data-cityarr")?a.attr("data-cityarr"):"",parentxt:void 0!==a.attr("data-parentxt")?a.attr("data-parentxt"):"",txt:void 0!==a.attr("data-txt")?a.attr("data-txt"):""};if(i?(r=i.cityarr.replace(/_/,""),o=i.countryarr.replace(/_/,"")):(r="",o=""),c="{'source':'"+d+"','sendData': {'citycode':'"+r+"','countrycode':'"+o+"'},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','removeNotWordStringWhenSearch':false,'rmValueWhenNoFound':false,'autoSelector':false,'hotelQueryMaxNum':10,'appendTargetPosition':'body'}",l.attr("data-dtm-lnsl",c).dtm_lnls("updateOptions",c),n&&"object"==(void 0===n?"undefined":t(n))&&r){var u=n.AirlineArr[a.attr("data-cityarr")].split(",");s.html(function(){for(var t="",e=0;e<u.length;e++)0==u[e].length?t+='<option value="">不限</option>':t+='<option value="'+u[e]+'">'+u[e]+" - "+n.AirName[u[e]]+"</option>";return t}),s.find('option[value="'+s.data("recode")+'"]').prop("selected",!0)}})}).call(this);break;case"thsrcTaiwan":(function(){var t=$(this).find('[data-toggle="cy-ln"]'),e=$(this).find("#thsrcTaiwanDestination"),a=o.thsrcTaiwan.fields.destination,n="{'source':'"+a+"','region':false,'autocomplete':true,'inline':true,'dataTemplate':'thsrcTaiwan','disabled': 2,'depthLimitStart':3,'spliteSymbol':'-','removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",r=$(this).find("#thsrcTaiwanKeyWord"),i=o.thsrcTaiwan.fields.keyword,s="{'source':'"+i+"','sendData': {'citycode':'','countrycode':'TW'},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','removeNotWordStringWhenSearch':false,'rmValueWhenNoFound':false,'autoSelector':false,'hotelQueryMaxNum':10,'appendTargetPosition':'body'}",l=moment().add(5,"days").format("YYYY/MM/DD"),d=moment().add(30,"days").format("YYYY/MM/DD");t.eq(0).val().length<1&&t.eq(0).val(l).data("default",l),t.eq(1).val(d).data("default",d),e.attr("data-dtm-lnsl",n),r.attr("data-dtm-lnsl",s),e.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var n,o,l={line:void 0!==e.attr("data-line")?e.attr("data-line"):"",area:void 0!==e.attr("data-area")?e.attr("data-area"):"",tcity:void 0!==e.attr("data-tcity")?e.attr("data-tcity"):"",parentxt:void 0!==e.attr("data-parentxt")?e.attr("data-parentxt"):"",txt:void 0!==e.attr("data-txt")?e.attr("data-txt"):""};l?(n=l.tcity.replace(/_/,""),o="TW"):(n="",o="TW"),s="{'source':'"+i+"','sendData': {'citycode':'"+n+"','countrycode':'"+o+"'},'autocomplete':true,'hotelQuery':true,'autoOnly':true,'verfiyError':'請先輸入上方目的地條件','removeNotWordStringWhenSearch':false,'rmValueWhenNoFound':false,'autoSelector':false,'hotelQueryMaxNum':10,'appendTargetPosition':'body'}",r.attr("data-dtm-lnsl",s).dtm_lnls("updateOptions",s)})}).call(this);break;case"ticketAbroad":(function(){var t=$(this).find("#ticketAbroadDestination"),e=o.ticketAbroad.fields.destination,a="{'source':'"+e+"','autocomplete':true,'dataTemplate':'ticketAbroad','depthLimitStart':2,'more':true,'dontSliceFirstChar':true,'refDate':{'LineArr':{'_4':'亞非','_3':'歐洲','_2':'大洋洲','_1':'美洲','_5':'大陸港澳','_7':'東南亞','_6':'東北亞','_9':'台灣'}},'lineOrder':['_6','_5','_7','_3','_1','_4','_2'],'searchParentString':true,'exclude':{'LineArr':['_9']},'spliteSymbol':'-','removeNotWordStringWhenSearch':false,'removeStringOnAuto':'-亞非|-歐洲|-大洋洲|-美洲|-大陸港澳|-東南亞|-東北亞|-台灣','appendTargetPosition':'body'}",n=$(this).find("#ticketAbroadKeyWord"),r=o.ticketAbroad.fields.keyword,i="{'source':'"+r+"','sendData': {'sKeyWord':''},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'removeNotWordStringWhenSearch':false,'autoSelector':false,'keywordQueryMaxNum':10,'appendTargetPosition':'body'}";t.attr("data-dtm-lnsl",a),n.attr("data-dtm-lnsl",i),t.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var o=n.val();i="{'source':'"+r+"','sendData': {'sKeyWord':'"+o+"'},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",n.attr("data-dtm-lnsl",i),n.dtm_lnls("updateOptions",i)})}).call(this);break;case"ticketTaiwan":(function(){var t=$(this).find("#ticketTaiwanDestination"),e=o.ticketTaiwan.fields.destination,a="{'source':'"+e+"','autocomplete':true,'inline':true,'dataTemplate':'ticketTaiwan','depthLimitStart':2,'more':true,'toggleParentStringInAuto':false,'removeNotWordStringWhenSearch':false,'appendTargetPosition':'body'}",n=$(this).find("#ticketTaiwanKeyWord"),r=o.ticketAbroad.fields.keyword,i="{'source':'"+r+"','sendData': {'sKeyWord':''},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'autoSelector':false,'keywordQueryMaxNum':10,'appendTargetPosition':'body'}";t.attr("data-dtm-lnsl",a),n.attr("data-dtm-lnsl",i),t.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var o=n.val();i="{'source':'"+r+"','sendData': {'sKeyWord':'"+o+"'},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'appendTargetPosition':'body'}",n.attr("data-dtm-lnsl",i),n.dtm_lnls("updateOptions",i)})}).call(this);break;case"ticketElectronicTaiwan":(function(){var t=$(this);$.getScript(o.ticketElectronicTaiwan.fields.destination,function(e){var a=function(t){for(var e={},a=new Array(t.length),n=0;n<t.length;n++)a[n]=t[n].replace("var ","").replace(" =",""),e[a[n]]=window[a[n]],delete window[a[n]];return e}(e?e.match(/var\s\w+\s=/g):["var vLine =","var vCountry =","var vCity =","var vCityzone ="]),n={A01:"餐廳美食",A02:"休閒樂活",A03:"住宿．休憩",A04:"溫泉．SPA",A06:"婉君推薦"},r=a.vCity._TW,o=a.vCityzone,i=function(t,e){for(var a=Object.keys(e),n=0;n<=a.length;n++)0===n?t.append('<option disabled="disabled" value>請選擇種類</option>'):t.append('<option value="'+a[n-1]+'">'+e[a[n-1]]+"</option>");return t}(t.find("select[name=sLion]"),n),s=function(t,e){for(var a in e)t.append('<option value="'+a+'">'+("_"===a?"請選擇城市":e[a])+"</option>");return t}(t.find("select[name=sCity]"),r),l=function(t,e,a){for(var n in e)t.append('<option value="'+n+'">'+("_"===n&&e[n].length<1?"請選擇區域":e[n])+"</option>");return t}(t.find("select[name=sCityzone]"),o[s.val()]);s.on("change",function(){var t=o[$(this).val()],e={_84TW:"商圈/景點",_85TW:"行政區",_80TW:"捷運站"},a=function(t,e){for(var a={},n=Object.keys(t),r=0;r<n.length;r++){a[n[r]]={};for(var o in e)!0===new RegExp(n[r]).test(o)&&(a[n[r]][o]=e[o])}return a}(e,t),n=$("<optgroup></optgroup>"),r=[];if(l.html(""),t){l.append('<option value="_">請選擇區域</option>');for(var i in a)if(n=$("<optgroup></optgroup>"),r=Object.keys(a[i]),r.length>0){n.html("").attr("label",e[i]);for(var s in a[i])n.append('<option value="_'+s+'">'+a[i][s]+"</option>");l.append(n)}}else l.append('<option value="_">請選擇區域</option>')}),function(t){t&&i.find('option[value="'+t+'"]').prop("selected",!0).attr("selected","selected")}(i.data("recode")),function(t){t&&(s.find('option[value="'+t+'"]').prop("selected",!0).attr("selected","selected"),s.trigger("change"))}(s.data("recode"))})}).call(this);break;case"themeTrip":(function(){var t=$(this).find('[data-toggle="cy-ln"]'),e=$(this).find("#themeTripDestination"),a=o.themeTrip.fields.destination,n="{'source':'"+a+"','autocomplete':true,'inline':true,'region':true,'dataTemplate':'themeTrip','depthLimitStart':1,'searchAllMergeString':true,'removeNotWordStringWhenSearch':false,'spliteSymbol':'-','lineOrder':['_6','_5','_7','_3','_1','_4','_2','_9'],'removeRegex':false,'appendTargetPosition':'body'}",r=$(this).find("#themeTripKeyWord"),i=o.themeTrip.fields.keyword,s="{'source':'"+i+"','sendData': {'sLine':'','sKeyWord':''},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'appendTargetPosition':'body'}";t.eq(0).val().length<1&&t.eq(0).val(moment().add(15,"days").format("YYYY/MM/DD")),t.eq(1).val(moment().add(30,"days").format("YYYY/MM/DD")),e.attr("data-dtm-lnsl",n),r.attr("data-dtm-lnsl",s),e.on("dtm_lnlsChanged recodeLoaded",function(t,e,a){var n,o={line:void 0!==e.attr("data-line")?e.attr("data-line"):"",linetravel:void 0!==e.attr("data-linetravel")?e.attr("data-linetravel"):"",linewebarea:void 0!==e.attr("data-linewebarea")?e.attr("data-linewebarea"):"",parentxt:void 0!==e.attr("data-parentxt")?e.attr("data-parentxt"):"",txt:void 0!==e.attr("data-txt")?e.attr("data-txt"):""};n=o?o.linetravel.length>0&&"_"!=o.linetravel?o.linetravel.split("_").splice(1).reverse():o.line.length>0&&"_"!=o.line?o.line.split("_").reverse():",":",";var l=r.val();s="{'source':'"+i+"','sendData': {'sLine':'"+n+"','sKeyWord':'"+l+"'},'autocomplete':true,'keywordQuery':true,'autoOnly':true,'verfiyError':'請選擇國外目的地','rmValueWhenNoFound':false,'appendTargetPosition':'body'}",r.attr("data-dtm-lnsl",s),r.dtm_lnls("updateOptions",s)}),t.on("recodeLoaded",function(){var e={date:$(this).val(),status:null};$(this).trigger("checkDateStatus",[e]),"beforeMin"==e.status&&(t.eq(0).val(moment().add(15,"days").format("YYYY/MM/DD")),t.eq(1).val(moment().add(30,"days").format("YYYY/MM/DD")))})}).call(this)}})},whenRecodeWrited:function(t,e,a){var n=e.closest(".panl").attr("data-panl");a?function(t,a,n){for(var r=["data-line","data-linetravel","data-linewebarea","data-country","data-city","data-cityzone","data-area","data-tworld","data-tcountry","data-tcity","data-fcountry","data-fcity","data-txt","data-tline","data-fline2","data-fcountry2","data-fcity2","data-linearr","data-countryarr","data-cityarr"],o={},i=0;i<r.length;i++)if(e.attr(r[i])){var s,l=r[i].replace(/data-/,"");switch(l){case"linetravel":l="travel";break;case"linewebarea":l="webarea"}switch(l){case"linearr":s="LineArr";break;case"countryarr":s="CountryArr";break;case"cityarr":s="CityArr";break;default:s="s"+l.charAt(0).toUpperCase()+l.substr(1).toLowerCase()}o[s]=e.attr(r[i])}switch(t){case"freeNew":o.sCountry&&o.sCity&&(o.Destination=o.sCountry+"_"+o.sCity);break;case"ticketTaiwan":"_"==o.sCity&&(o.sCity=o.sCountry)}a.each(function(t,e){var a=$(this).attr("name");$(this).val(o[a])})}(n,a):function(t){switch(t){case"abroadHotel":case"domesticHotel":e.is("[name=sAdate]")&&function(t,a,n){Date.parse(a)<Date.parse(t)&&e.val(moment(t.replace(/\W/g,"")).format("YYYY/MM/DD"))}(e.data("default"),e.val());break;case"flightsFloor":e.is("[name=sRoundTripTypeConfirmedFromDate]")&&function(t,a,n){Date.parse(a)<Date.parse(t)&&e.val(t)}(e.data("default"),e.val());break;case"freeNew":(e.is("[name=ChildCot]")||e.is("[name=Child]"))&&e.trigger("change");break;case"freePreson":case"freeTaiwan":e.is("[name=sFdate]")&&function(t,a,n){Date.parse(a)<Date.parse(t)&&e.val(moment().add(5,"days").format("YYYY/MM/DD"))}(moment().add(1,"days").format("YYYY/MM/DD"),e.val()),e.is("[name=sTdate]")&&function(t,a,n){Date.parse(a)<Date.parse(t)&&e.val(moment().add(30,"days").format("YYYY/MM/DD"))}(moment().add(1,"days").format("YYYY/MM/DD"),e.val());break;case"freeAir":case"thsrcTaiwan":e.is("[name=sDatef]")&&function(t,a,n){Date.parse(a)<Date.parse(t)&&e.val(moment().add(7,"days").format("YYYY/MM/DD"))}(moment().add(1,"days").format("YYYY/MM/DD"),e.val()),e.is("[name=sDatet]")&&function(t,a,n){Date.parse(a)<Date.parse(t)&&e.val(moment().add(30,"days").format("YYYY/MM/DD"))}(moment().add(1,"days").format("YYYY/MM/DD"),e.val());break;case"freeNew":e.is("[name=FromDate]")&&function(t,a,n){Date.parse(a)<Date.parse(t)&&e.val(moment().add(5,"days").format("YYYY/MM/DD"))}(moment().add(1,"days").format("YYYY/MM/DD"),e.val()),e.is("[name=ToDate]")&&function(t,a,n){Date.parse(a)<Date.parse(t)&&e.val(moment().add(10,"days").format("YYYY/MM/DD"))}(moment().add(1,"days").format("YYYY/MM/DD"),e.val())}}(n)},whenTabSwitchDone:function(t){if(!t.is("[data-panl]"))throw"Panel no have data-panl attribute!";switch(t.attr("data-panl")){case"flightsNormal":(function(t){var e=$("#flightsNormalDeparture"),a=e.data("dtm_lnls"),n=$("#flightsNormalDestination"),r=n.data("dtm_lnls");a.isInit||e.trigger("dtm_lnlsInit"),r.isInit||n.trigger("dtm_lnlsInit")})();break;case"freeNew":(function(t){t.find("#freeNewKeyWord").trigger("dtm_lnlsChanged")})(t);break;case"freeAir":(function(t){var e=$("#freeAirDestination"),a=e.data("dtm_lnls");t.find("select[name=sCarr]");a.isInit||e.trigger("dtm_lnlsInit").dtm_lnls("showTarget",!0)})(t)}},whenInputRemoved:function(t){var e=t.data("dtm_lnls")||!1,a=null!=e.$target&&e.$target.filter(":not(.auto)");e&&(t.dtm_lnls("hideTarget").dtm_lnls("showTarget",!1),a&&a.length>0&&a.find("a").removeClass("active"))},whenFormChanged:function(t,e,a){var n=e.parents(".panl").attr("data-panl");a&&function(t,a,n){for(var r=["data-line","data-linetravel","data-linewebarea","data-country","data-city","data-cityzone","data-area","data-tworld","data-tcountry","data-tcity","data-fcountry","data-fcity","data-txt","data-tline","data-fline2","data-fcountry2","data-fcity2","data-linearr","data-countryarr","data-cityarr"],o={},i=0;i<r.length;i++)if(e.attr(r[i])){var s,l=r[i].replace(/data-/,"");switch(l){case"linetravel":l="travel";break;case"linewebarea":l="webarea"}switch(l){case"linearr":s="LineArr";break;case"countryarr":s="CountryArr";break;case"cityarr":s="CityArr";break;default:s="s"+l.charAt(0).toUpperCase()+l.substr(1).toLowerCase()}o[s]=e.attr(r[i])}switch(t){case"freeNew":o.sCountry&&o.sCity&&(o.Destination=o.sCountry+"_"+o.sCity);break;case"ticketTaiwan":"_"==o.sCity&&(o.sCity=o.sCountry)}a.each(function(t,e){var a=$(this).attr("name");$(this).val(o[a])})}(n,a)},whenSubmit:function(r,i){var s={},l=$("#sform"),d=r,c=d.attr("data-panl"),u=d.find('[name="sLine"]').val(),p=function(t){return t&&t.searchpanel&&0!=t.searchpanel.length?t.searchpanel[0]:null}("object"===("undefined"==typeof big_top_data?"undefined":t(big_top_data))?big_top_data:null);if(d.find('input[data-toggle="dtm-lnls"]').each(function(){"freeNew"!==c&&$(this).trigger("dtm_lnlsChanged",[$(this)])}),function(t){switch(c){case"domesticHotel":var e=!!(d.find("[name=sLine]").val()&&d.find("[name=sCountry]").val()&&d.find("[name=sCity]").val()&&d.find("[name=sCityzone]").val()),a=!!d.find("[name=sHtlName]").val();return!(!e&&!a)||(alert("請輸入目的地或飯店名稱"),!1);case"ticketAbroad":var e=!!d.find("[name=CountryArr]").val()&&!!d.find("[name=CityArr]").val(),n=!!d.find("[name=sEtkind]").val(),r=!!d.find("[name=sName]").val();return!!(e||n||r)||(alert("[目的地]、[種類]、[關鍵字]至少輸入一項"),!1);case"flightsInternational":var o=d.find("[name=Rtow]:checked"),i=(o.val(),{3:function(){var t=d.find(".seek-destination-wrap"),e=t.children(".group:visible"),a=e.find("[data-toggle=dtm-lnls]"),n=a.map(function(t){return{countrycode:$(this).attr("data-countrycode"),citycode:$(this).attr("data-citycode")}}).toArray(),r=n.map(function(t){return t.countrycode}),o=n.map(function(t){return t.citycode}),i=r.every(function(t,e,a){return"TW"===t}),s=r.every(function(t,e,a){return"CN"===t}),l=r.every(function(t,e,a){return"HKG"!==t&&"MFM"!==t}),c=o.every(function(t,e,a){return"HKG"!==t&&"MFM"!==t});return i?(alert("很抱歉，目前暫不提供台灣國內線航班查詢"),!1):!(s&&l&&c)||(alert("很抱歉，目前暫不提供中國國內線航班查詢"),!1)},default:function(){var t=d.find("select[name=Adt]"),e=d.find("select[name=Chd]"),a=d.find("select[name=Inf]"),n=parseInt(t.val()),r=parseInt(e.val()),o=parseInt(a.attr("disabled")?0:a.val()),i=r+o;return n+r+o>8?(alert("總人數不得超過8位"),!1):!(n<o||2*n<r||2*n<i)||(alert("1位大人最多帶2位孩童或1位嬰兒，請再次確認人數"),!1)}});return i[3]()&&i.default();case"flightsNormal":var s=$("#flightsNormalDeparture");return 0!==$("#flightsNormalDestination").val().length&&0!==s.val().length;case"flightsFloor":var l=$("input[name=sTripType]:checked"),u=l.val(),i={MULTI_DEST:function(){var t=$("#fcMultiDestWrapper"),e=t.children(".divider"),a=e.find("[data-toggle=dtm-lnls]"),n=a.map(function(t){return{countrycode:$(this).attr("data-countrycode"),citycode:$(this).attr("data-citycode")}}).toArray(),r=n.map(function(t){return t.countrycode}),o=n.map(function(t){return t.citycode}),i=r.every(function(t,e,a){return"TW"===t}),s=r.every(function(t,e,a){return"CN"===t}),l=r.every(function(t,e,a){return"HKG"!==t&&"MFM"!==t}),d=o.every(function(t,e,a){return"HKG"!==t&&"MFM"!==t});return i?(alert("很抱歉，目前暫不提供台灣國內線航班查詢"),!1):!(s&&l&&d)||(alert("很抱歉，目前暫不提供中國國內線航班查詢"),!1)},NOT_MULTI_DEST:function(){var t=$("#flightsFloorDeparture"),e=$("#flightsFloorDestination"),a=t.attr("data-countrycode"),n=e.attr("data-countrycode"),r=t.attr("data-citycode"),o=e.attr("data-citycode"),i="HKG"!==r&&"MFM"!==r,s="HKG"!==o&&"MFM"!==o;return"TW"===a&&"TW"===n?(alert("很抱歉，目前暫不提供台灣國內線航班查詢"),!1):"CN"===a&&"CN"===n&&s&&i?(alert("很抱歉，目前暫不提供中國國內線航班查詢"),!1):r!==o||(alert("出發地與目的地不可相同"),!1)}};return"MULTI_DEST"!==u?i.NOT_MULTI_DEST():i[u]();case"flightsChina":var p=d.find("#flightsChinaDeparture"),h=d.find("#flightsChinaDestination"),f=p.children("option:selected"),m=h.children("option:selected");return"__"==f.val()||0===f.val().length?(alert("請輸入 / 選擇出發機場"),!1):"__"==m.val()||0===m.val().length?(alert("請輸入 / 選擇目的機場"),!1):f.val()!=m.val()||(alert("出發地與目的地不可相同"),!1);case"freeNew":var g=d.find("[name=Room]"),v=d.find("[name=Adult]");return!(parseInt(g.val())>parseInt(v.val()))||(alert("間數不可多於人數!"),!1);case"ticketTaiwan":var e=function(t){var e=t.find("[name=sCountry]").val(),a=t.find("[name=sCity]").val();return 0==e.length&&t.find("[name=sCountry]").val("TW"),e.length>0&&a.length>0}(d),n=!!d.find("[name=sEtkind]").val(),r=!!d.find("[name=sName]").val();return!!(e||n||r)||(alert("[目的地]、[種類]、[關鍵字]至少輸入一項"),!1);default:return!0}}()){switch(d.find("[name]:visible,input[type=hidden],select.st_lnls[name]:not(disabled)").each(function(t){var e=$(this).attr("name"),n=$(this).val();"sTravel"==e?(s[e]=n.replace(u,""),s[e]=s[e].replace("_","")):"sFdate"==e||"sTdate"==e||"sAdate"==e||"sAdateP"==e||"sDatef"==e||"sDatet"==e||"sOneWayFromDate"==e||"sRoundTripTypeConfirmedFromDate"==e||"sRoundTripTypeConfirmedToDate"==e||"sRoundTripTypeNotConfirmedFromDate"==e||"FromDate"==e||"ToDate"==e?s[e]=n.replace(/\W/g,""):"sLine"==e||"sWebarea"==e||"sCity"==e||"sTworld"==e||"sTcountry"==e||"sTcity"==e||"sFcity"==e||"sCountry"==e||"sFreekind1"==e||"sCityzone"==e||"sFcountry"==e||"sTline"==e||"sFline2"==e||"sFcountry2"==e||"sFcity2"==e||"LineArr"==e||"CountryArr"==e||"CityArr"==e?s[e]=n.replace("_",""):"sProdGo"==e||"sAllotment"==e?s[e]=$(this).prop("checked")?"1":"0":"sNoTrans"==e||"sDirectFlight"==e?s[e]=$(this).prop("checked")?"on":"":"NoTrans"==e||"IsThreeDays"==e||"OnlyAvailableSeat"==e?s[e]=$(this).prop("checked")?"true":"false":"sOneWayPlusMinus3Days"==e||"sRoundTripTypeConfirmedPlusMinus3Days"==e?$(this).prop("checked")&&(s[e]="on"):"IsConfirmDate"==e||"Rtow"==e?$(this).prop("checked")?s[e]=$(this).val():$(this).is("select")&&(s[e]=$(this).val()):"sTools"==e?$(this).prop("checked")&&(s[e]?s[e]+=","+n:s[e]=n):"sRtow"==e||"sTripType"==e||"sRoundTripType"==e||"sPayKind"==e?$(this).prop("checked")&&n.length>0&&(s[e]=n):"sHtlName"==e||"sHotelName"==e?n.length>0&&(s[e]=escape(a(n.replace(/\(.+\)/g,"")))):"sAdultQty"==e||"sChildQty"==e||"sChild1Age"==e||"sChild2Age"==e||"sChild3Age"==e||"sRoomQty"==e||"sEtkind"==e||"sName"==e||"sCarr"==e?s[e]=n:n.length>0&&(s[e]=n)}),c){case"abroadHotel":-1!=s.sCity.indexOf(s.sCountry)&&(s.sCity=s.sCity.replace("_"+s.sCountry,""));for(var h=0;h<3;h++)"sChild"+(h+1)+"Age"in s||(s["sChild"+(h+1)+"Age"]="12");s.sAllotment&&void 0!==s.sAllotment||(s.sAllotment=0),(s.sAdateP||void 0===s.sAllotment)&&(s.sAdate=s.sAdateP,delete s.sAdateP);break;case"domesticHotel":0==s.sLine.length&&(s.sLine="9"),0==s.sCountry.length&&(s.sCountry="TW"),/_TW$/.test(s.sCity)&&(s.sCity=s.sCity.replace(/_TW$/g,""));break;case"flightsNormal":-1!=s.sTcity.indexOf(s.sTcountry)&&(s.sTcity=s.sTcity.replace("_"+s.sTcountry,"")),2!=s.sRtow&&(delete s.sFcountry2,delete s.sFline2,delete s.sFcity2);break;case"flightsInternational":"0"===s.Rtow&&(s.IsConfirmDate="true"),s.SeekDestination=function(){var t=[],e=d.find(".seek-destination-wrap > .group:visible"),a=d.find(".calendar.fromDate"),n=d.find(".calendar.toDate"),r=d.find(".calendar.expectDate"),o=d.find("select.stayDays");return e.each(function(e,i){var l=$(i),d=l.find(".departure"),c=l.find(".destination"),u=l.find(".calendar"),p={Depart:function(t){return"_"===t?"":t}(d.attr("data-airportcode")),DepartCity:d.attr("data-citycode"),DepartCountry:d.attr("data-countrycode"),Arrive:function(t){return"_"===t?"":t}(c.attr("data-airportcode")),ArriveCity:c.attr("data-citycode"),ArriveCountry:c.attr("data-countrycode"),DepartDate:function(t,e,n){var o,i=r.val(),s={0:a.val(),1:function(t){var e;return"true"===t?e=a.val().replace(/\//g,"-"):("string"!=typeof i||/\d{1,4}\/\d\d\/\d\d/.test(i)||(i=moment().format("YYYY/MM/DD")),e=i.replace(/\//g,"-")),e}(e),3:n};return s.hasOwnProperty(t)&&(o=s[t]),o.replace(/\//g,"-")}(s.Rtow,s.IsConfirmDate,u.val())};t.push(p),"1"===s.Rtow&&t.push({Depart:function(t){return"_"===t?"":t}(c.attr("data-airportcode")),DepartCity:c.attr("data-citycode"),DepartCountry:c.attr("data-countrycode"),Arrive:function(t){return"_"===t?"":t}(d.attr("data-airportcode")),ArriveCity:d.attr("data-citycode"),ArriveCountry:d.attr("data-countrycode"),DepartDate:function(t,e,a){return"string"!=typeof e||/\d{1,4}\/\d\d\/\d\d/.test(e)||(e=moment().format("YYYY/MM/DD")),"true"===t?n.val().replace(/\//g,"-"):moment(e.replace(/\//g,"")).add(parseInt(a),"days").format("YYYY-MM-DD")}(s.IsConfirmDate,r.val(),o.val())})}),JSON.stringify(t).replace(/\"/g,"'")}();break;case"flightsFloor":if(s.hasOwnProperty("sRoundTripTypeNotConfirmedFromDate")&&0==s.sRoundTripTypeNotConfirmedFromDate.length&&(s.sRoundTripTypeNotConfirmedFromDate=moment().format("YYYYMMDD")),"MULTI_DEST"==s.sTripType){var f=$("#fcMultiDestWrapper"),m=f.children(".divider");s.sRefOrigDestLookupList=[],m.each(function(t,e){var a=$(e),n=a.find("[data-toggle=dtm-lnls]"),r=n.eq(0),o=n.eq(1),i=a.find("[data-toggle=cy-ln]"),l=function(t,e){var a={};return null==t||void 0===t?(a.intvalue=e.attr("data-intvalue"),a.countrycode=e.attr("data-countrycode"),a.iscity=e.attr("data-iscity"),a.citycode=e.attr("data-citycode")):a=t,a}(r.data("dtm_lnls").selected,r),d=function(t,e){var a={};return null==t||void 0===t?(a.intvalue=e.attr("data-intvalue"),a.countrycode=e.attr("data-countrycode"),a.iscity=e.attr("data-iscity"),a.citycode=e.attr("data-citycode")):a=t,a}(o.data("dtm_lnls").selected,o),c={value:l.intvalue,countryCode:l.countrycode,isCity:l.iscity,cityCode:l.citycode},u={value:d.intvalue,countryCode:d.countrycode,isCity:d.iscity,cityCode:d.citycode};s["sMultiDestFromDate_"+(t+1)]=i.val().replace(/\//g,""),s["sMultiDestFromCity_"+(t+1)]=c.value,s["sMultiDestToCity_"+(t+1)]=u.value,s.sRefOrigDestLookupList.push(c,u)}),s.sRefOrigDestLookupList=JSON.stringify(s.sRefOrigDestLookupList).replace(/\"/g,"'")}else{var g=$("#flightsFloorDeparture"),v=function(t,e){var a={};return null==t||void 0===t?(a.intvalue=e.attr("data-intvalue"),a.countrycode=e.attr("data-countrycode"),a.iscity=e.attr("data-iscity"),a.citycode=e.attr("data-citycode")):a=t,a}(g.data("dtm_lnls").selected,g),y={value:v.intvalue,countryCode:v.countrycode,isCity:v.iscity,cityCode:v.citycode},b=$("#flightsFloorDestination"),w=function(t,e){var a={};return null==t||void 0===t?(a.intvalue=e.attr("data-intvalue"),a.countrycode=e.attr("data-countrycode"),a.iscity=e.attr("data-iscity"),a.citycode=e.attr("data-citycode")):a=t,a}(b.data("dtm_lnls").selected,b),C={value:w.intvalue,countryCode:w.countrycode,isCity:w.iscity,cityCode:w.citycode};s.sRefOrigDestLookupList=JSON.stringify([y,C]).replace(/\"/g,"'")}$.ajax({type:"POST",url:o.flightsFloor.token,dataType:"json",async:!1,success:function(t){s._LionWebTK2RequestVerificationToken=t.token}});break;case"flightsChina":s.sTairp=s.sTcity.split("_")[0],s.sFairp=s.sFcity.split("_")[0],s.sTcity=s.sTcity.split("_")[1],s.sFcity=s.sFcity.split("_")[1];break;case"freeNew":s.Keywords=s.Keywords?encodeURI(s.Keywords):"";break;case"freeGroup":delete s.sTravel;break;case"freeAir":s.sTworld=s.LineArr,s.sTcountry=s.CountryArr,s.sTcity=s.CityArr,delete s.LineArr,delete s.CountryArr,delete s.CityArr;break;case"thsrcTaiwan":s.sTools=1,s.sHotelName&&void 0!==s.sHotelName||(s.sHotelName=""),localStorage.setItem("FIT2THSR",JSON.stringify({sFreekind:s.sFreekind,sFreekind1:"_"+s.sFreekind1,sFcity:"_"+s.sFcity,sTcity:"_"+s.sTcity,sDatef:s.sDatef,sDatet:s.sDatet,sHotelName:s.sHotelName,sTools:s.sTools}));break;case"ticketAbroad":s.sCountry=s.CountryArr,s.sCity=s.CityArr,delete s.CountryArr,delete s.CityArr,s.sName=escape(s.sName);break;case"ticketTaiwan":s.sName=escape(s.sName);break;case"ticketElectronicTaiwan":s.sCity.length>0&&(s.sCity="_"+s.sCity)}if(p&&$.post("/Scripts/ADLink/Counter.ashx",{alt:c,cno:p.channelno,cbno:p.ChannelBoxNo,referrer:document.referrer||"",currentPage:location.href,site:"B2C_TW",sprima:p.sprima,kindno:p.KindNo,gbno:p.GroupBoxNo,gno:p.GroupNo,url:function(t,e){return"abroadHotel"===e&&"P"==s.sPayKind&&"JP"!=s.sCountry?t.actionThird:t.action}(o[c],c)}),o[c])if("get"==o[c].method)if("abroadHotel"===c&&"P"==s.sPayKind&&"JP"!=s.sCountry){var D={ss:function(t,e){var a;return a=void 0!==t&&t.length>0?t.replace(/\(.+/,""):e.replace(/\(.+/,""),unescape(a)}(s.sHtlName,s.sTxt),checkin_monthday:moment(s.sAdate).date(),checkin_year_month:moment(s.sAdate).year()+"-"+(parseInt(moment(s.sAdate).get("month"))+1),checkout_monthday:moment(s.sAdate).date()+parseInt(s.sDays),checkout_year_month:moment(s.sAdate).year()+"-"+(parseInt(moment(s.sAdate).get("month"))+1),no_rooms:s.sRoomQty,group_adults:s.sAdultQty*s.sRoomQty,group_children:s.sChildQty*s.sRoomQty,age:function(t,e){var a,n=new Array(parseInt(t)),r=0;for(r=0;r<n.length;r++)n[r]=s["sChild"+(r+1)+"Age"];for(a=n,r=1;r<parseInt(e);r++)n=n.concat(a);return n}(s.sChildQty,s.sRoomQty)};e(o[c].actionThird+"?"+n(D))}else e(o[c].action+"?"+n(s));else if("post"==o[c].method){l.attr({action:o[c].action,method:o[c].method}).html("");for(var T in s)l.append('<input type="hidden" name="'+T+'" value="'+s[T]+'">');l.submit()}}}}),$('[data-toggle="dtm-lnls"]').dtm_lnls({isRunning:!0,dataTemplate:{abroadGroup:["vLine","vLinetravel","vLinewebarea"],domesticGroup:["vLine","vLinetravel","vLinewebarea"],abroadHotel:["vLine","vCountry","vCity","vCityzone"],domesticHotel:["vLine","vCountry","vCity","vCityzone"],flightsNormalDeparture:["vFcountry","vFcity"],flightsNormalDestination:["vTline","vTcountry","vTcity","vAirport"],flightsNormalReturn:["vFline2","vFcountry2","vFcity2"],flightsInternational:[],flightsFloor:[],freeGroup:["vLine","vLinetravel","vLinewebarea"],freePreson:["vTworld","vTcountry","vTcity"],freeNew:["Line","Country","City"],freeTaiwan:["vLine","vArea","vTcity"],freeAir:["LineArr","CountryArr","CityArr"],thsrcTaiwan:["vLine","vArea","vTcity"],ticketAbroad:["LineArr","CountryArr","CityArr"],ticketTaiwan:["vLine","vCountry","vCity"],themeTrip:["vLine","vLinetravel","vLinewebarea"]},linkedValue:{flightsNormalDestination:["vTAirline","AirName"],flightsNormalReturn:["vFAirline2"],freeAir:["AirlineArr","AirName"]},levelName:{abroadGroup:["產品線","區域/國家","國家/城市","城市/產品"],domesticGroup:["產品線","國家","城市"],abroadHotel:["產品線","國家","城市","區域,地標"],domesticHotel:["產品線","國家","城市","行政區,商圈/景點,捷運站"],flightsInternational:["國家","城市","機場"],flightsFloor:["國家","城市","機場"],freePreson:["產品線","國家","城市"],freeNew:["產品線","國家","城市"],freeTaiwan:["產品線","國家","城市"]},customMenuRenderHTML:function(t,e,a,n,r,o){var i={flightsFloor:function(t,e,a,n,r){var o=t,i="",a=function(t,e){return t||Object.keys(e)}(a,e);return i+='<div class="dtm-lnls"><button class="close">×</button>',i+='<div class="m-place"><span class="m-r-xs icon at"></span>'+t.opts.moreString+"</div>",i+='<ul class="tabs">',i+=function(t,e){for(var a,n="",r=0;r<t.length;r++)(a=e[t[r]]||!1)&&(n+="<li><span>"+function(t){return t?t.replace(new RegExp(o.opts.removeStringOnMenu,"g"),""):""}(a)+"</span></li>");return n}(n,e[a[0]]),i+="</ul>",i+='<div class="ctns">',i+=function(t,e){var a,n,r="",o=null,i=null,s=/(?=\()*\w+(?=\))/g,l=/[A-Z|\W|\w]+(?=\(.+\))/g;for(a=0;a<t.length;a++){o=null,o=e[t[a]],r+='<div class="panl">';for(n in o)i=null,i=function(t){var e={countryCode:t[0]?t[0].match(s):null,countryName:t[0]?t[0].match(l):null,cityCode:t[1]?t[1].match(s):null,cityName:t[1]?t[1].match(l):null,airportCode:t[2]?t[2].match(s):null,airportName:t[2]?t[2].match(l):null,isCity:t.length<=2,label:null,intValue:t.length<=2?t[1]:t[2]};return e.label=e.countryName+"("+e.countryCode+")-"+e.cityName+"("+e.cityCode+")"+(e.airportName?"-"+e.airportName+"("+e.airportCode+")":""),e.countryCode=e.countryCode.toString(),e.countryName=e.countryName.toString(),e.cityCode=e.cityCode?e.cityCode.toString():null,e.cityName=e.cityName?e.cityName.toString():null,e.airportCode=e.airportCode?e.airportCode.toString():null,e.airportName=e.airportName?e.airportName.toString():null,e}(o[n].split("__")),r+='<span class="sec-wrap in-block">',r+="<a "+function(t){var e="";for(var a in t)e+=" data-"+a+'="'+(t[a]?t[a]:"_")+'"';return e}(i)+">"+o[n].replace(/.+__|-\w.+\(.+\)|-\(.+\)/g,"")+"</a>",r+="</span>";r+="</div>"}return r}(n,e[a[1]]),i+="</div>"},flightsNormalDestination:function(t,e,a,n,r){var o=t,i="";return i+='<div class="dtm-lnls"><button class="close">×</button>',i+='<div class="m-place"><span class="m-r-xs icon at"></span>'+t.opts.moreString+"</div>",i+='<ul class="tabs">',i+=function(t,e){for(var a,n="",r=0;r<t.length;r++)(a=e[t[r]]||!1)&&(n+="<li><span>"+function(t){return t?t.replace(new RegExp(o.opts.removeStringOnMenu,"g"),""):""}(a)+"</span></li>");return n}(n,e[a[0]]),i+="</ul>",i+='<div class="ctns">',i+=function(t,e){var a,n,r="",o=null,i=null,s=/(?=\()*\w+(?=\))/g;for(a=0;a<t.length;a++){o=null,o=e[t[a]],r+='<div class="panl">';for(n in o)i=null,i=function(e){return{parentxt:e[0]?e[0].match(s):null,txt:e[1],tline:t[a],tcountry:"_"+e[0].match(s),tcity:n,merged:e[0]+"-"+e[1]}}(o[n].split("__")),r+='<span class="sec-wrap in-block">',r+="<a "+function(t){var e="";for(var a in t)e+=" data-"+a+'="'+(t[a]?t[a]:"_")+'"';return e}(i)+">"+i.txt.replace(/.+__|-[\w|\W].+\(.+\)|-\(.+\)|\(.+\)/g,"")+"</a>",r+="</span>";r+="</div>"}return r}(n,e[a[2]]),i+="</div>",i+="</div>"}};return i.flightsInternational=i.flightsFloor,i[e](t,a,n,r,o)},customArrangeData:function(t,e,a,n,r){return{flightsNormalDestination:function(t,e,a,n){var r=[];if(void 0!==t.vTline&&void 0!==t.vTcountry&&void 0!==t.vTcity)for(var o in t.vTline)for(var i in t.vTcountry[o]){var s=t.vTcountry[o][i],l=$.trim(i.replace("_","")),d=$.trim(s.replace(l,"").replace(" - ",""));for(var c in t.vTcity[i]){var u=t.vTcity[i][c],p=$.trim(c.replace(i,"").replace("_","")),h=$.trim(u.replace(p,"").replace(" - ","")),f="",m=h.split("__");2==m.length&&(h=$.trim(m[0]),f=$.trim(m[1]));var g=[];if(void 0!==t.vAirport&&null!=t.vAirport){var v=t.vAirport[l+"_"+p];if(void 0!==v&&null!=v&&v.length>0)for(var y=0;y<v.length;y++){var b=(v[y]||"").split("__");if(3==b.length){var w=$.trim(b[0]||""),C=$.trim(b[1]||""),D=$.trim(b[2]||"");"SHA"!=p&&(""==h&&""==C||h!=C)&&(""==f&&""==f||f!=D)&&g.push({aircode:w,aircname:C,airename:D})}}}var T=d+"("+l+")-"+h+(f.length>0?"-":"")+f+"("+p+")",S=h+(f.length>0?"-":"")+f+"("+p+")";if(r.push({parentxt:[d],txt:S,merged:T,tline:o,tcountry:i,tcity:c}),0!=g.length)for(var _=0;_<g.length;_++){var x="-"+g[_].aircname;g[_].airename.length>0&&(x+="-"+g[_].airename),x+="("+g[_].aircode+")";var T=d+"("+l+")-"+h+(f.length>0?"-":"")+f+"("+p+")"+x,S=h+(f.length>0?"-":"")+f+"("+p+")";r.push({parentxt:[h,d],txt:S,merged:T,tline:o,tcountry:i,tcity:c})}}}return r}}[t](e,a,n,r)},whenChooseFirst:function(t,e){for(var a in t)e.attr("data-"+a,t[a])},whenItemClicked:function(t,e,a){switch(a.attr("id")){case"abroadHotelDestination":if(!t.filter(".show").hasClass("auto")&&a.data("dtm_lnls").opts.toggleCustomMenu){var n=e.attr("data-city").split("_");a.attr("data-line",e.attr("data-line")),a.attr("data-country","_"+n[2]),a.attr("data-city","_"+n[1]+"_"+n[2]),a.attr("data-cityzone",n[3]?"_"+n[3]:"_"),a.attr("data-txt",e.attr("data-txt")),a.attr("data-parentxt",e.attr("data-txt").split("-").splice(1))}else{var r=e.data();for(var o in r)a.attr("data-"+o,r[o])}t.filter(".show").hasClass("auto")&&e.attr("data-merged")&&e.attr("data-merged").length>0&&a.attr("data-txt",r.merged);break;case"domesticHotelDestination":if(!t.filter(".show").hasClass("auto")&&a.data("dtm_lnls").opts.toggleCustomMenu){var n=e.attr("data-city").split("_");a.attr("data-line","_9"),a.attr("data-country","_"+n[2]),a.attr("data-city","_"+n[1]+"_"+n[2]),a.attr("data-cityzone",n[3]?"_"+n[3]:"_"),a.attr("data-txt",e.attr("data-txt")),a.attr("data-parentxt",e.attr("data-txt").split("-").splice(1))}else{var r=e.data();for(var o in r)a.attr("data-"+o,r[o])}t.filter(".show").hasClass("auto")&&e.attr("data-merged")&&e.attr("data-merged").length>0&&a.attr("data-txt",r.merged);break;default:var r=e.data();for(var o in r)a.attr("data-"+o,r[o])}},whenDestinationShow:function(t,e){$(".cy-ln").hide()},whenSearchMoreClicked:function(t){$(".sf-lnse").data("sf-lnse").$submit.trigger("click")}})}),$("[data-toggle=pp_ln]").pp_ln({padding:10,placement:"bottom",width:280,animation:"fade",trigger:"hover"}),$("select.st_lnls").st_lnls({defaultSelector:"off",group:"off",addClass:{WrapClass:"custom",SelectClass:"",OptionsClass:"txt-center"},whenOpen:function(){$(".st_lnls.custom").closest(".group").add($(".st_lnls.custom").closest(".wrap")).css("overflow","visible")},whenSelected:function(){$(".sf-lnse > .wrap").add($(".sf-lnse").find(".group").filter('[style*="overflow"]')).attr("style",function(t,e){if(e&&e.length>0)return e.replace(/overflow[^;]+;?/g,"")})},whenClose:function(){$(".sf-lnse > .wrap").add($(".sf-lnse").find(".group").filter('[style*="overflow"]')).attr("style",function(t,e){if(e&&e.length>0)return e.replace(/overflow[^;]+;?/g,"")})}}).on("recodeLoaded",function(){$(this).unwrap().removeClass("hide").next(".st-wrap").remove(),$(this).st_lnls({defaultSelector:"off",group:"off",addClass:{WrapClass:"custom",SelectClass:"",OptionsClass:"txt-center"},whenOpen:function(){$(".st_lnls.custom").closest(".group").add($(".st_lnls.custom").closest(".wrap")).css("overflow","visible")},whenSelected:function(){$(".sf-lnse > .wrap").add($(".sf-lnse").find(".group").filter('[style*="overflow"]')).attr("style",function(t,e){if(e&&e.length>0)return e.replace(/overflow[^;]+;?/g,"")})},whenClose:function(){$(".sf-lnse > .wrap").add($(".sf-lnse").find(".group").filter('[style*="overflow"]')).attr("style",function(t,e){if(e&&e.length>0)return e.replace(/overflow[^;]+;?/g,"")})}}),$(".st-select").find(".st-label").addClass("m-r")}),$(".st-select").find(".st-label").addClass("m-r"),$("#englishLightbox").fancybox({type:"iframe",width:622,height:272,padding:0,margin:0,iframe:{scrolling:"no"},title:!1,centerOnScroll:!0}),$("#memberMail").fancybox({type:"iframe",width:630,height:527,padding:0,margin:0,iframe:{scrolling:"no"},title:!1,centerOnScroll:!0}),$("body").delegate("a","click",function(){var t=$(this);t.attr("href").length>0&&$.post("/Scripts/ADLink/Counter.ashx",{sprima:t.attr("data-sprima"),alt:function(e){return e&&e.length>0?e.replace(/[\s]/g,"").substr(0,100):t.text().replace(/[\s]/g,"").substr(0,100)}(t.find("img").attr("alt")),cno:t.attr("data-cno"),cbno:t.attr("data-cbno"),erpgroupno:t.attr("data-erpgroupno"),kindno:t.attr("data-kindno"),gbno:t.attr("data-gbno"),gno:t.attr("data-gno"),referrer:document.referrer||"",url:t.attr("href"),currentPage:location.href,site:"B2C_TW"})})})}).call(window)},71:function(t,e){(function(){var t=(this.jQuery,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t});$(function(){function e(e){var a="//static.liontech.com.tw/adlinkhtml/b2c/root/index/newindeximages/";if(e.sky_top_adv.length>0&&e.sky_top_adv[0].picname.length>0){var n=e.sky_top_adv[0]||null,r=$('<div class="bn-lntp fix-to-md"><a class="wrap" href="#"><img class="img" src="" alt="輸入廣告促銷說明文字"></a></div>');r.children("a.wrap").attr({href:n.ItemTitleHref,title:n.ItemTitle,"data-cno":n.channelno,"data-cbno":n.ChannelBoxNo,"data-erpgroupno":n.erpGroupNo,"data-kindno":n.KindNo,"data-gbno":n.GroupBoxNo,"data-sprima":n.sprima,"data-gno":n.GroupNo}).children("img").attr({src:a+n.picname,alt:n.ItemTitle,title:n.ItemTitle}),n.ItemTitleHrefTarget&&r.children("a.wrap").attr("target","_blank"),$("body").prepend(r)}var o=e.out_b_g_keyw,i=e.in_b_g_keyw,s=function(t){var e=[];return e=t.map(function(t){return"GroupName"in t&&t.GroupName.length>0&&t.GroupName}),e.filter(function(t,e,a){return e==a.indexOf(t)})}(o),l=function(e){var a=[];return a=e.map(function(t){return"KindName"in t&&t.KindName.length>0&&{KindName:t.KindName,KindNo:t.KindNo}}).map(function(e){return"object"===(void 0===e?"undefined":t(e))&&"KindName"in e&&e.KindName.length>0&&e.KindName}),a.filter(function(t,e,a){return e==a.indexOf(t)})}(o),d=function(t){var e=[];return e=t.map(function(t){return"GroupName"in t&&t.GroupName.length>0&&t.GroupName}),e.filter(function(t,e,a){return e==a.indexOf(t)})}(i),c=$(".nvm-lnsm > .outbound"),u=$(".nvm-lnsm > .inbound");c.append("<h3>"+s[0]+"</h3>");for(var p=0;p<l.length;p++)l[p]&&c.append("<h4>"+l[p]+"</h4>").append("<ul>"+function(t){for(var e="",a=0;a<t.length;a++){t[a].hasOwnProperty("sprima")&&"string"==typeof t[a].sprima&&t[a].sprima.length;e+="<li>",e+='<a href="'+t[a].ItemTitleHref+'"',e+=' title="'+t[a].ItemTitle+'"',e+=' data-cno="'+t[a].channelno+'"',e+=' data-cbno="'+t[a].ChannelBoxNo+'"',e+=' data-erpgroupno="'+t[a].erpGroupNo+'"',e+=' data-kindno="'+t[a].KindNo+'"',e+=' data-gbno="'+t[a].GroupBoxNo+'"',e+=' data-sprima="'+t[a].sprima+'"',e+=' data-gno="'+t[a].GroupNo+'"',e+=(t[a].ItemTitleHrefTarget&&' target="_blank"')+">"+t[a].ItemTitle+"</a>",e+="</li>"}return e}(o.filter(function(t){return"KindName"in t&&t.KindName===l[p]}))+"</ul>");u.append("<h3>"+d[0]+"</h3>").append("<ul>"+function(t){for(var e="",a=0;a<t.length;a++)e+="<li>",e+='<a href="'+t[a].ItemTitleHref+'"',e+=' title="'+t[a].ItemTitle+'"',e+=' data-cno="'+t[a].channelno+'"',e+=' data-cbno="'+t[a].ChannelBoxNo+'"',e+=' data-erpgroupno="'+t[a].erpGroupNo+'"',e+=' data-kindno="'+t[a].KindNo+'"',e+=' data-gbno="'+t[a].GroupBoxNo+'"',e+=' data-sprima="'+t[a].sprima+'"',e+=' data-gno="'+t[a].GroupNo+'"',e+=(t[a].ItemTitleHrefTarget?' target="_blank"':"")+">"+t[a].ItemTitle+"</a>",e+="</li>";return e}(i)+"</ul>");var h=e.big_top_adv,f=$(".ntb-lnad1");f.html("");for(var p=0;p<h.length;p++)f.append('<figure><a href="'+h[p].ItemTitleHref+'"'+function(t){return t?' target="_blank"':""}(h[p].ItemTitleHrefTarget)+' title="'+h[p].ItemTitle+'" data-cno="'+h[p].channelno+'" data-cbno="'+h[p].ChannelBoxNo+'" data-erpgroupno="'+h[p].erpGroupNo+'" data-kindno="'+h[p].KindNo+'" data-gbno="'+h[p].GroupBoxNo+'" data-sprima="'+h[p].sprima+'" data-gno="'+h[p].GroupNo+'"><img src="'+a+h[p].picname+'" title="'+h[p].ItemTitle+'" alt="'+h[p].ItemTitle+'"></a><figcaption>'+h[p].ItemTitle+"</figcaption></figure>");var m=e.jwi_adv,g=Math.floor(Math.random()*m.length);m.length>0&&($(".bn-lnad1 a").attr({href:m[g].ItemTitleHref,title:m[g].ItemTitle,"data-cno":m[g].channelno,"data-cbno":m[g].ChannelBoxNo,"data-erpgroupno":m[g].erpGroupNo,"data-kindno":m[g].KindNo,"data-gbno":m[g].GroupBoxNo,"data-sprima":m[g].sprima,"data-gno":m[g].GroupNo}),1==m[g].ItemTitleHrefTarget&&$(".bn-lnad1 a").attr("target","_blank"),$(".bn-lnad1 img").attr({src:a+m[g].picname,title:m[g].ItemTitle,alt:m[g].ItemTitle}));for(var v,y=e.usp,b={left:{},right:{}},w=[],p=0;p<y.length;p++){var v=y[p].KindNo.toString(),C=y[p].KindName.substring(0,1);C=function(t){var e="";return"左"==t?e="left":"右"==t&&(e="right"),e}(C),"left"==C?b.left.hasOwnProperty(v)?b.left[v].push(y[p]):(b.left[v]=[],b.left[v].push(y[p])):"right"==C&&(b.right.hasOwnProperty(v)?b.right[v].push(y[p]):(b.right[v]=[],b.right[v].push(y[p])))}for(var D,T,S=Object.keys(b.left).length,_=0,x=0,M=0,k=0,Y=0,p=0;p<S;p++)D=Object.keys(b.left)[p],T=Object.keys(b.right)[p],w.push(b.left[D]),w.push(b.right[T]);for(var p=0;p<w.length;p++)if(_=w[p].length,M=function(t,e){return null!==e.match("B16")?3:null!==e.match("B17")?5:null!==e.match("B18")?6:parseInt(t)}(parseInt(w[p][0].KindName.substr(1,1)),w[p][0].sprima),x=M-_,_<M)if(_<x){k=parseInt(x/_),Y=x%_;for(var N=0;N<k;N++)w[p]=Y&&N==k-1?w[p].concat(w[p].slice(0,Y)):w[p].concat(w[p].slice(0,_))}else w[p]=w[p].concat(w[p].slice(0,x));$(".bn-lnad2").html(""),$(".bn-lnad2").append("<h3>"+w[0][0].GroupName+"</h3>");for(var p=0;p<w.length;p++){var A=w[p][0].KindNo,O='.bn-lnad2 ul[group="'+A+'"]',I=w[p].length;$('<ul group="'+A+'" class = "x'+I+'" ></ul>').appendTo(".bn-lnad2");for(var W=0;W<I;W++){var L=a+w[p][W].picname;$('<li><a href="'+w[p][W].ItemTitleHref+'" '+(w[p][W].ItemTitleHrefTarget&&'target="_blank"')+' data-cno="'+w[p][W].channelno+'" data-cbno="'+w[p][W].ChannelBoxNo+'" data-erpgroupno="'+w[p][W].erpGroupNo+'" data-kindno="'+w[p][W].KindNo+'" data-gbno="'+w[p][W].GroupBoxNo+'" data-sprima="'+w[p][W].sprima+'" data-gno="'+w[p][W].GroupNo+'"><img src="'+L+'"><strong>'+w[p][W].ItemTitle+"</strong></a></li>").appendTo(O)}}var E=$(".ntb-lnad2"),F=E.children(".tabs"),P=$(".ntb-lnad2.pills:first-child"),R=P.children(".tabs"),q=P.children(".ctns"),j=window.bb_top5||null,H=e.browe&&e.browe[0]&&e.browe[0].GroupName?e.browe[0].GroupName:"最多人看",Q={tour:"團體",hotel:"訂房",air:"機票",free:"自由行",ticket:"票券"},K=!!j&&j.air;Object.keys(window.bb_top5);delete window.bb_top5,F.children("li").eq(0).text(H),R.html(""),q.html("");for(var p=0;p<K.length;p++)K[p].ProductCName="【"+K[p].AirportLeg+"】"+K[p].DepatureCityName+"-"+K[p].DestinationCountryName.split("-")[1];for(var B in Q){var G=j[B];if(G&&G.length>2){R.append("<li>"+Q[B]+"</li>"),q.append($('<div class="panel"><ul class="bn" group="'+B+'"></ul></div>'));for(var p=0;p<G.length&&p<5;p++){var V=G[p].ProductCName,U=!!G[p].price&&G[p].price>0,z=U?V.length>=18&&V.substring(0,18)+"…":V.length>=24&&V.substring(0,24)+"…",z=function(){var t=window.matchMedia("(min-width: 980px)"),e=window.matchMedia("(min-width: 1280px)");return U?e.matches?V.length>26?V.substring(0,27)+"…":V:t.matches&&V.length>17?V.substring(0,18)+"…":V:V}();$("ul[group='"+B+"']").append($('<li group="'+G[p].productID+'"><a href="'+(/^http:\/\/|^https:\/\//.test(G[p].productlinkurl)?"":"http://")+G[p].productlinkurl+'" title="'+G[p].ProductCName+'" target="_blank" data-cno="'+G[p].channelno+'" data-cbno="'+G[p].ChannelBoxNo+'" data-erpgroupno="'+G[p].erpGroupNo+'" data-kindno="'+G[p].KindNo+'" data-gbno="'+G[p].GroupBoxNO+'" data-sprima="'+function(t,e){var a=e.split("&"),n=a.filter(function(t){return t.match("sprima=")}).toString(),r=a.indexOf(n),o=a[r];if("string"==typeof o)var i=o.replace(/.+=/g,"");return void 0===t?i:t}(G[p].sprima,G[p].productlinkurl)+'" data-gno="'+G[p].GroupNO+'"><strong>'+(0===p?V:z)+"</strong></a></li>")),"air"===B&&$("ul[group='"+B+"'] > li").eq(p).children("a").append("<em><span"+function(t){var e="";return 0===t&&(e=' class="fz-md"'),e}(p)+">點我查有位最低價&rsaquo;</span></em>"),U&&$("<em>$"+G[p].price.split(".")[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+"<span>起</span></em>").appendTo('li[group="'+G[p].productID+'"] > a')}}}var J=$(".ntb-lnad2.pills:nth-child(2)"),Z=J.children(".tabs"),X=J.children(".ctns"),tt=window.bs_top5||null,et={tour:"團體",hotel:"訂房",air:"機票",free:"自由行",ticket:"票券"},at=e.buy&&e.buy[0]&&e.buy[0].GroupName?e.buy[0].GroupName:"最多人買",nt=function(t,e,a,n){for(var r=0;r<t.length&&r<5;r++)if(t[r][e]){var o=t[r][e],i=!!a&&!!t[r][a]&&parseInt(t[r][a])>0,s=function(){var t=window.matchMedia("(min-width: 980px)"),e=window.matchMedia("(min-width: 1280px)");return i?e.matches?o.length>26?o.substring(0,27)+"…":o:t.matches&&o.length>17?o.substring(0,18)+"…":o:o}();n.append($('<li><a href="'+t[r].surl+'" title="'+t[r][e]+'" target="_blank" data-cno="'+t[r].channelno+'" data-cbno="'+t[r].ChannelBoxNo+'" data-erpgroupno="'+t[r].erpGroupNo+'" data-kindno="'+t[r].KindNo+'" data-gbno="'+t[r].GroupBoxNO+'" data-sprima="'+function(t,e){var a=e.split("&"),n=a.filter(function(t){return t.match("sprima=")}).toString(),r=a.indexOf(n),o=a[r];if("string"==typeof o)var i=o.replace(/.+=/g,"");return void 0===t?i:t}(t[r].sprima,t[r].surl)+'" data-gno="'+t[r].GroupNO+'"><strong>'+(0===r?o:s)+"</strong>"+function(t,e){var a="";return e&&t[e]&&parseInt(t[e])>0&&(a="<em>$"+Math.round(parseInt(t[e])).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+"<span>起</span></em>"),a}(t[r],a)+"</a></li>")),"TKTName"===e&&n.children("li").eq(r).children("a").append("<em><span"+function(t){var e="";return 0===t&&(e=' class="fz-md"'),e}(r)+">點我查有位最低價&rsaquo;</span></em>")}};if(F.children("li").eq(1).text(at),Z.html(""),X.html(""),delete window.bs_top5,tt&&"object"==(void 0===tt?"undefined":t(tt)))for(var rt in et){var ot=tt[rt];if(ot&&ot.length>2){var it=$('<div class="panel"><ul class="bn" group="'+rt+'"></ul></div>'),st=it.children(".bn");switch(Z.append("<li>"+et[rt]+"</li>"),X.append(it),rt){case"tour":nt(ot,"TourName","price",st);break;case"hotel":nt(ot,"HotelName","price",st);break;case"air":nt(ot,"TKTName",null,st);break;case"free":nt(ot,"FitName","price",st);break;case"ticket":nt(ot,"ETName","price",st);break;case"lionfree":nt(ot,"FITName","price",st)}}}}$.when($.getScript("//static.liontech.com.tw/ADLinkJson/big_top_data.js"),$.getScript("//static.liontech.com.tw/ADLinkJson/bb_top5.js"),$.getScript("//static.liontech.com.tw/ADLinkJson/bs_top5.js"),$.Deferred(function(t){$(t.resolve)})).done(function(){e(big_top_data),$(".ntb-lnad1").ntb_lnad1(),$(".ntb-lnad2").ntb_lnad2(),$(".nvm-lnsm").nvm_lnsm(),$(".bn-lntp").bn_lntp({openAtStart:!0,autoOpenClose:"close",closeDays:"3",countTime:3e3,whenTransition:function(){var t=$("input[data-toggle=dtm-lnls][data-target="+$(".dtm-lnls.show").attr("data-id")+"]");t.length>0&&t.data("dtm_lnls").$target.filter(".show").length>0&&t.dtm_lnls("setPosition",t.data("dtm_lnls").$target.filter(".show"))}}),$.getScript("//static.liontech.com.tw/adlinkhtml/b2c/_ann/annjs.js?"),$("body").alt_lnal("createAlert",{size:"md",html:{icon:'<i class="ic-lnpx warning_yellow d-ib align-middle"></i>',content:'為保障您帳戶安全，如接獲雄獅旅遊來電帳款錯誤要求重新付款或是退款。請重新致電服務業務確認或撥165反詐騙專線諮詢，不要立即操作ATM。<a href="/info/165/index.html" class="d-ib" target="_blank" style="color:white">(詳情)</a>'},class:{main:"alt_lnal fz-sm",wrap:{icon:"iwrap",content:"ctn",close:"close"}},style:{main:null,wrap:{icon:"margin-top:-2px;",content:null,close:null}}})})})}).call(window)},74:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"use strict";var a=function(e,a){this.ele=e,this.$ele=t(e),this.$btn=t('<div class="'+a.button.class+'"></div>'),this.option=a,this.statusCycle=["closed","opening","opened","closing"],this.status=0,this.transitionEndEvent=function(t){var e=document.createElement("fakeelement");for(var a in t)if(void 0!==e.style[a])return t[a]}({transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"}),this.storage,this.timer};a.DEFAULTS={openAtStart:!1,autoOpenClose:!1,closeDays:!1,button:{closeText:"收合",openText:"展開",class:"btn"},class:{closed:"closed",closing:"closing",opened:"opened",opening:"opening"},transition:!0,countTime:3e3,whenTransition:function(){}},a.prototype.init=function(){this.$ele.append(this.$btn),this.option.openAtStart?(this.status=2,this.$btn.text(this.option.button.closeText),this.addTransition()):(this.status=0,this.$btn.text(this.option.button.openText)),this.$ele.addClass(this.matchStatusClass(this.status)),"open"===this.option.autoOpenClose&&0===this.status?this.timer=setTimeout(this.toggle.bind(this),this.option.countTime):"close"===this.option.autoOpenClose&&2===this.status&&(this.timer=setTimeout(this.toggle.bind(this),this.option.countTime))},a.prototype.addTransition=function(){this.option.transition&&!this.$ele.hasClass("transition")&&this.$ele.addClass("transition")},a.prototype.toggle=function(){this.clearTimer(),this.addTransition(),2===this.status?this.close():0===this.status&&this.open(),this.timer=setInterval(this.option.whenTransition,25)},a.prototype.transitionEnd=function(){1===this.status?this.$ele.removeClass(this.matchStatusClass(this.status)).addClass(this.matchStatusClass(this.nextStatus())):3===this.status&&this.$ele.removeClass(this.matchStatusClass(this.status)).addClass(this.matchStatusClass(this.nextStatus())),this.clearTimer()},a.prototype.clearTimer=function(){clearInterval(this.timer),clearTimeout(this.timer)},a.prototype.nextStatus=function(){return this.status++,this.status>this.statusCycle.length-1&&(this.status=0),this.status},a.prototype.matchStatusClass=function(t){return this.option.class[this.statusCycle[t]]},a.prototype.open=function(){this.$ele.removeClass(this.matchStatusClass(this.status)).addClass(this.matchStatusClass(this.nextStatus())),this.$btn.text(this.option.button.closeText)},a.prototype.close=function(){this.$ele.removeClass(this.matchStatusClass(this.status)).addClass(this.matchStatusClass(this.nextStatus())),this.$btn.text(this.option.button.openText)},t.fn.bn_lntp=function(n,r){return this.each(function(){var o=t(this),i=o.data("bn_lntp"),s=null;if(i){if("string"!=typeof n||void 0!==r)throw"unsupported options!";i[n]()}else s=t.extend({},a.DEFAULTS,"object"===(void 0===n?"undefined":e(n))&&n,"object"===(void 0===r?"undefined":e(r))&&r),i=new a(this,s),o.data("bn_lntp",i),i.init(),i.$btn.on("click",function(t){i.toggle(0)}),i.$ele.on(i.transitionEndEvent,function(t,e){e||i.transitionEnd()})})}}(t)}).call(window)},75:function(module,exports){(function(){var jQuery=this.jQuery,jquery=jQuery,_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(n){if(a[n])return a[n].exports;var r=a[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var a={};e.m=t,e.c=a,e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(module,exports,__webpack_require__){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CORE=void 0;var _arguments=arguments,_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(t){return void 0===t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":_typeof2(t)},_createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),_private2=__webpack_require__(4),Module=function(){function t(e){_classCallCheck(this,t),this.original=e,this.edited=e}return _createClass(t,[{key:"stringify",value:function(){return this.edited=CORE.stringify(this.edited),this}},{key:"parse",value:function(){return this.edited=CORE.parse(this.edited),this}}]),t}(),CORE=function(t){return t instanceof Module?t:t instanceof Module?void 0:new Module(t)},self=CORE;CORE.VERSION="0.0.1",CORE.extend=__webpack_require__(5),CORE.stringify=function(t){if("object"===(void 0===t?"undefined":_typeof(t)))return JSON.stringify(t,function(t,e){var a=void 0;return e instanceof Function||"function"==typeof e?(a=e.toString(),a.length<8||"function"!==a.substring(0,8)?"_NuFrRa_"+a:a):e instanceof RegExp?"_PxEgEr_"+e:e}).replace(/\s|\\t|\\n|\\r/g,"");throw new Error("This method requires a object")},CORE.parse=function(str,date2obj){var iso8061=!!date2obj&&/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;if("string"==typeof str)return JSON.parse(str,function(key,value){var prefix=void 0;return"string"!=typeof value?value:value.length<8?value:(prefix=value.substring(0,8),iso8061&&value.match(iso8061)?new Date(value):"function"===prefix?eval("("+value+")"):"_PxEgEr_"===prefix?eval(value.slice(8)):"_NuFrRa_"===prefix?eval(value.slice(8)):value)});throw new Error("This method requires a string")},CORE.clone=function(t,e){return self.parse(self.stringify(t),e)},CORE.cookies=function(t,e,a){if("undefined"!=typeof document)return 1===_arguments.length?self.cookies.get(t):self.cookies.set(t,e,a);throw new Error("This method requires a `window` with a `document` object, or arguments length must more than 1")},CORE.cookies.set=function(t,e,a){if("string"==typeof t)return a=self.extend(_private2._private.cookies.defaults,a),a.expires=_private2._private.cookies.getExpiresDate(void 0===e?-1:a.expires),_private2._private.cookies.document.cookie=_private2._private.cookies.generateCookieString(t,e,a),self.cookies;throw new Error("First param must be string")},CORE.cookies.get=function(t){if("string"==typeof t){_private2._private.cookies.cachedDocumentCookie!==_private2._private.cookies.document.cookie&&_private2._private.cookies.renewCache();var e=_private2._private.cookies.cache[_private2._private.cookies.cacheKeyPrefix+t];return void 0===e?void 0:decodeURIComponent(e)}throw new Error("First param must be string")},CORE.cookies.getjson=function(t){if("string"==typeof t)return self.parse(self.cookies(t));throw new Error("First param must be string")},CORE.cookies.remove=function(t){return self.cookies.set(t,void 0)},CORE.isDate=function(t){if("string"==typeof t){var e=new Date(t);return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())}if("[object Date]"===Object.prototype.toString.call(t))return!isNaN(t.getTime());throw new Error("First param must be string or Date object")},exports.CORE=CORE},function(t,e,a){"use strict";(function(t){var e="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(t){return void 0===t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":_typeof2(t)};a(3);var n=a(0);((function(a){if("object"===(void 0===a?"undefined":e(a))&&(a.self===a||a.global===t)&&a)return a})(self||t||{})).core=n.CORE}).call(e,a(2))},function(t,e){var a;a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(t){"object"==("undefined"==typeof window?"undefined":_typeof2(window))&&(a=window)}t.exports=a},function(t,e){},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._private=void 0;var n="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(t){return void 0===t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":_typeof2(t)},r=a(0),o={cookies:{document:window.document,cache:null,cacheKeyPrefix:"cookey.",cachedDocumentCookie:null,maxExpireDate:new Date("Fri, 31 Dec 9999 23:59:59 UTC"),defaults:{path:"/",secure:!1},renewCache:function(){o.cookies.cache=o.cookies.getCacheFromString(o.cookies.document.cookie),o.cookies.cachedDocumentCookie=o.cookies.document.cookie},generateCookieString:function(t,e,a){t=t.replace(/[^#$&+\^`|]/g,encodeURIComponent),t=t.replace(/\(/g,"%28").replace(/\)/g,"%29"),"object"===(void 0===e?"undefined":n(e))&&(e=r.CORE.stringify(e)),e=(e+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),a=a||{};var o=t+"="+e;return o+=a.path?";path="+a.path:"",o+=a.domain?";domain="+a.domain:"",o+=a.expires?";expires="+a.expires.toUTCString():"",o+=a.secure?";secure":""},getCacheFromString:function(t){for(var e={},a=t?t.split("; "):[],n=0;n<a.length;n++){var r=o.cookies.getKeyValuePairFromCookieString(a[n]);void 0===e[o.cookies.cacheKeyPrefix+r.key]&&(e[o.cookies.cacheKeyPrefix+r.key]=r.value)}return e},getKeyValuePairFromCookieString:function(t){var e=t.indexOf("=");e=e<0?t.length:e;var a,n=t.substr(0,e);try{a=decodeURIComponent(n)}catch(t){console&&console.error}return{key:a,value:t.substr(e+1)}},getExpiresDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,a=new Date;if("number"==typeof t?t=t===1/0?o.cookies.maxExpireDate:new Date(e.getTime()+1e3*t):"string"==typeof t&&t.length<4?(a.setMilliseconds(a.getMilliseconds()+864e5*parseInt(t)),t=a):t=new Date(t),t&&!r.CORE.isDate(t))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return t}}};e._private=o},function(t,e,a){"use strict";var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===r.call(t)},i=function(t){if(!t||"[object Object]"!==r.call(t))return!1;var e=n.call(t,"constructor"),a=t.constructor&&t.constructor.prototype&&n.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!a)return!1;var o;for(o in t);return void 0===o||n.call(t,o)};t.exports=function t(){var e,a,n,r,s,l,d=arguments[0],c=1,u=arguments.length,p=!1;for("boolean"==typeof d&&(p=d,d=arguments[1]||{},c=2),(null==d||"object"!=(void 0===d?"undefined":_typeof2(d))&&"function"!=typeof d)&&(d={});c<u;++c)if(null!=(e=arguments[c]))for(a in e)n=d[a],r=e[a],d!==r&&(p&&r&&(i(r)||(s=o(r)))?(s?(s=!1,l=n&&o(n)?n:[]):l=n&&i(n)?n:{},d[a]=t(p,l,r)):void 0!==r&&(d[a]=r));return d}}])}).call(window)},77:function(t,e){(function(){var t=this.jQuery;!function(t){"use strict";var e=function(e,a){this.ele=e,this.$ele=t(e),this.newOptions=a,this.$adImageWraps=t(e).children("figure"),this.adLength=this.$adImageWraps.length,this.beginShowIndex=parseInt(this.adLength*Math.random()),this.nowIndex=this.beginShowIndex,this.tag=function(t){return"<"+t+"></"+t+">"}};e.DEFAULT={second:3500,type:"hover",addTag:null,addClass:null,tabStyle:""},e.prototype.render=function(){for(var e=this.$ele,a=e.children("figure"),n=a.children("figcaption"),r=a.length,o=a.find("a"),i=[],s="",l=0;l<r;l++)i.push(n.eq(l).text());s+='<ul class="tabs">';for(var d=0;d<r;d++)s+='<li class="'+this.newOptions.tabStyle+'"><a'+function(e){var a,n="",r={};t.each(e.attributes,function(t,e){r[e.name]=e.value});for(a in r)n+=" "+a+'="'+r[a]+'"';return n}(o.eq(d)[0])+">"+i[d]+"</a></li>";s+="</ul>",e.append(s)},e.prototype.nextAD=function(){var t=this.$ele,e=t.children("figure"),a=(e.children("figcaption"),t.find("ul.tabs").children("li")),n=e.length,r=(e.find("a"),this.nowIndex),o=r<n-1?r+1:0,i=r<=0?n-1:r-1;return r<n-1?r+=1:r=0,o=r<n-1?r+1:0,i=r<=0?n-1:r-1,a.removeClass("active"),a.eq(r).addClass("active"),e.removeClass("active"),e.eq(r).addClass("active"),e.removeClass("hide"),e.eq(i).addClass("hide"),e.removeClass("ready"),e.eq(o).addClass("ready"),this.nowIndex=r},e.prototype.init=function(){this.render();var e,a=this,n=this.$ele,r=n.children("figure"),o=(r.children("figcaption"),n.children("ul")),i=r.length,s=(r.find("a"),this.beginShowIndex),l=s<i-1?s+1:0,d=s<=0?i-1:s-1;e=n.children("ul").children("li");var c=window.setInterval(this.nextAD.bind(a),this.newOptions.second);if(r.eq(s).addClass("active"),r.eq(l).addClass("ready"),r.eq(d).addClass("hide"),e.eq(s).addClass("active"),"click"===this.newOptions.type){var u=n.children(".tabs").find("a");e.off("mouseenter","**"),u.click(function(n){n.preventDefault(),s=t(this).closest("li").index();var o=t(this).closest("li");return e.removeClass("active"),o.addClass("active"),r.removeClass("block"),r.removeClass("active"),r.removeClass("ready"),r.removeClass("hide"),r.eq(s).addClass("block"),a.nowIndex=s})}else e.on("mouseenter",function(){var n=t(this);return s=e.index(this),e.removeClass("active"),n.addClass("active"),r.removeClass("block"),r.removeClass("active"),r.removeClass("ready"),r.removeClass("hide"),r.eq(s).addClass("block"),a.nowIndex=e.index(this)});n.on("mouseenter",function(){window.clearInterval(c)}),n.on("mouseleave",function(){window.clearInterval(c),c=window.setInterval(a.nextAD.bind(a),a.newOptions.second),l=s<i-1?s+1:0,d=s<=0?i-1:s-1,r.removeClass("block"),r.eq(s).addClass("active"),r.eq(l).addClass("ready"),r.eq(d).addClass("hide")}),this.newOptions.addTag&&(o.wrap(this.tag(this.newOptions.addTag)),this.newOptions.addClass&&o.closest(this.newOptions.addTag).addClass(this.newOptions.addClass))},t.fn.ntb_lnad1=function(a){return this.each(function(){var n=t(this),r=t.extend({},e.DEFAULT,a);new e(n,r).init()})}}(t)}).call(window)},78:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"use strict";var a=function(e,a){this.ele=e,this.$ele=t(e),this.option=a};a.DEFAULTS={},a.prototype.init=function(t){var e=this.$ele;this.tabs({dom:e,tabNavigationLinks:e.children(".tabs").children("li"),tabContentContainers:e.children(".ctns").children(".panel")}).init()},a.prototype.tabs=function(t){var e=(t.dom,t.tabNavigationLinks),a=t.tabContentContainers,n=Math.floor(Math.random()*(parseInt(e.length)-1-0+1))+0,r=!1,o=function(){if(!r){r=!0;for(var t=0;t<e.length;t++){var o=e.eq(t);i(o,t)}}e.eq(n).addClass("active"),a.eq(n).addClass("active")},i=function(t,e){t.on("click",function(t){return s(e),!1})},s=function(t){t!==n&&t>=0&&t<=e.length&&(e.eq(n).removeClass("active"),e.eq(t).addClass("active"),a.eq(n).removeClass("active"),a.eq(t).addClass("active"),n=t)};return{init:o,goToTab:s}},t.fn.ntb_lnad2=function(n,r){return this.each(function(){var o=t(this),i=o.data("ntb_lnad2"),s=null;if(i)if("string"==typeof n&&void 0===r)i[n]();else{if("string"!=typeof n||"object"!==(void 0===r?"undefined":e(r)))throw"unsupported options!";i[n](r)}else s=t.extend({},a.DEFAULTS,"object"===(void 0===n?"undefined":e(n))&&n,"object"===(void 0===r?"undefined":e(r))&&r),i=new a(this,s),o.data("ntb_lnad2",i),i.init()})}}(t)}).call(window)},80:function(t,e){(function(){var t=this.jQuery,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"use strict";var a=function(e,a){this.ele=e,this.$ele=t(e),this.option=a,this.$collapseButton=this.$ele.find(".more"),this.moduleHeight=this.$ele.height(),this.moduleTop=this.$ele.offset().top,this.moduleBottom=this.moduleHeight+this.moduleTop,this.collapseTarget=this.$collapseButton.attr("data-target"),this.$collapseDom=t(this.collapseTarget),this.$collapseDomWrap=this.$collapseDom,this.collapseDomWrapHeight=this.$collapseDomWrap.outerHeight(),this.collapseDomWrapTop=this.$collapseDomWrap.offset().top,this.collapseDomWrapBottom=this.collapseDomWrapHeight+this.collapseDomWrapTop,this.$moreBtn=this.$ele.children(".more"),this.moreBtnHeight=this.$moreBtn.outerHeight(),this.moreText=this.$collapseButton.text(),this.lessText="收合"};a.DEFAULTS={},a.prototype.init=function(){var e=this;this.collapseDomWrapInnerHeight(this.$collapseDomWrap.children("*"))<=419&&this.$moreBtn.hide(),this.$collapseButton.on("click",function(){t(this).text();t(this).hasClass("open")?(t(this).text(e.moreText).removeClass("open"),e.$collapseDom.removeClass("open"),e.$moreBtn.css("margin-top",390)):(t(this).text(e.lessText).addClass("open"),e.$collapseDom.addClass("open"),e.$moreBtn.css("margin-top",e.moduleHeight-e.moreBtnHeight))})},a.prototype.collapseDomWrapInnerHeight=function(e){var a=0;return e.each(function(){a+=t(this).outerHeight()}),a},t.fn.nvm_lnsm=function(n,r){return this.each(function(){var o=t(this),i=o.data("nvm_lnsm"),s=null;if(i)if("string"==typeof n&&void 0===r)i[n]();else{if("string"!=typeof n||"object"!==(void 0===r?"undefined":e(r)))throw"unsupported options!";i[n](r)}else s=t.extend({},a.DEFAULTS,"object"===(void 0===n?"undefined":e(n))&&n,"object"===(void 0===r?"undefined":e(r))&&r),i=new a(this,s),o.data("nvm_lnsm",i),i.init()})}}(t)}).call(window)},98:function(t,e,a){(function(){this.jQuery;a(75),a(74),a(80),a(77),a(78),a(26),a(5),a(27),a(21),a(23),a(22),a(25),a(71),a(69)}).call(window)}});